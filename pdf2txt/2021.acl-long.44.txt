km-bart: knowledge enhanced multimodal bart for visualcommonsense generationyiran xing∗ ♠ zai shi∗♣ zhao meng∗♣gerhard lakemeyer♠ yunpu ma(cid:7) roger wattenhofer♣♠rwth aachen, germany(cid:7)lmu munich, germany♣eth zurich, switzerland{yiran.xing, gerhard}@rwth-aachen.decognitive.yunpu@gmail.com{zaishi, zhmeng, wattenhofer}@ethz.ch.
abstract.
we present knowledge enhanced multimodalbart (km-bart), which is a transformer-based sequence-to-sequence model capableof reasoning about commonsense knowledgefrom multimodal inputs of images and texts.
we adaptthe generative bart architec-ture (lewis et al., 2020) to a multimodal modelwith visual and textual inputs.
we further de-velop novel pretraining tasks to improve themodel performance on the visual common-sense generation (vcg) task.
in particular,our pretraining task of knowledge-based com-monsense generation (kcg) boosts modelperformance on the vcg task by leveragingcommonsense knowledge from a large lan-guage model pretrained on external common-sense knowledge graphs.
to the best of ourknowledge, we are the ﬁrst to propose a ded-icated task for improving model performanceon the vcg task.
experimental results showthat our model reaches state-of-the-art perfor-mance on the vcg task (park et al., 2020) byapplying these novel pretraining tasks..1.introduction.
early work on vision-language models has beenlargely focused on pure understanding tasks (tanand bansal, 2019; lu et al., 2019).
these models,although improving model performance on under-standing tasks such as visual question answer-ing (antol et al., 2015), are not capable of mul-timodal generation tasks (you et al., 2016).
toease this problem, researchers have proposed vari-ous models (zhou et al., 2020; li et al., 2020) forgenerating texts based on visual inputs..these models are mainly pretrained on generalvisual and language understanding tasks such asmasked language modeling and masked regionmodeling, which enable the models to build an.
alignment between visual and language features.
however, only feature alignments are inadequateto enhance the model’s ability in conducting com-plex multimodal commonsense reasoning, whichrequires the model to understand the underlyingrelations and effects between objects..commonsense reasoning was traditionally stud-ied on natural language (rajani et al., 2019; trinhand le, 2018), while recent works have paid at-tention to commonsense reasoning with joint vi-sual and language inputs.
for instance, zellerset al.
(2019) proposes the task of visual common-sense reasoning (vcr).
however, the task focuseson understanding instead of generating as it asksthe model to answer multiple-choice questions.
anewly introduced dataset, visual commonsensegeneration (vcg) (park et al., 2020), providesa more challenging task by requiring the modelto generate commonsense inferences about whatmight happen before/after, and the present intentsof characters (see table 2 for an example).
in thiswork, we propose to tackle the task of vcg byleveraging our knowledge enhanced multimodalbart (lewis et al., 2020), which we call km-bart.
km-bart is a transformer-based modelconsisting of an encoder and a decoder and is pre-trained on carefully designed tasks for vcg.
fig-ure 1 presents our model architecture1..our contributions in this work are three-folded:.
1. we extend the bart model to process mul-timodal data of images and texts, and enablemultimodal reasoning by introducing task-relevant tokens..2. to improve the model performance on vi-sual commonsense generation (vcg), weimplicitly incorporate commonsense knowl-edge from external knowledge graphs to our.
1https://github.com/fomalhautb/.
∗the ﬁrst three authors contribute equally to this work..km-bart-acl.
proceedingsofthe59thannualmeetingoftheassociationforcomputationallinguisticsandthe11thinternationaljointconferenceonnaturallanguageprocessing,pages525–535august1–6,2021.©2021associationforcomputationallinguistics525km-bart by designing a novel pretrainingtask, which we call knowledge-based com-monsense generation (kcg)..3. besides kcg, we further equip our km-bart with standard pretraining tasks in-cluding masked language modeling (mlm),masked region modeling (mrm), as well asattribution prediction (ap) and relation pre-diction (rp).
experimental results show thatall pretraining tasks are effective, and com-bining these pretraining tasks enable our km-bart to achieve state-of-the-art performanceon the vcg task..2 related work.
2.1 vision-language models.
visual-language (vl) tasks such as visual ques-tion answering (vqa) (antol et al., 2015) andimage-text matching (li et al., 2019) require themodels to process multimodal inputs and compre-hend visual and textual information simultaneously.
inspired by successful pretrained language modelslike bert (devlin et al., 2019) and gpt-2 (rad-ford et al., 2019), numerous multimodal image-text pretraining and representation learning mod-els (tan and bansal, 2019; lu et al., 2019; chenet al., 2020; yu et al., 2020) have been proposed.
these multimodal pretrained models use trans-formers as backbone and are denoising autoen-coders trained to predict the alignment of image-text pairs and the semantics of masked words andimage regions..the models mentioned above typically focusmore on understanding tasks.
to further bridge thegap between visual and textual clues in multimodaldata, in addition to cross-modal understanding, amodel should also acquire abilities to completegeneration tasks, for example, the image-to-texttask of image captioning (you et al., 2016).
how-ever, directly transferring a model pretrained on vlunderstanding tasks to generation tasks is infeasi-ble, as these models are merely transformer-basedencoders and are thus not suitable for generationtasks..zhou et al.
(2020) ease this problem by using atransformer-based network as both an encoder anda decoder, making the model capable of generatingtexts based on visual and textual inputs.
while liet al.
(2020) propose oscar, which improves thegeneration ability by introducing object tags as.
an additional clue during pretraining.
these mod-els achieve state-of-the-art performance in down-stream multimodal generation tasks such as imagecaptioning (you et al., 2016)..2.2 commonsense knowledge.
commonsense knowledge refers to the necessarylevel of practical knowledge and reasoning abouteveryday situations and events common amongmost people (sap et al., 2020).
for example,one should know that “water is for drinking”and “sunshine makes people warm”.
simple asit looks, enabling artiﬁcial intelligence to con-duct commonsense reasoning has been difﬁcultfor learning-based models (gunning, 2018).
re-searchers have resorted to knowledge graphs dueto their exact graph-structured representation ofknowledge to overcome this problem.
for example,conceptnet (speer et al., 2017) is a knowledgegraph with nodes representing general conceptsand edges indicating relational knowledge betweenconcepts.
another commonsense knowledge graph,atomic (sap et al., 2019), extends nodes to nat-ural language phrases, and edges to relations suchas intent, attribution, effect, etc..despite improvements in modeling common-sense knowledge, graph-based methods requireheavy human engineering, making it challengingto scale robustly.
for instance, model performanceusually deteriorates dramatically when retrievedcontextual knowledge is noisy due to imperfectknowledge matching (lin et al., 2019).
therefore,we implicitly leverage external knowledge usingsupervision signals inferred by comet (bosselutet al., 2019), which is a transformer-based, gener-ative model pretrained on commonsense knowl-edge graphs including conceptnet and atomic.
given a natural language phrase and a relation type,comet generates natural language commonsensedescriptions..in summary, on the one hand, existing cross-modal architectures not focusing on commonsenseinterpretation as their pretraining tasks are designedfor multimodal understanding, making them unsuit-able for the downstream vcg task.
on the otherhand, transformer-based generative models suchas comet (bosselut et al., 2019) cannot generatecommonsense inferences from cross-modal inputs.
therefore, in this work, we propose km-bart toconduct the task of visual commonsense gener-ation (vcg).
our km-bart is pretrained on a.
526figure 1: model architecture.
our model is based on bart.
conditioned on prompts that indicate the task type,such as <caption> in the ﬁgure, our model can generate texts based on visual and textual inputs from the encoder.
our model uses different special tokens to indicate task types and inform the model of different modalities of input..#images.
#sentences.
3.1.1 visual feature extractor.
conceptual captions (sharma et al., 2018).
2,683,686.
2,683,686.sbu (ordonez et al., 2011).
780,750.
780,750.coco (lin et al., 2014).
visual genome (krishna et al., 2017).
total.
82,783.
86,461.
414,113.
4,322,358.
3,633,680.
8,200,907.table 1: statistics of pretraining datasets..dedicated pretraining task for vcg as well as otherstandard pretraining tasks.
experimental resultsshow that our km-bart achieves state-of-the-artperformance on the vcg task..3 methodology.
in this section, we describe our methodology for vi-sual commonsense generation.
section 3.1 givesour model architecture.
section 3.2 introduces ourpretraining tasks as well as our self-training baseddata ﬁltering technique..3.1 model architecture.
figure 1 illustrates the architecture of our km-bart.
the backbone of our model is bart (lewiset al., 2020), which is a transformer-basedsequence-to-sequence autoencoder.
we modifythe original bart to adapt the model to cross-modality inputs of images and texts.
we add spe-cial tokens to adapt the model to different pretrain-ing/evaluation tasks.
in the following subsections.
we give the details of our visual feature extractor,the encoder, and the decoder..following previous work on vision-language mod-els (tan and bansal, 2019; lu et al., 2019), weuse a convolution neural network pretrained onthe coco dataset to extract visual embeddings,which are subsequently fed to the transformer-based cross-modal encoder.
speciﬁcally, we usethe pretrained masked r-cnn (he et al., 2017)from detectron22.
for each image, the pretrainedmasked r-cnn proposes the bounding boxes fordetected objects.
the area within a bounding boxis a region of interest (roi).
we leverage the inter-mediate representations of the rois in the maskedr-cnn to obtain ﬁxed-size embeddings for roisv = {v1, .
.
.
, vi, .
.
.
, vn }, where i is the index torois, and n is the number of rois for an image.
the visual embedding of the i-th roi vi is vi ∈ rd,where d is the embedding dimension.
for each ofthe rois, the masked r-cnn also outputs the classdistribution p(vi), which is later used for maskedregion modeling..3.1.2 cross-modal encoder.
following lewis et al.
(2020), the encoder of ourmodel is based on a multi-layer bidirectional trans-former.
we introduce special tokens to adapt it toour pretraining and downstream evaluation tasks.
speciﬁcally, each example starts with a special to-ken indicating the task type of the current example.
for our pretraining task of knowledge-basedcommonsense generation (see section 3.2.1), weuse <before>, <after>, or <intent> as the.
2https://github.com/facebookresearch/.
detectron2.
527decoderencodervimg scorese<img_feat>e<img>e<cls>e<img_feat>...e</img>e<s>eaecatesitseunder...e<img>e<caption>v1vzerov3...e</img>e<event>e</event>e<mlm>eae<mask>esitseunder...e</mlm>acatsitsunder...</s>a<mask>sitsunder...imagelanguagetask</img><event></event><mlm></mlm><caption><img>...decodermasked rcnnposition embeddingtoken embeddingtoken embeddingmasked roi modeling conditioned on languagemasked language modeling conditioned on imagestarting special token.
for attribution predictionand relation prediction (section 3.2.2), we use<region caption>.
finally, for masked lan-guage modeling and masked region modeling, weuse <caption>..furthermore, to inform the model of differentmodalities of inputs, we add three sets of differentspecial tokens: for images, we use <img> and</img> to indicate the start and the end of visualembeddings, respectively.
for texts, we introducedifferent special tokens to distinguish between twosets of textual inputs: events and captions.
eventsare image descriptions which the model uses forreasoning about future/past events or present in-tents of characters in the commonsense generationtask, while captions are for masked language mod-eling, where linguistic information plays a moreimportant role.
hence, to inform the model of thesetwo types of textual inputs, we use <event> and</event> for events, and <mlm> and </mlm>for captions.
in the following sections, we de-note textual inputs of words and specical tokens byw = {w1, .., wt }, where t is the length of textualinputs.
for a token w, its embedding is e ∈ rd,where d is the dimension of the embeddings..3.1.3 decoder.
the decoder of our model is also a multi-layertransformer.
unlike the encoder, which is bidi-rectional, the decoder is unidirectional as it is sup-posed to be autoregressive when generating texts.
the decoder does not take the visual embeddings asinputs.
instead, we use embeddings of the specialtoken <img feat> to replace the actual visualembeddings.
for masked region modeling andmasked language modeling, we use <cls> to re-place the masked regions or words (see figure 1).
the model should predict the masked words andthe class distribution of the masked regions duringpretraining..3.2 pretraining tasks.
to pretrain our model, we use four image-textdatasets: conceptual captions dataset (sharmaet al., 2018), sbu dataset (ordonez et al., 2011),microsoft coco dataset (lin et al., 2014) andvisual genome (krishna et al., 2017).
in the re-maining of this section, we use d to denote theindividual datasets for each of the pretraining tasks.
statistics of the datasets are given in table 1. theabove datasets consist of examples of parallel im-ages and texts and are widely used in previous.
work (tan and bansal, 2019; lu et al., 2019; zhouet al., 2020; yu et al., 2020)..3.2.1 knowledge-based commonsense.
generation.
the knowledge-based commonsense generation(kcg) task aims to improve the performance ofkm-bart on the vcg task.
we leverage knowl-edge induced from comet (bosselut et al., 2019),which is a large language model pretrained on ex-ternal commonsense knowledge graphs.
given anatural language phrase and a relation as inputs,comet generates natural language phrases ascommonsense descriptions.
relations of cometinclude xintent, xwant, xneed, xreact andxeffect..we only use comet to generate new common-sense descriptions on sbu and coco datasetsdue to limits in computational power for pretrain-ing.
for each image-text pair, we use cometto generate commonsense descriptions from thetext using all ﬁve relations mentioned above.
toadapt comet generated commonsense knowl-edge to vcg, we consider relations xintentand xwant from comet as intent, xneed as be-fore, xreact and xeffect as after.
in this way,we generate additional commonsense knowledgefor sbu and coco datasets.
the newly gener-ated dataset has more than 3.6 million examples(table 3).
however, the generated commonsenseknowledge is not always reasonable as only textualinformation is used while the visual information iscompletely ignored.
to ease this problem, we fur-ther ﬁlter the dataset by employing a self-trainingbased data ﬁltering strategy.
self-training based data filtering our strategyaims to ﬁlter the generated commonsense knowl-edge dataset so that the examples in the ﬁltereddataset closely resemble the examples in the vcgdataset.
to achieve this goal, we ﬁrst initialize ourkm-bart with bart parameters and ﬁnetunekm-bart on the vcg dataset for 30 epochs.
theﬁnetuned km-bart already has a good perfor-mance on the vcg dataset with a cider score of39.13 (see table 4)..we then leverage this ﬁnetuned model to evalu-ate the quality of commonsense descriptions gen-erated by comet.
we feed the corresponding im-ages, texts, and relations as inputs to the ﬁnetunedkm-bart and then compute the cross-entropy(ce) loss of comet generated commonsense de-scriptions.
we observe that commonsense descrip-.
528event and image.
task.
model.
generated sentence.
2 is holding an envelope.
without event§.
give 1 some bad newsreassure 1contemplate what 1 is saying to hersee what the letter saidgive mail to 1open the envelopereceive the envelope from 1see what’s inside the envelopewalk up to 1have seen 1 in the distancebe interested in what 1 has to saypick the envelope upcall 1 to meet himwalk to 1receive mailbe given an envelopebring the envelope with herﬁnish telling 1 she has a difﬁcult timeask 1 what the papers are forlet go of 1open the envelopehand the envelope to 1embrace 1read the contents of the envelope to 1hand the envelope to 1read the love letter.
intent.
with event†.
ground truth.
without event§.
before.
with event†.
ground truth.
without event§.
after.
with event†.
ground truth.
table 2: an example from the vcg dataset.
we use nucleus sampling with p = 0.9 during decoding.
we showthe inference sentences from (1) full model§ without event descriptions but with images as inputs; (2) full model†with event descriptions and images as inputs; (3) ground truth.
bold indicates inference sentences from our km-bart († and § indicate corresponding models in table 4).
note that the bounding boxes are not given in the vcgdataset and are predicted by a pretrained masked r-cnn.
additional examples are available in the supplementarymaterial..tions with a lower ce loss make more sense thanthose with a higher ce loss.
notice that whencomputing the ce loss of the comet generatedcommonsense descriptions, our km-bart lever-ages both the textual inputs and the visual inputs.
we provide examples of our data ﬁltering strategyin supplementary material..we compute ce loss for all the commonsensedescriptions in the vcg dataset and the new datasetgenerated by comet.
figure 2 shows the distri-butions of ce loss for the two datasets.
we ob-serve that commonsense descriptions generated bycomet result in higher ce losses, which are ex-pected as images are completely ignored when us-ing comet to generate natural language common-sense descriptions.
we only keep the examples ofwhich ce loss is below 3.5. table 3 shows thestatistics of generated datasets before and after dataﬁltering.
by ﬁltering, we keep only 1.46 million ex-amples, roughly accounting for 40% of the originalexamples..finally, we leverage the newly generated com-monsense knowledge dataset by pretraining km-bart on it.
we expect by pretraining, the modelreaches higher performance on the vcg dataset..#original.
#cleaned.
sbu (ordonez et al., 2011).
2,032,385.
808,425.coco (lin et al., 2014).
1,653,075.
660,020.total.
3,685,460.
1,468,445.table 3: statistics of datasets before and after ﬁltering..let s = {w1, ..., wl} be a commonsense descrip-tion of the newly generated dataset d, the loss func-tion for kcg is:.
lkcg(θ) =.
− e(w,v )∼d.
log(pθ(wl|w<l, w, v )).
(1).
l(cid:88).
l=1.
where l is the length of the generated sequence, lis the index to individual tokens in the target com-monsense description s, v and w are visual inputsand textual inputs, respectively.
θ represents modelparameters to be optimized..3.2.2 attribute prediction and relation.
prediction.
the visual genome dataset consists of 2.3 millionrelationships and 2.8 million attributes.
to utilizethese data, we use the attribute prediction (ap) and.
529token with a probability of 80%, use a random to-ken to replace with a probability of 10%, and keepthe masked token unchanged with a probability of10%..we denote the mask indices by 1 ≤ m ≤ m ,where m is the number of masked tokens.
wedenote the masked token by wm, and the remain-ing tokens that are not masked by w\m, the lossfunction for mlm is deﬁned as:.
lm lm (θ) =.
− e(w,v )∼d.
log(pθ(wm|w\m, w, v )).
(4).
m(cid:88).
m=1.
3.2.4 masked region modeling.
in the masked region modeling (mrm) task, wesample image regions and mask the correspond-ing feature vectors with a probability of 15%.
themasked vector will be replaced by a vector ﬁlledwith zeros.
the model needs to predict the dis-tribution over semantic classes for the masked re-gions.
the loss function is to minimize the kldivergence of the output distribution and the dis-tribution predicted by the masked r-cnn used invisual features extraction..we denote the mask indices by 1 ≤ n ≤ n ,where n is the number of masked regions.
we letp(vn) denote the class distribution of the maskedregion vn detected by masked r-cnn, qθ(vn) de-note the class distribution output by our model, theloss function for mrm is then:.
lm rm (θ) =n(cid:88).
e(w,v )∼d.
n=1.
dkl(p(vn)||qθ(vn))).
(5).
3.2.5 combining losses.
(3).
all.
the.
losses we describedto combinethe losses byabove, we weight each ofr.wkcg, wap , wrp , wm lm , wm rm∈the weights are chosen to roughly balance everyterm during the training phase.
the ﬁnal loss is:.
l = wkcglkcg + wap lap + wrp lrp +.
wm lm lm lm + wm rm lm rm.
(6).
figure 2: the distribution of the average cross-entropyon 10000 samples in the vcg dataset and our enhanceddataset.
for the generated dataset, we can keep the ex-amples of which cross entropy loss is below 3.5..the relation prediction (rp) as pretraining tasks,which enable the model to learn intrinsic propertiesamong different objects in an image..in the ap task, we feed the output vectors of thedecoder for each image feature into an mlp clas-siﬁer.
in the rp task, we concatenate two outputvectors of the decoder for each image feature pairand feed it into another mlp classiﬁer.
we use thecross-entropy loss for both tasks..we denote the indices for ap by 1 ≤ j ≤ a,the indices for rp by 1 ≤ k ≤ r, where a isthe number of ap examples, and r is the numberof rp examples.
we denote the label for the j-thap example by la(vj), and the label for the k-thrp example as lr(vk1, vk2), where vk1 and vk1 arethe two rois of the current rp example.
the lossfunction for the ap task is:.
lap (θ) =.
− e(w,v )∼d.
log(pθ(la(vj) | w, v )).
(2).
and the loss function for the rp task is:.
lrp (θ) =.
− e(w,v )∼d.
log(pθ(lr(vk1, vk2)) | w, v )).
a(cid:88).
j=1.
r(cid:88).
k=1.
3.2.3 masked language modeling.
following previous works (devlin et al., 2019; liuet al., 2019), we randomly mask the input textual to-kens with a probability of 15% in the masked lan-guage modeling (mlm) task.
within this 15% ofthe tokens, we use <mask> to replace the masked.
530pretraining task(s).
event bleu-2 meteor cider unique novel.
random init.
w/o pretrainingkcgkcg (before ﬁltering)ap & rpmlm & mrmfull model.
bart init.
w/o pretrainingkcgkcg (before ﬁltering)ap & rpmlm & mrmfull model†.
random init.
w/o pretrainingkcgkcg (before ﬁltering)ap & rpmlm & mrmfull model§.
bart init.
w/o pretrainingkcgkcg (before ﬁltering)ap & rpmlm & mrmfull model.
yyyyyy.yyyyyy.nnnnnn.nnnnnn.22.2822.1622.2422.4922.44-.
22.8623.4722.9022.9323.1323.25.
13.5413.6413.6713.8314.3614.49.
8.10813.2813.2912.1713.36-.
14.5514.5214.4314.6414.70-.
15.1715.0214.9814.9914.9315.01.
10.1410.1210.1310.2810.7310.86.
8.67310.0610.129.50310.22-.
36.4937.0637.0837.1837.44-.
39.1339.7639.0139.1838.7539.20.
14.8715.3415.2215.4816.7217.37.
6.33514.1713.9312.4914.52-.
27.8133.0133.6428.9731.16-.
27.4127.2826.5928.0628.6835.71.
12.1915.9516.4714.6015.8616.89.
4.85013.0813.5120.9815.02-.
29.7131.2031.3730.2831.64-.
28.3227.9727.1328.8828.7432.85.
24.2225.7924.9724.7526.1225.69.
10.5525.7025.5929.0128.36-.
table 4: results of different pretraining tasks on vcgvalidation set.
to speed up comparison between differ-ent pretraining tasks, we use greedy decoding to gen-erate one inference sentence per example.
bold: bestperformance.
italic: second best performance.
event:whether or not event descriptions are used during train-ing and evaluation..4 experiments.
we describe our experiments in this section.
sec-tion 4.1 is the experimental settings of differentpretraining and initialization strategies.
section 4.2gives the evaluation task and metrics.
we showour results in section 4.3. in section 4.4, we giveexample inferences generated by our model.
wehave the human evaluation results in section 4.5..4.1 settings.
in our experiments, following the base modelfrom lewis et al.
(2020), we ﬁx the model architec-ture to a 6-layer encoder and a 6-layer decoder.
tounderstand how each pretraining task helps modelperformance on the downstream task of vcg, weablate on pretraining tasks.
we use the followingexperimental settings: (1) without any pretraining;(2) only with knowledge-based commonsensegeneration; (3) only with attribute prediction andrelation prediction; (4) only with masked lan-guage modeling and masked region modeling; (4)with all the pretraining tasks combined.
for onlywith knowledge-based commonsense generation,we further compare the model performance before.
and after data ﬁltering (see section 3.2.1)..for each of the above settings, we initialize themodel from random or from bart weights, respec-tively.
besides, we are most interested in the modelperformance under two settings (see the second col-umn of table 4): (1) only using images as inputs;(2) using both images and event descriptions asinputs.
note that when only using images as inputsfor evaluation, we also do not use textual inputsduring pretraining/ﬁnetuning..4.2 evaluation task and metrics.
we evaluate our model on the recently pro-posed visual commonsense generation (vcg)dataset (park et al., 2020).
given an image and adescription of the event in the image, the task aimsto predict events which might happen before/after,and the present intents of the characters in the givenimage.
the dataset consists of 1174k training ex-amples and 146k validation examples.
some exam-ples in the dataset share the same images or events,but with different inferences for events before/afteror intents at present.
table 2 gives an example ofthe dataset.
we report our model performance onthe validation set as the test set is not available yet.
besides event descriptions, the vcg dataset alsoprovides place and person information for each im-age.
note that although park et al.
(2020) alsoleverages the place and person information fortraining and evaluation, we argue that such infor-mation is not generally available in normal settings,where only images and event descriptions are given.
hence, we do not use the place and person informa-tion in our km-bart.
as an additional reference,we nevertheless show in table 5 the best performedmodels from park et al.
(2020), which also useplace and person information..we use three automatic evaluation metrics, in-cluding bleu-2 (papineni et al., 2002), me-teor (denkowski and lavie, 2014),andcider (vedantam et al., 2015).
following parket al.
(2020), we also report unique as the numberof inference sentences unique in generated sen-tences divided by the total number of sentences,and novel as the number of generated sentencesnot in the training data divided by the total numberof sentences..4.3 results.
we ﬁrst ablate on different pretraining tasks to un-derstand the effect of each task.
we then combineall the pretraining tasks together to train our full.
531modalities.
event bleu-2 meteor cider unique novel.
park et al.
(2020)a∗.
park et al.
(2020)b∗ours§.
park et al.
(2020)c∗.
park et al.
(2020)d∗ours†.
image+event+place+personimageimage.
image+event+place+personimage+eventimage+event.
n.nn.y.yy.
10.21.
10.66.
11.86.
33.90.
49.84.
6.799.04.
13.50.
12.5214.21.
7.138.33.
11.55.
10.7311.19.
5.639.12.
26.3850.75.
46.8052.92.
18.27.
44.49.
49.03.
16.4921.23.
42.8357.64.
47.4058.22.table 5: results on vcg validation set with nucleus sampling.
following park et al.
(2020), we use nucleussampling with p = 0.9 to generate ﬁve inference sentences for each example during evaluation.
∗: we directlyuse evaluations from park et al.
(2020).
bold: best performance.
italic: second best performance.
modalities:information used during training.
event: whether or not event descriptions are used during evaluation..model.
as a last step, we pick the best performedmodels to compare against previous state-of-the-artsystem (park et al., 2020)..table 4 shows the effect of each pretraining taskto our km-bart on the vcg dataset.
we can seethat all our pretraining tasks help improve modelperformance.
most importantly, we observe thatalthough ﬁltering on the commonsense generationpretraining task reduces the dataset size by morethan 60%, pretraining with kcg still reaches com-parable or better performance than pretraining withkcg (before ﬁltering).
this demonstrates that ourself-training based ﬁltering technique is helpful,as it helps the model reach similar or even betterperformance with less training data.
the advan-tage is most evident when we initialize from bartparameters and use both images and event descrip-tions as inputs.
under this setting, pretraining withkcg outperforms pretraining with kcg (beforeﬁltering) in terms of all the evaluation metrics..for using both images and event descriptions asinputs, the model performs better when initializedfrom pretrained bart parameters.
as pretrainedbart can better leverage the information in theevent descriptions.
hence, to obtain our full km-bart model for using images and events as inputs,we adopt the setting of initializing from bartparameters.
experimental results show that ourfull model† reaches high performance on bleu-2,meteor and cider, and that the full model†generates the most unique and novel inferences..for using only images as inputs, models initial-izing from random parameters outperforms thoseinitialized from bart parameters.
we argue thatinitializing from bart parameters results in op-timization disadvantages where the model has toswitch from pure textual inputs to pure visual in-puts.
this observation becomes evident as the.
model performs the worst when no pretraining isused, which indicates that the model has to entirelyrely on ﬁnetuning on the vcg dataset to adapt tovisual inputs.
therefore, for using only images asinputs, we obtain our full km-bart model by ini-tializing from random parameters.
our full model§reaches best performance on bleu-2, meteorand cider, and is the second best in terms ofunique..in table 5, we compare our full model to pre-vious state-of-the-art (park et al., 2020).3 we ob-serve that although our full model† taking as inputsimages and event descriptions does not use placeand person information, the model still outper-forms previous state-of-the-art (park et al.
(2020)c).
for using only images as inputs, our model§ alsoperforms better than previous results (park et al.
(2020)b).
furthermore, our model§ reaches compa-rable performance to park et al.
(2020)a in termsof bleu-2, meteor and cider, with muchhigher performance on uniqueness and novelty,even though our model§ uses much less informationduring training compared to park et al.
(2020)a..4.4 case study.
in table 2, we show example inferences and com-pare the results of our model predictions to theground truths.
the generated sentences from themodel without event descriptions as inputs can al-ready capture the most important information ofcommonsense.
we also observe that adding eventdescriptions to the inputs helps the model gener-ate more details.
we gives more examples of ourmodel in the appendix..3note that model performance in table 5 is not directlycomparable to that of table 4 as we use different decodingstrategies to generate different number of inference sentencesper example in these two tables..532models.
event before after.
intent total.
park et al.
(2020)c∗ours§park et al.
(2020)c∗ours†.
nn.yy.
38.761.3.
48.052.0.
31.368.7.
48.052.0.
30.769.3.
38.761.3.
33.366.7.
44.955.1.table 6: human evaluation results.
we compare theinference generated by our best model under the set-ting of with event or without event.
† and § indicatecorresponding models in table 4. we use park et al.
(2020)c∗ for both with event and without event as parket al.
(2020) only release the weights of this model..4.5 human evaluation.
we conduct human evaluation to further understandhow humans perceive the inferences generated byour km-bart.
we employ a comparison approachfor a better assessment between our km-bart andthe model from park et al.
(2020).
to be speciﬁc,we randomly sample 30 examples from the vcgvalidation set.
for each example, we use our km-bart or the baseline model to generate 5 sets ofinferences, each of which consist of the task typebefore, after, and intent..we use two settings for our human evaluation:(1) with event: event descriptions are given as in-put during inference time; (2) without event: eventdescriptions are not given during inference time.
under each of the settings we compare our km-bart model with the mode from park et al.
(2020).
we use the same 30 examples for each model underthe two settings.
for each example in a task type(before, after, or intent), we generate 5 inferencesfor one model of each setting.
in total, we gener-ate 450 inferences for each model of each settingduring the human evaluation..for the same example, we use our km-bartand the model from park et al.
(2020) to generate aninference under one of the three task types, then theworkers choose the more reasonable inference fromthe two generated inferences.
we hire three work-ers from amazon mechanical turk4 to evaluateeach inference.
we take the majority of the threeworkers as the ﬁnal evaluation for an inference.
among all the inferences, we use the percentage ofone model better than another model as the scoreof that model.
for example, in table 6, the score ofour model (ours§) is 61.3 for the task type beforewhen event descriptions are missing.
this indicatesthat our model is better than the baseline model forthe task type before in 61.3% of the cases.
we also.
4https://www.mturk.com/.
take the average over the three task types as theﬁnal score (see total in table 6)..from table 6, we can observe that our modeloutperforms park et al.
(2020) under both of thesettings.
to be speciﬁc, when event descriptions arenot given, among all the inferences, our model isbetter than park et al.
(2020) in 66.7% of the cases.
furthermore, our model has a lead of at least 22.6%over park et al.
(2020) in each individual task.
forexample, our model generates better inferences in68.7% of the cases in task type after, while themodel from park et al.
(2020) is only better thanour model in 31.3% of the cases.
we can obtainsimilar results when looking at the task type beforeand intent..when event descriptions are given, our model isstill better than park et al.
(2020) in 55.1% of allthe cases.
for each individual task, the advantageof our model is smaller when event descriptions aregiven than when event descriptions are not given,showing that our model can better capture informa-tion from the images..5 conclusion and future work.
in this paper, we propose knowledge enhancedmultimodal bart (km-bart), which is atransformer-based model capable of reasoningabout and generating commonsense descriptionsfrom cross modality inputs of images and texts.
wepropose the pretraining task of knowledge-basedcommonsense generation, which improves the rea-soning ability of km-bart by leveraging a largelanguage model pretrained on external common-sense knowledge graphs.
we use the self-trainingtechnique to ﬁlter the automatically generated com-monsense descriptions.
experimental results onthe vcg task show that our km-bart pretrainedon the pretraining tasks reaches state-of-the-art per-formance.
further human evaluation demonstratesthat our km-bart can generate commonsenseinferences of high quality..for future work, we plan to further expand ourpretraining dataset for knowledge-based common-sense generation by including the conceptual cap-tions dataset (sharma et al., 2018).
furthermore,while we argue that place and person informationis not generally available in practical scenarios, westill plan to add place and person information toour model in the future..533references.
stanislaw antol, aishwarya agrawal, jiasen lu, mar-garet mitchell, dhruv batra, c. lawrence zitnick,and devi parikh.
2015. vqa: visual question an-swering.
in iccv..antoine bosselut, hannah rashkin, maarten sap, chai-tanya malaviya, asli c¸ elikyilmaz, and yejin choi.
2019. comet: commonsense transformers for au-tomatic knowledge graph construction.
in acl..yen-chun chen, linjie li, licheng yu, ahmed elkholy, faisal ahmed, zhe gan, yu cheng, andjingjing liu.
2020. uniter: universal image-textrepresentation learning.
in eccv..michael denkowski and alon lavie.
2014. meteor uni-versal: language speciﬁc translation evaluation forin proceedings of the ninthany target language.
workshop on statistical machine translation..jacob devlin, ming-wei chang, kenton lee, andkristina toutanova.
2019. bert: pre-training ofdeep bidirectional transformers for language under-standing.
in naacl..david gunning.
2018. machine common sense con-.
cept paper.
arxiv preprint arxiv:1810.07528..kaiming he, georgia gkioxari, piotr doll´ar, andross b. girshick.
2017. mask r-cnn.
in iccv..ranjay krishna, yuke zhu, oliver groth, justin john-son, kenji hata, joshua kravitz, stephanie chen,yannis kalantidis, li-jia li, david a shamma, et al.
2017. visual genome: connecting language and vi-sion using crowdsourced dense image annotations.
international journal of computer vision, 123(1):32–73..mike lewis, yinhan liu, naman goyal, mar-jan ghazvininejad, abdelrahman mohamed, omerlevy, veselin stoyanov, and luke zettlemoyer.
2020. bart: denoising sequence-to-sequence pre-training for natural language generation, translation,and comprehension.
in acl..kunpeng li, yulun zhang, kai li, yuanyuan li, andyun fu.
2019. visual semantic reasoning for image-text matching.
in iccv..xiujun li, xi yin, chunyuan li, pengchuan zhang, xi-aowei hu, lei zhang, lijuan wang, houdong hu,li dong, furu wei, yejin choi, and jianfeng gao.
2020. oscar: object-semantics aligned pre-trainingfor vision-language tasks.
in eccv..bill yuchen lin, xinyue chen, jamin chen, and xi-ang ren.
2019. kagnet: knowledge-aware graphnetworks for commonsense reasoning.
in emnlp..tsung-yi lin, michael maire, serge j. belongie, jameshays, pietro perona, deva ramanan, piotr doll´ar,and c. lawrence zitnick.
2014. microsoft coco:common objects in context.
in eccv..yinhan liu, myle ott, naman goyal, jingfei du, man-dar joshi, danqi chen, omer levy, mike lewis,luke zettlemoyer, and veselin stoyanov.
2019.roberta: a robustly optimized bert pretraining ap-proach.
arxiv preprint arxiv:1907.11692..jiasen lu, dhruv batra, devi parikh, and stefanlee.
2019. vilbert: pretraining task-agnostic visi-olinguistic representations for vision-and-languagetasks.
in neurips..vicente ordonez, girish kulkarni, and tamara l. berg.
2011. im2text: describing images using 1 millioncaptioned photographs.
in neurips..kishore papineni, salim roukos, todd ward, and wei-jing zhu.
2002. bleu: a method for automatic eval-uation of machine translation.
in acl..jae sung park, chandra bhagavatula, roozbeh mot-taghi, ali farhadi, and yejin choi.
2020. visual-comet: reasoning about the dynamic context of astill image.
in eccv..alec radford, jeffrey wu, rewon child, david luan,dario amodei, and ilya sutskever.
2019. languagemodels are unsupervised multitask learners.
openaiblog..nazneen fatema rajani, bryan mccann, caimingxiong, and richard socher.
2019. explain yourself!
leveraging language models for commonsense rea-soning.
in acl..maarten sap, ronan le bras, emily allaway, chan-dra bhagavatula, nicholas lourie, hannah rashkin,brendan roof, noah a. smith, and yejin choi.
2019.atomic: an atlas of machine commonsense for if-then reasoning.
in aaai..maarten sap, vered shwartz, antoine bosselut, yejinchoi, and dan roth.
2020. commonsense reason-ing for natural language processing.
in acl..piyush sharma, nan ding, sebastian goodman, andradu soricut.
2018.conceptual captions: acleaned, hypernymed, image alt-text dataset for au-tomatic image captioning.
in acl..robyn speer, joshua chin, and catherine havasi.
2017.conceptnet 5.5: an open multilingual graph of gen-eral knowledge.
in aaai..hao tan and mohit bansal.
2019. lxmert: learningcross-modality encoder representations from trans-formers.
in emnlp..trieu h trinh and quoc v le.
2018. a simplemethod for commonsense reasoning.
arxiv preprintarxiv:1806.02847..r. vedantam, c. l. zitnick, and d. parikh.
2015. cider:consensus-based image description evaluation.
incvpr..534quanzeng you, hailin jin, zhaowen wang, chen fang,and jiebo luo.
2016. image captioning with seman-tic attention.
in cvpr..fei yu, jiji tang, weichong yin, yu sun, haotian, hua wu, and haifeng wang.
2020. ernie-vil: knowledge enhanced vision-language repre-arxiv preprintsentations through scene graph.
arxiv:2006.16934..rowan zellers, yonatan bisk, ali farhadi, and yejinchoi.
2019. from recognition to cognition: visualcommonsense reasoning.
in cvpr..luowei zhou, hamid palangi, lei zhang, houdonghu, jason j. corso, and jianfeng gao.
2020. uni-ﬁed vision-language pre-training for image caption-ing and vqa.
in aaai..535