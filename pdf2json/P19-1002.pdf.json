{
  "name" : "P19-1002.pdf",
  "metadata" : {
    "source" : "META",
    "title" : "Incremental Transformer with Deliberation Decoder for Document Grounded Conversations",
    "authors" : [ "Zekang Li", "Cheng Niu", "Fandong Meng", "Yang Feng", "Qian Li", "Jie Zhou" ],
    "emails" : [ "zekangli97@gmail.com,", "chengniu@tencent.com", "fandongmeng@tencent.com", "jiezhou@tencent.com", "fengyang@ict.ac.cn,", "qianli@stumail.neu.edu.cn" ],
    "sections" : [ {
      "heading" : null,
      "text" : "Proceedings of the 57th Annual Meeting of the Association for Computational Linguistics, pages 12–21 Florence, Italy, July 28 - August 2, 2019. c©2019 Association for Computational Linguistics\n12"
    }, {
      "heading" : "1 Introduction",
      "text" : "Past few years have witnessed the rapid development of dialogue systems. Based on the sequenceto-sequence framework (Sutskever et al., 2014), most models are trained in an end-to-end manner with large corpora of human-to-human dialogues and have obtained impressive success (Shang et al., 2015; Vinyals and Le, 2015; Li et al., 2016; Serban et al., 2016). While there is still a long way for reaching the ultimate goal of dialogue systems, which is to be able to talk like humans. And one of the essential intelligence to achieve this goal is the ability to make use of knowledge.\n∗ Fandong Meng is the corresponding author of the paper. This work was done when Zekang Li was interning at Pattern Recognition Center, WeChat AI, Tencent.\nThere are several works on dialogue systems exploiting knowledge. The Mem2Seq (Madotto et al., 2018) incorporates structured knowledge into the end-to-end task-oriented dialogue. Liu et al. (2018) introduces factmatching and knowledge-diffusion to generate meaningful, diverse and natural responses using structured knowledge triplets. Ghazvininejad et al. (2018), Parthasarathi and Pineau (2018), Yavuz et al. (2018), Dinan et al. (2018) and Lo and Chen (2019) apply unstructured text facts in open-domain dialogue systems. These works mainly focus on integrating factoid knowledge into dialogue systems, while factoid knowledge requires a lot of work to build up, and is only limited to expressing precise facts. Documents as a knowledge source provide a wide spectrum of knowledge, including but not limited to factoid, event updates, subjective opinion, etc. Recently, intensive research has been applied on using documents as knowledge sources for QuestionAnswering (Chen et al., 2017; Huang et al., 2018; Yu et al., 2018; Rajpurkar et al., 2018; Reddy et al., 2018).\nThe Document Grounded Conversation is a task to generate natural dialogue responses when chatting about the content of a specific document. This task requires to integrate document knowledge with the multi-turn dialogue history. Different from previous knowledge grounded dialogue systems, Document Grounded Conversations utilize documents as the knowledge source, and hence are able to employ a wide spectrum of knowledge. And the Document Grounded Conversations is also different from document QA since the contextual consistent conversation response should be generated. To address the Document Grounded Conversation task, it is important to: 1) Exploit document knowledge which are relevant to the\nconversation; 2) Develop a unified representation combining multi-turn utterances along with the relevant document knowledge.\nIn this paper, we propose a novel and effective Transformer-based (Vaswani et al., 2017) architecture for Document Grounded Conversations, named Incremental Transformer with Deliberation Decoder. The encoder employs a transformer architecture to incrementally encode multi-turn history utterances, and incorporate document knowledge into the the multi-turn context encoding process. The decoder is a two-pass decoder similar to the Deliberation Network in Neural Machine Translation (Xia et al., 2017), which is designed to improve the context coherence and knowledge correctness of the responses. The first-pass decoder focuses on contextual coherence, while the second-pass decoder refines the result of the firstpass decoder by consulting the relevant document knowledge, and hence increases the knowledge relevance and correctness. This is motivated by human cognition process. In real-world human conversations, people usually first make a draft on how to respond the previous utterance, and then consummate the answer or even raise questions by consulting background knowledge.\nWe test the effectiveness of our proposed model on Document Grounded Conversations Dataset (Zhou et al., 2018). Experiment results show that our model is capable of generating responses of more context coherence and knowledge relevance. Sometimes document knowledge is even well used to guide the following conversations. Both automatic and manual evaluations show that our model substantially outperforms the competitive baselines.\nOur contributions are as follows:\n• We build a novel Incremental Transformer to incrementally encode multi-turn utterances with document knowledge together.\n• We are the first to apply a two-pass decoder to generate responses for document grounded conversations. Two decoders focus on context coherence and knowledge correctness respectively."
    }, {
      "heading" : "2 Approach",
      "text" : ""
    }, {
      "heading" : "2.1 Problem Statement",
      "text" : "Our goal is to incorporate the relevant document knowledge into multi-turn conversations.\nFormally, let U = u(1), ...,u(k), ...,u(K) be a whole conversation composed of K utterances. We use u(k) = u(k)1 , ..., u (k) i , ..., u (k) I to denote the k-th utterance containing I words, where u(k)i denotes the i-th word in the k-th utterance. For each utterance u(k), likewise, there is a specified relevant document s(k) = s(k)1 , ..., s (k) j , ..., s (k) J , which represents the document related to the kth utterance containing J words. We define the document grounded conversations task as generating a response u(k+1) given its related document s(k+1) and previous k utterances U≤k with related documents S≤k, where U≤k = u(1), ...,u(k) and S≤k = s(1), ..., s(k). Note that s(k), s(k+1), ..., s(k+n) may be the same.\nTherefore, the probability to generate the response u(k+1) is computed as:\nP (u(k+1)|U≤k,S≤k+1; θ) = ∏I i=1 P (u k+1 i |U≤k,S≤k+1, u (k+1) <i ; θ)\n(1) where u(k+1)<i = u (k+1) 1 , ..., u (k+1) i−1 ."
    }, {
      "heading" : "2.2 Model Description",
      "text" : "Figure 1 shows the framework of the proposed Incremental Transformer with Deliberation De-\ncoder. Please refer to Figure 2 (1) for more details. It consists of three components:\n1) Self-Attentive Encoder (SA) (in orange) is a transformer encoder as described in (Vaswani et al., 2017), which encodes the document knowledge and the current utterance independently.\n2) Incremental Transformer Encoder (ITE) (on the top) is a unified transformer encoder which encodes multi-turn utterances with knowledge representation using an incremental encoding scheme. This module takes previous utterances u(i) and the document s(i)’s SA representation as input, and use attention mechanism to incrementally build up the representation of relevant context and document knowledge.\n3) Deliberation Decoder (DD) (on the bottom) is a two-pass unified transformer decoder for better generating the next response. The first-pass decoder takes current utterance u(k)’s SA representation and ITE output as input, and mainly relies on conversation context for response generation. The second-pass decoder takes the SA representation of the first pass result and the relevant document s(k+1)’s SA representation as input, and uses document knowledge to further refine the response.\nSelf-Attentive Encoder\nAs document knowledge often includes several sentences, it’s important to capture long-range dependencies and identify relevant information. We use multi-head self-attention (Vaswani et al.,\n2017) to compute the representation of document knowledge.\nAs shown in Figure 2 (a), we use a selfattentive encoder to compute the representation of the related document knowledge s(k). The input (In(k)s ) of the encoder is a sequence of document words embedding with positional encoding added.(Vaswani et al., 2017):\nIn(k)s = [s (k) 1 , ..., s (k) J ] (2)\ns (k) j = esj + PE(j) (3)\nwhere esj is the word embedding of s (k) j and PE(·) denotes positional encoding function. The Self-Attentive encoder contains a stack of Nx identical layers. Each layer has two sublayers. The first sub-layer is a multi-head selfattention (MultiHead) (Vaswani et al., 2017). MultiHead(Q,K,V) is a multi-head attention function that takes a query matrix Q, a key matrix K, and a value matrix V as input. In current case, Q = K = V. That’s why it’s called self-attention. And the second sub-layer is a simple, position-wise fully connected feed-forward network (FFN). This FFN consists of two linear transformations with a ReLU activation in between. (Vaswani et al., 2017).\nA(1) = MultiHead(In(k)s , In (k) s , In (k) s ) (4)\nD(1) = FFN(A(1)) (5)\nFFN(x) = max(0, xW1 + b1)W2 + b2 (6)\nwhere A(1) is the hidden state computed by multihead attention at the first layer, D(1) denotes the representation of s(k) after the first layer. Note that residual connection and layer normalization are used in each sub-layer, which are omitted in the presentation for simplicity. Please refer to (Vaswani et al., 2017) for more details.\nFor each layer, repeat this process:\nA(n) = MultiHead(D(n−1),D(n−1),D(n−1)) (7)\nD(n) = FFN(A(n)) (8)\nwhere n = 1, ..., Ns and D(0) = In(k)s . We use SAs(·) to denote this whole process:\nd(k) = D(Nx) = SAs(s (k)) (9)\nwhere d(k) is the final representation for the document knowledge s(k).\nSimilarly, for each utterance u(k), we use In(k)u = [u (k) 1 , ...,u (k) I ] to represent the sequence of the position-aware word embedding. Then the same Self-Attentive Encoder is used to compute the representation of current utterance u(k), and we use SAu(u(k)) to denote this encoding result. The Self-Attentive Encoder is also used to encode the document s(k+1) and the first pass decoding results in the second pass of the decoder. Note that SAs and SAu have the same architecture but different parameters. More details about this will be mentioned in the following sections.\nIncremental Transformer Encoder To encode multi-turn document grounded utterances effectively, we design an Incremental Transformer Encoder. Incremental Transformer uses multi-head attention to incorporate document knowledge and context into the current utterance’s encoding process. This process can be stated recursively as follows:\nc(k) = ITE(c(k−1),d(k), In(k)u ) (10)\nwhere ITE(·) denotes the encoding function, c(k) denotes the context state after encoding utterance u(k), c(k−1) is the context state after encoding last utterance u(k−1), d(k) is the representation of document s(k) and In(k)u is the embedding of current utterance u(k).\nAs shown in Figure 2 (b), we use a stack of Nu identical layers to encode u(k). Each layer consists of four sub-layers. The first sub-layer is a multihead self-attention:\nB(n) = MultiHead(C(n−1),C(n−1),C(n−1)) (11)\nwhere n = 1, ..., Nu, C(n−1) is the output of the last layer and C(0) = In(k)u . The second sub-layer is a multi-head knowledge attention:\nE(n) = MultiHead(B(n),d(k),d(k)) (12)\nThe third sub-layer is a multi-head context attention:\nF(n) = MultiHead(E(n), c(k−1), c(k−1)) (13)\nwhere c(k−1) is the representation of the previous utterances. That’s why we called the encoder ”Incremental Transformer”. The fourth sub-layer is a position-wise fully connected feed-forward network:\nC(n) = FFN(F(n)) (14)\nWe use c(k) to denote the final representation at Nu-th layer:\nc(k) = C(Nu) (15)\nDeliberation Decoder Motivated by the real-world human cognitive process, we design a Deliberation Decoder containing two decoding passes to improve the knowledge relevance and context coherence. The first-pass decoder takes the representation of current utterance SAu(u(k)) and context c(k) as input and focuses on how to generate responses contextual coherently. The second-pass decoder takes the representation of the first-pass decoding results and related document s(k+1) as input and focuses on increasing knowledge usage and guiding the following conversations within the scope of the given document.\nWhen generating the i-th response word u(k+1)i , we have the generated words u(k+1)<i as input (Vaswani et al., 2017). We use In(k+1)r to denote the matrix representation of u(k+1)<i as following:\nIn(k+1)r = [u (k+1) 0 ,u (k+1) 1 , ...,u (k+1) i−1 ] (16)\nwhere u(k+1)0 is the vector representation of sentence-start token.\nAs shown in Figure 2 (c), the Deliberation Decoder consists of a first-pass decoder and a second-pass decoder. These two decoders have the same architecture but different input for sublayers. Both decoders are composed of a stack of Ny identical layers. Each layer has four sublayers. For the first-pass decoder, the first sublayer is a multi-head self-attention:\nG (n) 1 = MultiHead(R (n−1) 1 ,R (n−1) 1 ,R (n−1) 1 )\n(17)\nwhere n = 1, ..., Ny, R (n−1) 1 is the output of the previous layer, and R(0)1 = In (k+1) r . The second sub-layer is a multi-head context attention:\nH (n) 1 = MultiHead(G (n) 1 , c (k), c(k)) (18) where c(k) is the representation of context u≤k. The third sub-layer is a multi-head utterance attention:\nM (n) 1 = MultiHead(H (n) 1 , SAu(u (k)),\nSAu(u (k)))\n(19) where SAu(·) is a Self-Attentive Encoder which encodes latest utterance u(k). Eq. (18) mainly encodes the context and document knowledge relevant to the latest utterance, while Eq. (19) encodes the latest utterance directly. We hope optimal performance can be achieved by combining both.\nThe fourth sub-layer is a position-wise fully connected feed-forward network:\nR (n) 1 = FFN(M (n) 1 ) (20)\nAfter Ny layers, we use softmax to get the words probabilities decoded by first-pass decoder:\nP (û (k+1) (1) ) = softmax(R (Ny) 1 ) (21)\nwhere û(k+1)(1) is the response decoded by the firstpass decoder. For second-pass decoder:\nG (n) 2 = MultiHead(R (n−1) 2 ,R (n−1) 2 ,R (n−1) 2 ) (22) H\n(n) 2 = MultiHead(G (n) 2 ,d (k+1),d(k+1)) (23)\nM (n) 2 = MultiHead(H (n) 2 , SAu(û (k+1) (1) ),\nSAu(û (k+1) (1) ))\n(24) R\n(n) 2 = FFN(M (n) 2 ) (25)\nP (û (k+1) (2) ) = softmax(R (Ny) 2 ) (26)\nwhere R(n−1)2 is the counterpart to R (n−1) 1 in pass two decoder, referring to the output of the previous layer. d(k+1) is the representation of document s(k+1) using Self-Attentive Encoder, û(k+1)(2) is the output words after the second-pass decoder.\nTraining In contrast to the original Deliberation Network (Xia et al., 2017), where they propose a complex joint learning framework using Monte Carlo Method, we minimize the following loss as Xiong et al. (2018) do:\nLmle = Lmle1 + Lmle2 (27)\nLmle1 = − K∑ k=1 I∑ i=1 logP (û (k+1) (1)i ) (28) Lmle2 = − K∑ k=1 I∑ i=1 logP (û (k+1) (2)i ) (29)"
    }, {
      "heading" : "3 Experiments",
      "text" : ""
    }, {
      "heading" : "3.1 Dataset",
      "text" : "We evaluate our model using the Document Grounded Conversations Dataset (Zhou et al., 2018). There are 72922 utterances for training, 3626 utterances for validation and 11577 utterances for testing. The utterances can be either casual chats or document grounded. Note that we consider consequent utterances of the same person as one utterance. For example, we consider A: Hello! B: Hi! B: How’s it going? as A: Hello! B: Hi! How’s it going?. And there is a related document given for every several consequent utterances, which may contain movie name, casts, introduction, ratings, and some scenes. The average length of documents is about 200. Please refer to (Zhou et al., 2018) for more details."
    }, {
      "heading" : "3.2 Baselines",
      "text" : "We compare our proposed model with the following state-of-the-art baselines: Models not using document knowledge:\nSeq2Seq: A simple encoder-decoder model (Shang et al., 2015; Vinyals and Le, 2015) with global attention (Luong et al., 2015). We concatenate utterances context to a long sentence as input.\nHRED: A hierarchical encoder-decoder model (Serban et al., 2016), which is composed of a word-level LSTM for each sentence and a sentence-level LSTM connecting utterances.\nTransformer: The state-of-the-art NMT model based on multi-head attention (Vaswani et al., 2017). We concatenate utterances context to a long sentence as its input. Models using document knowledge:\nSeq2Seq (+knowledge) and HRED (+knowledge) are based on Seq2Seq and HRED respectively. They both concatenate document knowledge representation and last decoding output embedding as input when decoding. Please refer to (Zhou et al., 2018) for more details.\nWizard Transformer: A Transformer-based model for multi-turn open-domain dialogue with unstructured text facts (Dinan et al., 2018). It concatenates context utterances and text facts to a long\nsequence as input. We replace the text facts with document knowledge.\nHere, we also conduct an ablation study to illustrate the validity of our proposed Incremental Transformer Encoder and Deliberation Decoder.\nITE+CKAD: It uses Incremental Transformer Encoder (ITE) as encoder and ContextKnowledge-Attention Decoder (CKAD) as shown in Figure 2 (e). This setup is to test the validity of the deliberation decoder.\nKnowledge-Attention Transformer (KAT): As shown in Figure 2 (d), the encoder of this model is a simplified version of Incremental Transformer Encoder (ITE), which doesn’t have context-attention sub-layer. We concatenate utterances context to a long sentence as its input. The decoder of the model is a simplified Context-Knowledge-Attention Decoder (CKAD). It doesn’t have context-attention sub-layer either. This setup is to test how effective the context has been exploited in the full model."
    }, {
      "heading" : "3.3 Experiment Setup",
      "text" : "We use OpenNMT-py1 (Klein et al., 2017) as the code framework2. For all models, the hidden size is set to 512. For rnn-based models (Seq2Seq, HRED), 3-layer bidirectional LSTM (Hochreiter\n1https://github.com/OpenNMT/OpenNMT-py 2The code and models are available at https://\ngithub.com/lizekang/ITDD\nand Schmidhuber, 1997) and 1-layer LSTM is applied for encoder and decoder respectively. For transformer-based models, the layers of both encoder and decoder are set to 3. The number of attention heads in multi-head attention is 8 and the filter size is 2048. The word embedding is shared by utterances, knowledge and generated responses. The dimension of word embedding is set to 512 empirically. We use Adam (Kingma and Ba, 2014) for optimization. When decoding, beam size is set to 5. We use the previous three utterances and its related documents as input."
    }, {
      "heading" : "3.4 Evaluation Metrics",
      "text" : "Automatic Evaluation: We adopt perplexity (PPL) and BLEU (Papineni et al., 2002) to automatically evaluate the response generation performance. Models are evaluated using perplexity of the gold response as described in (Dinan et al., 2018). Lower perplexity indicates better performance. BLEU measures n-gram overlap between a generated response and a gold response. However, since there is only one reference for each response and there may exist multiple feasible responses, BLEU scores are extremely low. We compute BLEU score by the multi-bleu.perl3 Manual Evaluation: Manual evaluations are essential for dialogue generation. We randomly sampled 30 conversations containing 606 utterances from the test set and obtained 5454 utterances from the nine models. We have annotators score these utterances given its previous utterances and related documents. We defined three metrics - fluency, knowledge relevance (Liu et al., 2018) and context coherence for manual evaluation. All these metrics are scored 0/1/2.\nfluency: Whether the response is natural and\n3https://github.com/google/seq2seq/ blob/master/bin/tools/multi-bleu.perl\nfluent. Score 0 represents not fluent and incomprehensible; 1 represents partially fluent but still comprehensible; 2 represents totally fluent.\nknowledge relevance: Whether the response uses relevant and correct knowledge. Score 0 represents no relevant knowledge; 1 represents containing relevant knowledge but not correct; 2 represents containing relevant knowledge and correct.\ncontext coherence: Whether the response is coherent with the context and guides the following utterances. Score 0 represents not coherent or leading the dialogue to an end; 1 represents coherent with the utterance history but not guiding the following utterances; 2 represents coherent with utterance history and guiding the next utterance."
    }, {
      "heading" : "3.5 Experimental Results",
      "text" : "Table 1 shows the automatic and manual evaluation results for both the baseline and our models.\nIn manual evaluation, among baselines, Wizard Transformer and RNN without knowledge have the highest fluency of 1.62 and Wizard obtains the highest knowledge relevance of 0.47 while Transformer without knowledge gets the highest context coherence of 0.67. For all models, ITE+CKAD\nobtains the highest fluency of 1.68 and ITE+DD has the highest Knowledge Relevance of 0.56 and highest Context Coherence of 0.90.\nIn automatic evaluation, our proposed model has lower perplexity and higher BLEU scores than baselines. For BLEU, HRED with knowledge obtains the highest BLEU score of 0.77 among the baselines. And ITE+DD gets 0.95 BLEU score, which is the highest among all the models. For perplexity, Wizard Transformer obtains the lowest perplexity of 70.30 among baseline models and ITE+DD has remarkably lower perplexity of 15.11 than all the other models. A detailed analysis is in Section 3.6."
    }, {
      "heading" : "3.6 Analysis and Discussion",
      "text" : "To our surprise, ITE+DD reaches an extremely low ground truth perplexity. We find that the ground truth perplexity after the first-pass decoding is only similar to the ITE+CKAD. It shows that the second-pass decoder utilizes the document knowledge well, and dramatically reduced the ground truth perplexity.\nAs shown in Table 2, ITE+DD has a higher percent of score 2 both on Knowledge Relevance and\nContext Coherence than ITE+CKAD. This result also demonstrates that Deliberation Decoder can improve the knowledge correctness and guide the following conversations better.\nAlthough the perplexity of ITE+CKAD is only slightly better than KAT, the BLEU score, Fluency, Knowledge Relevance and Context Coherence of ITE+CKAD all significantly outperform those of KAT model, which indicates that Incremental Transformer can deal with multi-turn document grounded conversations better.\nWizard Transformer has a great performance on Knowledge Relevance only second to our proposed Incremental Transformer. However, its score on Context Coherence is lower than some other baselines. As shown in Table 2, Wizard Transformer has Knowledge Relevance score 1 results twice more than score 2 results, which indicates that the model tends to generate responses with related knowledge but not correct. And the poor performance on Context Coherence also shows Wizard Transformer does not respond to the previous utterance well. This shows the limitation of representing context and document knowledge by simple concatenation."
    }, {
      "heading" : "3.7 Case Study",
      "text" : "In this section, we list some examples to show the effectiveness of our proposed model. Table 3 lists some responses generated by our proposed Incremental Transformer with Deliberation Decoder (ITE+DD) and Wizard Transformer (which achieves overall best performance among\nbaseline models). Our proposed model can generate better responses than Wizard Transformer on knowledge relevance and context coherence.\nTo demonstrate the effectiveness of the twopass decoder, we compare the results from the first-pass decoding and the second-pass decoding. Table 4 shows the improvement after the secondpass decoding. For Case 1, the second-pass decoding result revises the knowledge error in the first-pass decoding result. For Case 2, the secondpass decoder uses more detailed knowledge than the first-pass one. For Case 3, the second-pass decoder cannot only respond to the previous utterance but also guide the following conversations by asking some knowledge related questions."
    }, {
      "heading" : "4 Related Work",
      "text" : "The closest work to ours lies in the area of opendomain dialogue system incorporating unstructured knowledge. Ghazvininejad et al. (2018) uses an extended Encoder-Decoder where the decoder is provided with an encoding of both the context and the external knowledge. Parthasarathi and Pineau (2018) uses an architecture containing a Bag-of-Words Memory Network fact encoder and an RNN decoder. Dinan et al. (2018) combines Memory Network architectures to retrieve, read and condition on knowledge, and Transformer architectures to provide text representation and generate outputs. Different from these works, we greatly enhance the Transformer architectures to handle the document knowledge in multi-turn dialogue from two aspects: 1) using attention mechanism to combine document knowledge and context utterances; and 2) exploiting incremental encoding scheme to encode multi-turn knowledge aware conversations.\nOur work is also inspired by several works in other areas. Zhang et al. (2018) introduces document context into Transformer on document-level Neural Machine Translation (NMT) task. Guan et al. (2018) devises the incremental encoding scheme based on rnn for story ending generation task. In our work, we design an Incremental Transformer to achieve a knowledge-aware context representation using an incremental encoding scheme. Xia et al. (2017) first proposes Deliberation Network based on rnn on NMT task. Our Deliberation Decoder is different in two aspects: 1) We clearly devise the two decoders targeting context and knowledge respectively; 2) Our sec-\nond pass decoder directly fine tunes the first pass result, while theirs uses both the hidden states and results from the first pass."
    }, {
      "heading" : "5 Conclusion and Future Work",
      "text" : "In this paper, we propose an Incremental Transformer with Deliberation Decoder for the task of Document Grounded Conversations. Through an incremental encoding scheme, the model achieves a knowledge-aware and context-aware conversation representation. By imitating the real-world human cognitive process, we propose a Deliberation Decoder to optimize knowledge relevance and context coherence. Empirical results show that the proposed model can generate responses with much more relevance, correctness, and coherence compared with the state-of-the-art baselines. In the future, we plan to apply reinforcement learning to further improve the performance."
    }, {
      "heading" : "6 Acknowledgments",
      "text" : "This work is supported by 2018 Tencent RhinoBird Elite Training Program, National Natural Science Foundation of China (NO. 61662077, NO.61876174) and National Key R&D Program of China (NO.YS2017YFGH001428). We sincerely thank the anonymous reviewers for their thorough reviewing and valuable suggestions."
    } ],
    "references" : [ {
      "title" : "Reading wikipedia to answer opendomain questions",
      "author" : [ "Danqi Chen", "Adam Fisch", "Jason Weston", "Antoine Bordes." ],
      "venue" : "Proceedings of the 55th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), volume 1,",
      "citeRegEx" : "Chen et al\\.,? 2017",
      "shortCiteRegEx" : "Chen et al\\.",
      "year" : 2017
    }, {
      "title" : "Wizard of wikipedia: Knowledge-powered conversational agents",
      "author" : [ "Emily Dinan", "Stephen Roller", "Kurt Shuster", "Angela Fan", "Michael Auli", "Jason Weston." ],
      "venue" : "arXiv preprint arXiv:1811.01241.",
      "citeRegEx" : "Dinan et al\\.,? 2018",
      "shortCiteRegEx" : "Dinan et al\\.",
      "year" : 2018
    }, {
      "title" : "A knowledge-grounded neural conversation model",
      "author" : [ "Marjan Ghazvininejad", "Chris Brockett", "Ming-Wei Chang", "Bill Dolan", "Jianfeng Gao", "Wen-tau Yih", "Michel Galley." ],
      "venue" : "Thirty-Second AAAI Conference on Artificial Intelligence.",
      "citeRegEx" : "Ghazvininejad et al\\.,? 2018",
      "shortCiteRegEx" : "Ghazvininejad et al\\.",
      "year" : 2018
    }, {
      "title" : "Story ending generation with incremental encoding and commonsense knowledge",
      "author" : [ "Jian Guan", "Yansen Wang", "Minlie Huang." ],
      "venue" : "arXiv preprint arXiv:1808.10113.",
      "citeRegEx" : "Guan et al\\.,? 2018",
      "shortCiteRegEx" : "Guan et al\\.",
      "year" : 2018
    }, {
      "title" : "Long short-term memory",
      "author" : [ "Sepp Hochreiter", "Jürgen Schmidhuber." ],
      "venue" : "Neural computation, 9(8):1735–1780.",
      "citeRegEx" : "Hochreiter and Schmidhuber.,? 1997",
      "shortCiteRegEx" : "Hochreiter and Schmidhuber.",
      "year" : 1997
    }, {
      "title" : "Flowqa: Grasping flow in history for conversational machine comprehension",
      "author" : [ "Hsin-Yuan Huang", "Eunsol Choi", "Wen-tau Yih." ],
      "venue" : "arXiv preprint arXiv:1810.06683.",
      "citeRegEx" : "Huang et al\\.,? 2018",
      "shortCiteRegEx" : "Huang et al\\.",
      "year" : 2018
    }, {
      "title" : "Adam: A method for stochastic optimization",
      "author" : [ "Diederik P Kingma", "Jimmy Ba." ],
      "venue" : "arXiv preprint arXiv:1412.6980.",
      "citeRegEx" : "Kingma and Ba.,? 2014",
      "shortCiteRegEx" : "Kingma and Ba.",
      "year" : 2014
    }, {
      "title" : "OpenNMT: Open-source toolkit for neural machine translation",
      "author" : [ "Guillaume Klein", "Yoon Kim", "Yuntian Deng", "Jean Senellart", "Alexander M. Rush." ],
      "venue" : "Proc. ACL.",
      "citeRegEx" : "Klein et al\\.,? 2017",
      "shortCiteRegEx" : "Klein et al\\.",
      "year" : 2017
    }, {
      "title" : "A diversity-promoting objective function for neural conversation models",
      "author" : [ "Jiwei Li", "Michel Galley", "Chris Brockett", "Jianfeng Gao", "Bill Dolan." ],
      "venue" : "Proceedings of the 2016 Conference of the North American Chapter of the Association for Computational",
      "citeRegEx" : "Li et al\\.,? 2016",
      "shortCiteRegEx" : "Li et al\\.",
      "year" : 2016
    }, {
      "title" : "Knowledge diffusion for neural dialogue generation",
      "author" : [ "Shuman Liu", "Hongshen Chen", "Zhaochun Ren", "Yang Feng", "Qun Liu", "Dawei Yin." ],
      "venue" : "Proceedings of the 56th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long",
      "citeRegEx" : "Liu et al\\.,? 2018",
      "shortCiteRegEx" : "Liu et al\\.",
      "year" : 2018
    }, {
      "title" : "Knowledge-grounded response generation with deep attentional latent-variable model",
      "author" : [ "Hao-Tong Ye Kai-Ling Lo", "Shang-Yu Su Yun-Nung Chen." ],
      "venue" : "Thirty-Third AAAI Conference on Artificial Intelligence.",
      "citeRegEx" : "Lo and Chen.,? 2019",
      "shortCiteRegEx" : "Lo and Chen.",
      "year" : 2019
    }, {
      "title" : "Effective approaches to attention-based neural machine translation",
      "author" : [ "Thang Luong", "Hieu Pham", "Christopher D Manning." ],
      "venue" : "Proceedings of the 2015 Conference on Empirical Methods in Natural Language Processing, pages 1412–1421.",
      "citeRegEx" : "Luong et al\\.,? 2015",
      "shortCiteRegEx" : "Luong et al\\.",
      "year" : 2015
    }, {
      "title" : "Mem2seq: Effectively incorporating knowledge bases into end-to-end task-oriented dialog systems",
      "author" : [ "Andrea Madotto", "Chien-Sheng Wu", "Pascale Fung." ],
      "venue" : "Proceedings of the 56th Annual Meeting of the Association for Computational Linguistics (Vol-",
      "citeRegEx" : "Madotto et al\\.,? 2018",
      "shortCiteRegEx" : "Madotto et al\\.",
      "year" : 2018
    }, {
      "title" : "Bleu: a method for automatic evaluation of machine translation",
      "author" : [ "Kishore Papineni", "Salim Roukos", "Todd Ward", "Wei jing Zhu." ],
      "venue" : "pages 311–318.",
      "citeRegEx" : "Papineni et al\\.,? 2002",
      "shortCiteRegEx" : "Papineni et al\\.",
      "year" : 2002
    }, {
      "title" : "Extending neural generative conversational model using external knowledge sources",
      "author" : [ "Prasanna Parthasarathi", "Joelle Pineau." ],
      "venue" : "Proceedings of the 2018 Conference on Empirical Methods in Natural Language Processing, pages 690–695.",
      "citeRegEx" : "Parthasarathi and Pineau.,? 2018",
      "shortCiteRegEx" : "Parthasarathi and Pineau.",
      "year" : 2018
    }, {
      "title" : "Know what you dont know: Unanswerable questions for squad",
      "author" : [ "Pranav Rajpurkar", "Robin Jia", "Percy Liang." ],
      "venue" : "Proceedings of the 56th Annual Meeting of the Association for Computational Linguistics (Volume 2: Short Papers), volume 2, pages",
      "citeRegEx" : "Rajpurkar et al\\.,? 2018",
      "shortCiteRegEx" : "Rajpurkar et al\\.",
      "year" : 2018
    }, {
      "title" : "Coqa: A conversational question answering challenge",
      "author" : [ "Siva Reddy", "Danqi Chen", "Christopher D Manning." ],
      "venue" : "arXiv preprint arXiv:1808.07042.",
      "citeRegEx" : "Reddy et al\\.,? 2018",
      "shortCiteRegEx" : "Reddy et al\\.",
      "year" : 2018
    }, {
      "title" : "Building end-to-end dialogue systems using generative hierarchical neural network models",
      "author" : [ "Iulian V Serban", "Alessandro Sordoni", "Yoshua Bengio", "Aaron Courville", "Joelle Pineau." ],
      "venue" : "Thirtieth AAAI Conference on Artificial Intelligence.",
      "citeRegEx" : "Serban et al\\.,? 2016",
      "shortCiteRegEx" : "Serban et al\\.",
      "year" : 2016
    }, {
      "title" : "Neural responding machine for short-text conversation",
      "author" : [ "Lifeng Shang", "Zhengdong Lu", "Hang Li." ],
      "venue" : "Proceedings of the 53rd Annual Meeting of the Association for Computational Linguistics and the 7th International Joint Conference on Natural",
      "citeRegEx" : "Shang et al\\.,? 2015",
      "shortCiteRegEx" : "Shang et al\\.",
      "year" : 2015
    }, {
      "title" : "Sequence to sequence learning with neural networks",
      "author" : [ "Ilya Sutskever", "Oriol Vinyals", "Quoc V Le." ],
      "venue" : "Advances in neural information processing systems, pages 3104–3112.",
      "citeRegEx" : "Sutskever et al\\.,? 2014",
      "shortCiteRegEx" : "Sutskever et al\\.",
      "year" : 2014
    }, {
      "title" : "Attention is all you need",
      "author" : [ "Ashish Vaswani", "Noam Shazeer", "Niki Parmar", "Jakob Uszkoreit", "Llion Jones", "Aidan N Gomez", "Łukasz Kaiser", "Illia Polosukhin." ],
      "venue" : "Advances in Neural Information Processing Systems, pages 5998–6008.",
      "citeRegEx" : "Vaswani et al\\.,? 2017",
      "shortCiteRegEx" : "Vaswani et al\\.",
      "year" : 2017
    }, {
      "title" : "A neural conversational model",
      "author" : [ "Oriol Vinyals", "Quoc Le." ],
      "venue" : "arXiv preprint arXiv:1506.05869.",
      "citeRegEx" : "Vinyals and Le.,? 2015",
      "shortCiteRegEx" : "Vinyals and Le.",
      "year" : 2015
    }, {
      "title" : "Deliberation networks: Sequence generation beyond one-pass decoding",
      "author" : [ "Yingce Xia", "Fei Tian", "Lijun Wu", "Jianxin Lin", "Tao Qin", "Nenghai Yu", "Tie-Yan Liu." ],
      "venue" : "Advances in Neural Information Processing Systems, pages 1784–1794.",
      "citeRegEx" : "Xia et al\\.,? 2017",
      "shortCiteRegEx" : "Xia et al\\.",
      "year" : 2017
    }, {
      "title" : "Modeling coherence for discourse neural machine translation",
      "author" : [ "Hao Xiong", "Zhongjun He", "Hua Wu", "Haifeng Wang." ],
      "venue" : "arXiv preprint arXiv:1811.05683.",
      "citeRegEx" : "Xiong et al\\.,? 2018",
      "shortCiteRegEx" : "Xiong et al\\.",
      "year" : 2018
    }, {
      "title" : "Deepcopy: Grounded response generation with hierarchical pointer networks",
      "author" : [ "Semih Yavuz", "Abhinav Rastogi", "Guan-lin Chao", "Dilek Hakkani-Tür", "Amazon Alexa AI." ],
      "venue" : "Advances in Neural Information Processing Systems.",
      "citeRegEx" : "Yavuz et al\\.,? 2018",
      "shortCiteRegEx" : "Yavuz et al\\.",
      "year" : 2018
    }, {
      "title" : "Qanet: Combining local convolution with global self-attention for reading comprehension",
      "author" : [ "Adams Wei Yu", "David Dohan", "Minh-Thang Luong", "Rui Zhao", "Kai Chen", "Mohammad Norouzi", "Quoc V Le." ],
      "venue" : "arXiv preprint arXiv:1804.09541.",
      "citeRegEx" : "Yu et al\\.,? 2018",
      "shortCiteRegEx" : "Yu et al\\.",
      "year" : 2018
    }, {
      "title" : "Improving the transformer translation model with document-level context",
      "author" : [ "Jiacheng Zhang", "Huanbo Luan", "Maosong Sun", "Feifei Zhai", "Jingfang Xu", "Min Zhang", "Yang Liu." ],
      "venue" : "Proceedings of the 2018 Conference on Empirical Methods in Natural Lan-",
      "citeRegEx" : "Zhang et al\\.,? 2018",
      "shortCiteRegEx" : "Zhang et al\\.",
      "year" : 2018
    }, {
      "title" : "A dataset for document grounded conversations",
      "author" : [ "Kangyan Zhou", "Shrimai Prabhumoye", "Alan W Black." ],
      "venue" : "Proceedings of the 2018 Conference on Empirical Methods in Natural Language Processing, pages 708–713.",
      "citeRegEx" : "Zhou et al\\.,? 2018",
      "shortCiteRegEx" : "Zhou et al\\.",
      "year" : 2018
    } ],
    "referenceMentions" : [ {
      "referenceID" : 19,
      "context" : "Based on the sequenceto-sequence framework (Sutskever et al., 2014), most models are trained in an end-to-end manner with large corpora of human-to-human dialogues and have obtained impressive success (Shang et al.",
      "startOffset" : 43,
      "endOffset" : 67
    }, {
      "referenceID" : 18,
      "context" : ", 2014), most models are trained in an end-to-end manner with large corpora of human-to-human dialogues and have obtained impressive success (Shang et al., 2015; Vinyals and Le, 2015; Li et al., 2016; Serban et al., 2016).",
      "startOffset" : 141,
      "endOffset" : 221
    }, {
      "referenceID" : 21,
      "context" : ", 2014), most models are trained in an end-to-end manner with large corpora of human-to-human dialogues and have obtained impressive success (Shang et al., 2015; Vinyals and Le, 2015; Li et al., 2016; Serban et al., 2016).",
      "startOffset" : 141,
      "endOffset" : 221
    }, {
      "referenceID" : 8,
      "context" : ", 2014), most models are trained in an end-to-end manner with large corpora of human-to-human dialogues and have obtained impressive success (Shang et al., 2015; Vinyals and Le, 2015; Li et al., 2016; Serban et al., 2016).",
      "startOffset" : 141,
      "endOffset" : 221
    }, {
      "referenceID" : 17,
      "context" : ", 2014), most models are trained in an end-to-end manner with large corpora of human-to-human dialogues and have obtained impressive success (Shang et al., 2015; Vinyals and Le, 2015; Li et al., 2016; Serban et al., 2016).",
      "startOffset" : 141,
      "endOffset" : 221
    }, {
      "referenceID" : 12,
      "context" : "The Mem2Seq (Madotto et al., 2018) incorporates structured knowledge into the end-to-end task-oriented dialogue.",
      "startOffset" : 12,
      "endOffset" : 34
    }, {
      "referenceID" : 0,
      "context" : "Recently, intensive research has been applied on using documents as knowledge sources for QuestionAnswering (Chen et al., 2017; Huang et al., 2018; Yu et al., 2018; Rajpurkar et al., 2018; Reddy et al., 2018).",
      "startOffset" : 108,
      "endOffset" : 208
    }, {
      "referenceID" : 5,
      "context" : "Recently, intensive research has been applied on using documents as knowledge sources for QuestionAnswering (Chen et al., 2017; Huang et al., 2018; Yu et al., 2018; Rajpurkar et al., 2018; Reddy et al., 2018).",
      "startOffset" : 108,
      "endOffset" : 208
    }, {
      "referenceID" : 25,
      "context" : "Recently, intensive research has been applied on using documents as knowledge sources for QuestionAnswering (Chen et al., 2017; Huang et al., 2018; Yu et al., 2018; Rajpurkar et al., 2018; Reddy et al., 2018).",
      "startOffset" : 108,
      "endOffset" : 208
    }, {
      "referenceID" : 15,
      "context" : "Recently, intensive research has been applied on using documents as knowledge sources for QuestionAnswering (Chen et al., 2017; Huang et al., 2018; Yu et al., 2018; Rajpurkar et al., 2018; Reddy et al., 2018).",
      "startOffset" : 108,
      "endOffset" : 208
    }, {
      "referenceID" : 16,
      "context" : "Recently, intensive research has been applied on using documents as knowledge sources for QuestionAnswering (Chen et al., 2017; Huang et al., 2018; Yu et al., 2018; Rajpurkar et al., 2018; Reddy et al., 2018).",
      "startOffset" : 108,
      "endOffset" : 208
    }, {
      "referenceID" : 20,
      "context" : "In this paper, we propose a novel and effective Transformer-based (Vaswani et al., 2017) architecture for Document Grounded Conversations, named Incremental Transformer with Deliberation Decoder.",
      "startOffset" : 66,
      "endOffset" : 88
    }, {
      "referenceID" : 22,
      "context" : "The decoder is a two-pass decoder similar to the Deliberation Network in Neural Machine Translation (Xia et al., 2017), which is designed to improve the context coherence and knowledge correctness of the responses.",
      "startOffset" : 100,
      "endOffset" : 118
    }, {
      "referenceID" : 27,
      "context" : "We test the effectiveness of our proposed model on Document Grounded Conversations Dataset (Zhou et al., 2018).",
      "startOffset" : 91,
      "endOffset" : 110
    }, {
      "referenceID" : 20,
      "context" : "1) Self-Attentive Encoder (SA) (in orange) is a transformer encoder as described in (Vaswani et al., 2017), which encodes the document knowledge and the current utterance independently.",
      "startOffset" : 84,
      "endOffset" : 106
    }, {
      "referenceID" : 20,
      "context" : "We use multi-head self-attention (Vaswani et al., 2017) to compute the representation of document knowledge.",
      "startOffset" : 33,
      "endOffset" : 55
    }, {
      "referenceID" : 20,
      "context" : "The input (In s ) of the encoder is a sequence of document words embedding with positional encoding added.(Vaswani et al., 2017):",
      "startOffset" : 106,
      "endOffset" : 128
    }, {
      "referenceID" : 20,
      "context" : "The first sub-layer is a multi-head selfattention (MultiHead) (Vaswani et al., 2017).",
      "startOffset" : 62,
      "endOffset" : 84
    }, {
      "referenceID" : 20,
      "context" : "When generating the i-th response word u i , we have the generated words u <i as input (Vaswani et al., 2017).",
      "startOffset" : 87,
      "endOffset" : 109
    }, {
      "referenceID" : 22,
      "context" : "In contrast to the original Deliberation Network (Xia et al., 2017), where they propose a complex joint learning framework using Monte Carlo Method, we minimize the following loss as Xiong et al.",
      "startOffset" : 49,
      "endOffset" : 67
    }, {
      "referenceID" : 27,
      "context" : "We evaluate our model using the Document Grounded Conversations Dataset (Zhou et al., 2018).",
      "startOffset" : 72,
      "endOffset" : 91
    }, {
      "referenceID" : 18,
      "context" : "We compare our proposed model with the following state-of-the-art baselines: Models not using document knowledge: Seq2Seq: A simple encoder-decoder model (Shang et al., 2015; Vinyals and Le, 2015) with global attention (Luong et al.",
      "startOffset" : 154,
      "endOffset" : 196
    }, {
      "referenceID" : 21,
      "context" : "We compare our proposed model with the following state-of-the-art baselines: Models not using document knowledge: Seq2Seq: A simple encoder-decoder model (Shang et al., 2015; Vinyals and Le, 2015) with global attention (Luong et al.",
      "startOffset" : 154,
      "endOffset" : 196
    }, {
      "referenceID" : 11,
      "context" : ", 2015; Vinyals and Le, 2015) with global attention (Luong et al., 2015).",
      "startOffset" : 52,
      "endOffset" : 72
    }, {
      "referenceID" : 17,
      "context" : "HRED: A hierarchical encoder-decoder model (Serban et al., 2016), which is composed of a word-level LSTM for each sentence and a sentence-level LSTM connecting utterances.",
      "startOffset" : 43,
      "endOffset" : 64
    }, {
      "referenceID" : 20,
      "context" : "Transformer: The state-of-the-art NMT model based on multi-head attention (Vaswani et al., 2017).",
      "startOffset" : 74,
      "endOffset" : 96
    }, {
      "referenceID" : 1,
      "context" : "Wizard Transformer: A Transformer-based model for multi-turn open-domain dialogue with unstructured text facts (Dinan et al., 2018).",
      "startOffset" : 111,
      "endOffset" : 131
    }, {
      "referenceID" : 7,
      "context" : "We use OpenNMT-py1 (Klein et al., 2017) as the code framework2.",
      "startOffset" : 19,
      "endOffset" : 39
    }, {
      "referenceID" : 13,
      "context" : "Automatic Evaluation: We adopt perplexity (PPL) and BLEU (Papineni et al., 2002) to automatically evaluate the response generation performance.",
      "startOffset" : 57,
      "endOffset" : 80
    }, {
      "referenceID" : 1,
      "context" : "Models are evaluated using perplexity of the gold response as described in (Dinan et al., 2018).",
      "startOffset" : 75,
      "endOffset" : 95
    }, {
      "referenceID" : 9,
      "context" : "We defined three metrics - fluency, knowledge relevance (Liu et al., 2018) and context coherence for manual evaluation.",
      "startOffset" : 56,
      "endOffset" : 74
    } ],
    "year" : 2019,
    "abstractText" : "Document Grounded Conversations is a task to generate dialogue responses when chatting about the content of a given document. Obviously, document knowledge plays a critical role in Document Grounded Conversations, while existing dialogue models do not exploit this kind of knowledge effectively enough. In this paper, we propose a novel Transformerbased architecture for multi-turn document grounded conversations. In particular, we devise an Incremental Transformer to encode multi-turn utterances along with knowledge in related documents. Motivated by the human cognitive process, we design a two-pass decoder (Deliberation Decoder) to improve context coherence and knowledge correctness. Our empirical study on a real-world Document Grounded Dataset proves that responses generated by our model significantly outperform competitive baselines on both context coherence and knowledge relevance.",
    "creator" : "LaTeX with hyperref package"
  }
}