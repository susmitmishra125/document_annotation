{
  "name" : "2021.acl-long.201.pdf",
  "metadata" : {
    "source" : "META",
    "title" : "LayoutLMv2: Multi-modal Pre-training for Visually-rich Document Understanding",
    "authors" : [ "Yang Xu", "Yiheng Xu", "Tengchao Lv", "Lei Cui", "Furu Wei", "Guoxin Wang", "Yijuan Lu", "Dinei Florencio", "Cha Zhang", "Wanxiang Che", "Min Zhang", "Lidong Zhou" ],
    "emails" : [ "yxu@ir.hit.edu.cn,", "car@ir.hit.edu.cn,", "v-yixu@microsoft.com,", "v-telv@microsoft.com,", "lecu@microsoft.com,", "fuwei@microsoft.com,", "lidongz@microsoft.com,", "guow@microsoft.com", "yijlu@microsoft.com", "dinei@microsoft.com", "chazhang@microsoft.com", "minzhang@suda.edu.cn" ],
    "sections" : [ {
      "heading" : null,
      "text" : "Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing, pages 2579–2591\nAugust 1–6, 2021. ©2021 Association for Computational Linguistics\n2579"
    }, {
      "heading" : "1 Introduction",
      "text" : "Visually-rich Document Understanding (VrDU) aims to analyze scanned/digital-born business documents (images of invoices, forms in PDF format, etc.) where structured information can be automatically extracted and organized for many business\n∗Equal contributions during internship at MSRA\napplications. Distinct from conventional information extraction tasks, the VrDU task relies on not only textual information but also visual and layout information that is vital for visually-rich documents. Different types of documents indicate that the text fields of interest located at different positions within the document, which is often determined by the style and format of each type as well as the document content. Therefore, to accurately recognize the text fields of interest, it is inevitable to take advantage of the cross-modality nature of visually-rich documents, where the textual, visual, and layout information should be jointly modeled and learned end-to-end in a single framework.\nThe recent progress of VrDU lies primarily in two directions. The first direction is usually built on the shallow fusion between textual and visual/layout/style information (Yang et al., 2017; Liu et al., 2019; Sarkhel and Nandi, 2019; Yu et al., 2020; Majumder et al., 2020; Wei et al., 2020; Zhang et al., 2020). These approaches leverage the pre-trained NLP and CV models individually and combine the information from multiple modalities for supervised learning. Although good performance has been achieved, the domain knowledge of one document type cannot be easily transferred into another, so that these models often need to be re-trained once the document type is changed. Thereby the local invariance in general document layout (key-value pairs in a left-right layout, tables in a grid layout, etc.) cannot be fully exploited. To this end, the second direction relies on the deep fusion among textual, visual, and layout information from a great number of unlabeled documents in different domains, where pre-training techniques play an important role in learning the cross-modality interaction in an end-to-end fashion (Lockard et al., 2020; Xu et al., 2020). In this way, the pre-trained\nmodels absorb cross-modal knowledge from different document types, where the local invariance among these layouts and styles is preserved. Furthermore, when the model needs to be transferred into another domain with different document formats, only a few labeled samples would be sufficient to fine-tune the generic model in order to achieve state-of-the-art accuracy. Therefore, the proposed model in this paper follows the second direction, and we explore how to further improve the pre-training strategies for the VrDU tasks.\nIn this paper, we present an improved version of LayoutLM (Xu et al., 2020), aka LayoutLMv2. Different from the vanilla LayoutLM model where visual embeddings are combined in the fine-tuning stage, we integrate the visual information in the pre-training stage in LayoutLMv2 by taking advantage of the Transformer architecture to learn the cross-modality interaction between visual and textual information. In addition, inspired by the 1-D relative position representations (Shaw et al., 2018; Raffel et al., 2020; Bao et al., 2020), we propose the spatial-aware self-attention mechanism for LayoutLMv2, which involves a 2-D relative position representation for token pairs. Different from the absolute 2-D position embeddings that LayoutLM uses to model the page layout, the relative position embeddings explicitly provide a broader view for the contextual spatial modeling. For the pre-training strategies, we use two new training objectives for LayoutLMv2 in addition to the masked visual-language modeling. The first is the proposed text-image alignment strategy, which aligns the text lines and the corresponding image regions. The second is the text-image matching strategy popular in previous vision-language pre-training models (Tan and Bansal, 2019; Lu et al., 2019; Su et al., 2020; Chen et al., 2020; Sun et al., 2019), where the model learns whether the document image and textual content are correlated.\nWe select six publicly available benchmark datasets as the downstream tasks to evaluate the performance of the pre-trained LayoutLMv2 model, which are the FUNSD dataset (Jaume et al., 2019) for form understanding, the CORD dataset (Park et al., 2019) and the SROIE dataset (Huang et al., 2019) for receipt understanding, the Kleister-NDA dataset (Graliński et al., 2020) for long document understanding with a complex layout, the RVL-CDIP dataset (Harley et al., 2015) for document image classification, and the DocVQA\ndataset (Mathew et al., 2021) for visual question answering on document images. Experiment results show that the LayoutLMv2 model significantly outperforms strong baselines, including the vanilla LayoutLM, and achieves new state-of-the-art results in all of these tasks.\nThe contributions of this paper are summarized as follows:\n• We propose a multi-modal Transformer model to integrate the document text, layout, and visual information in the pre-training stage, which learns the cross-modal interaction endto-end in a single framework. Meanwhile, a spatial-aware self-attention mechanism is integrated into the Transformer architecture.\n• In addition to the masked visual-language model, we add text-image alignment and textimage matching as the new pre-training strategies to enforce the alignment among different modalities.\n• LayoutLMv2 significantly outperforms and achieves new SOTA results not only on the conventional VrDU tasks but also on the VQA task for document images, which demonstrates the great potential for the multi-modal pre-training for VrDU."
    }, {
      "heading" : "2 Approach",
      "text" : "In this section, we will introduce the model architecture and the multi-modal pre-training tasks of LayoutLMv2, which is illustrated in Figure 1."
    }, {
      "heading" : "2.1 Model Architecture",
      "text" : "We build a multi-modal Transformer architecture as the backbone of LayoutLMv2, which takes text, visual, and layout information as input to establish deep cross-modal interactions. We also introduce a spatial-aware self-attention mechanism to the model architecture for better modeling the document layout. Detailed descriptions of the model are as follows.\nText Embedding Following the common practice, we use WordPiece (Wu et al., 2016) to tokenize the OCR text sequence and assign each token to a certain segment si ∈ {[A],[B]}. Then, we add [CLS] at the beginning of the sequence and [SEP] at the end of each text segment. Extra [PAD] tokens are appended to the end so that the\nfinal sequence’s length is exactly the maximum sequence length L. The final text embedding is the sum of three embeddings. Token embedding represents the token itself, 1D positional embedding represents the token index, and segment embedding is used to distinguish different text segments. Formally, we have the i-th (0 ≤ i < L) text embedding\nti = TokEmb(wi)+PosEmb1D(i)+SegEmb(si)\nVisual Embedding Although all information we need is contained in the page image, the model has difficulty capturing detailed features in a single information-rich representation of the entire page. Therefore, we leverage the output feature map of a CNN-based visual encoder, which converts the page image to a fixed-length sequence. We use ResNeXt-FPN (Xie et al., 2017; Lin et al., 2017) architecture as the backbone of the visual encoder, whose parameters can be updated through backpropagation.\nGiven a document page image I , it is resized to 224× 224 then fed into the visual backbone. After that, the output feature map is average-pooled to a\nfixed size with the width being W and height being H . Next, it is flattened into a visual embedding sequence of lengthW×H . The sequence is named VisTokEmb(I). A linear projection layer is then applied to each visual token embedding to unify the dimensionality with the text embeddings. Since the CNN-based visual backbone cannot capture the positional information, we also add a 1D positional embedding to these visual token embeddings. The 1D positional embedding is shared with the text embedding layer. For the segment embedding, we attach all visual tokens to the visual segment [C]. The i-th (0 ≤ i < WH) visual embedding can be represented as\nvi =Proj ( VisTokEmb(I)i ) +PosEmb1D(i)+SegEmb([C])\nLayout Embedding The layout embedding layer is for embedding the spatial layout information represented by axis-aligned token bounding boxes from the OCR results, in which box width and height together with corner coordinates are identified. Following the vanilla LayoutLM, we normalize and discretize all coordinates to integers in\nthe range [0, 1000], and use two embedding layers to embed x-axis features and y-axis features separately. Given the normalized bounding box of the i-th (0 ≤ i < WH + L) text/visual token boxi = (xmin, xmax, ymin, ymax, width, height), the layout embedding layer concatenates six bounding box features to construct a token-level 2D positional embedding, aka the layout embedding\nli = Concat ( PosEmb2Dx(xmin, xmax, width),\nPosEmb2Dy(ymin, ymax, height) )\nNote that CNNs perform local transformation, thus the visual token embeddings can be mapped back to image regions one by one with neither overlap nor omission. When calculating bounding boxes, the visual tokens can be treated as evenly divided grids. An empty bounding box boxPAD = (0, 0, 0, 0, 0, 0) is attached to special tokens [CLS], [SEP] and [PAD].\nMulti-modal Encoder with Spatial-Aware SelfAttention Mechanism The encoder concatenates visual embeddings {v0, ...,vWH−1} and text embeddings {t0, ..., tL−1} to a unified sequence and fuses spatial information by adding the layout embeddings to get the i-th (0 ≤ i < WH + L) first layer input\nx (0) i = Xi + li, where\nX = {v0, ...,vWH−1, t0, ..., tL−1}\nFollowing the architecture of Transformer, we build our multi-modal encoder with a stack of multi-head self-attention layers followed by a feedforward network. However, the original selfattention mechanism can only implicitly capture the relationship between the input tokens with the absolute position hints. In order to efficiently model local invariance in the document layout, it is necessary to insert relative position information explicitly. Therefore, we introduce the spatial-aware self-attention mechanism into the self-attention layers. For simplicity, the following description is for a single head in a single self-attention layer with hidden size of dhead and projection matrics WQ, WK , WV . The original self-attention mechanism captures the correlation between query xi and key xj by projecting the two vectors and calculating the attention score\nαij = 1√ dhead\n( xiW Q ) ( xjW K )T\nConsidering the large range of positions, we model the semantic relative position and spatial relative position as bias terms to prevent adding too many parameters. Similar practice has been shown effective on text-only Transformer architectures (Raffel et al., 2020; Bao et al., 2020). Let b(1D), b(2Dx) and b(2Dy) denote the learnable 1D and 2D relative position biases respectively. The biases are different among attention heads but shared in all encoder layers. Assuming (xi, yi) anchors the top left corner coordinates of the i-th bounding box, we obtain the spatial-aware attention score\nα′ij = αij + b (1D) j−i + b (2Dx) xj−xi + b (2Dy) yj−yi\nFinally, the output vectors are represented as the weighted average of all the projected value vectors with respect to normalized spatial-aware attention scores\nhi = ∑ j\nexp ( α′ij ) ∑\nk exp ( α′ik )xjWV"
    }, {
      "heading" : "2.2 Pre-training Tasks",
      "text" : "Masked Visual-Language Modeling Similar to the vanilla LayoutLM, we use the Masked VisualLanguage Modeling (MVLM) to make the model learn better in the language side with the crossmodality clues. We randomly mask some text tokens and ask the model to recover the masked tokens. Meanwhile, the layout information remains unchanged, which means the model knows each masked token’s location on the page. The output representations of masked tokens from the encoder are fed into a classifier over the whole vocabulary, driven by a cross-entropy loss. To avoid visual clue leakage, we mask image regions corresponding to masked tokens on the raw page image input before feeding it into the visual encoder.\nText-Image Alignment To help the model learn the spatial location correspondence between image and coordinates of bounding boxes, we propose the Text-Image Alignment (TIA) as a fine-grained cross-modality alignment task. In the TIA task, some tokens lines are randomly selected, and their image regions are covered on the document image. We call this operation covering to avoid confusion with the masking operation in MVLM. During pretraining, a classification layer is built above the encoder outputs. This layer predicts a label for each text token depending on whether it is covered,\ni.e., [Covered] or [Not Covered], and computes the binary cross-entropy loss. Considering the input image’s resolution is limited, and some document elements like signs and bars in a figure may look like covered text regions, the task of finding a word-sized covered image region can be noisy. Thus, the covering operation is performed at the line-level. When MVLM and TIA are performed simultaneously, TIA losses of the tokens masked in MVLM are not taken into account. This prevents the model from learning the useless but straightforward correspondence from [MASK] to [Covered].\nText-Image Matching Furthermore, a coarsegrained cross-modality alignment task, Text-Image Matching (TIM) is applied to help the model learn the correspondence between document image and textual content. We feed the output representation at [CLS] into a classifier to predict whether the image and text are from the same document page. Regular inputs are positive samples. To construct a negative sample, an image is either replaced by a page image from another document or dropped. To prevent the model from cheating by finding task features, we perform the same masking and covering operations to images in negative samples. The TIA target labels are all set to [Covered] in negative samples. We apply the binary cross-entropy loss in the optimization process."
    }, {
      "heading" : "3 Experiments",
      "text" : ""
    }, {
      "heading" : "3.1 Data",
      "text" : "In order to pre-train and evaluate LayoutLMv2 models, we select datasets in a wide range from the visually-rich document understanding area. Following LayoutLM, we use IIT-CDIP Test Collection (Lewis et al., 2006) as the pre-training dataset. Six datasets are used as down-stream tasks. The FUNSD (Jaume et al., 2019), CORD (Park et al., 2019), SROIE (Huang et al., 2019) and KleisterNDA (Graliński et al., 2020) datasets define entity extraction tasks that aim to extract the value of a set of pre-defined keys, which we formalize as a sequential labeling task. RVL-CDIP (Harley et al., 2015) is for document image classification. DocVQA (Mathew et al., 2021), as the name suggests, is a dataset for visual question answering on document images. Statistics of datasets are shown in Table 1. Refer to the Appendix for details."
    }, {
      "heading" : "3.2 Settings",
      "text" : "Following the typical pre-training and fine-tuning strategy, we update all parameters including the visual encoder layers, and train whole models endto-end for all the settings. Training details can be found in the Appendix.\nPre-training LayoutLMv2 We train LayoutLMv2 models with two different parameter sizes. We use a 12-layer 12-head Transformer encoder and set hidden size d = 768 in LayoutLMv2BASE. While in the LayoutLMv2LARGE, the encoder has 24 Transformer layers with 16 heads and d = 1024. Visual backbones in the two models are based on the same ResNeXt101-FPN architecture. The numbers of parameters are 200M and 426M approximately for LayoutLMv2BASE and LayoutLMv2LARGE, respectively.\nFor the encoder along with the text embedding layer, LayoutLMv2 uses the same architecture as UniLMv2 (Bao et al., 2020), thus it is initialized from UniLMv2. For the ResNeXt-FPN part in the visual embedding layer, the backbone of a MaskRCNN (He et al., 2017) model trained on PubLayNet (Zhong et al., 2019) is leveraged.1 The rest of the parameters in the model are randomly initialized.\nDuring pre-training, we sample pages from the IIT-CDIP dataset and select a random sliding window of the text sequence if the sample is too long. We set the maximum sequence length L = 512 and assign all text tokens to the segment [A]. The output shape of the average pooling layer is set to W = H = 7, so that it transforms the feature map into 49 visual tokens. In MVLM, 15% text tokens are masked among which 80% are replaced by a special token [MASK], 10% are replaced by a random token sampled from the whole vocabulary, and\n1“MaskRCNN ResNeXt101 32x8d FPN 3X” setting in https://github.com/hpanwar08/detectron2\n10% remains the same. In TIA, 15% of the lines are covered. In TIM, 15% images are replaced, and 5% are dropped.\nFine-tuning LayoutLMv2 We use the [CLS] output along with pooled visual token representations as global features in the document-level classification task RVL-CDIP. For the extractive question answering task DocVQA and the other four entity extraction tasks, we follow common practice like (Devlin et al., 2019) and build task specified head layers over the text part of LayoutLMv2 outputs.\nIn the DocVQA paper, experiment results show that the BERT model fine-tuned on the SQuAD dataset (Rajpurkar et al., 2016) outperforms the original BERT model. Inspired by this fact, we add an extra setting, which is that we first fine-tune LayoutLMv2 on a question generation (QG) dataset followed by the DocVQA dataset. The QG dataset contains almost one million question-answer pairs generated by a generation model trained on the SQuAD dataset.\nBaselines We select three baseline models in the experiments to compare LayoutLMv2 with the text-only pre-trained models as well as the vanilla LayoutLM model. Specifically, we compare LayoutLMv2 with BERT (Devlin et al., 2019), UniLMv2 (Bao et al., 2020), and LayoutLM (Xu et al., 2020) for all the experiment settings. We use the publicly available PyTorch models for BERT (Wolf et al., 2020) and LayoutLM, and use our in-house implementation for the UniLMv2 models. For each baseline approach, experiments are conducted using both the BASE and LARGE\nparameter settings."
    }, {
      "heading" : "3.3 Results",
      "text" : "Entity Extraction Tasks Table 2 shows the model accuracy on the four datasets FUNSD, CORD, SROIE, and Kleister-NDA, which we regard as sequential labeling tasks evaluated using entity-level F1 score. We report the evaluation results of Kleister-NDA on the validation set because the ground-truth labels and the submission website for the test set are not available right now. For text-only models, the UniLMv2 models outperform the BERT models by a large margin in terms of the BASE and LARGE settings. For text+layout models, the LayoutLM family, especially the LayoutLMv2 models, brings significant performance improvement over the text-only baselines. Compared to the baselines, the LayoutLMv2 models are superior to the SPADE (Hwang et al., 2020) decoder method, as well as the text+layout pre-training approach BROS (Hong et al., 2021) that is built on the SPADE decoder, which demonstrates the effectiveness of our modeling approach. Moreover, with the same modal information, our LayoutLMv2 models also outperform existing multi-modal approaches PICK (Yu et al., 2020), TRIE (Zhang et al., 2020) and the previous top1 method on the leaderboard,2 confirming the effectiveness of our pre-training for text, layout, and visual information. The best performance on all the four datasets is achieved by\n2Unpublished results, the leaderboard is available at https://rrc.cvc.uab.es/?ch=13&com=eval uation&task=3\nthe LayoutLMv2LARGE, which illustrates that the multi-modal pre-training in LayoutLMv2 learns better from the interactions from different modalities, thereby leading to the new SOTA on various document understanding tasks.\nRVL-CDIP Table 3 shows the classification accuracy on the RVL-CDIP dataset, including textonly pre-trained models, the LayoutLM family as well as several image-based baseline models. As shown in the table, both the text and visual information are important to the document image classification task because document images are text-intensive and represented by a variety of layouts and formats. Therefore, we observed that the LayoutLM family outperforms those text-only or image-only models as it leverages the multi-modal information within the documents. Specifically, the LayoutLMv2LARGE model significantly improves the classification accuracy by more than 1.2% point over the previous SOTA results, which achieves an accuracy of 95.64%. This also verifies that the pre-trained LayoutLMv2 model benefits not only the information extraction tasks in document understanding but also the document image classification task through effective multi-model training.\nDocVQA Table 4 lists the Average Normalized Levenshtein Similarity (ANLS) scores on the DocVQA dataset of text-only baselines, LayoutLM family models, and the previous top-1 on the leaderboard. With multi-modal pre-training, LayoutLMv2 models outperform LayoutLM models and text-only baselines by a large margin when fine-\ntuned on the train set. By using all data (train + dev) as the fine-tuning dataset, the LayoutLMv2LARGE single model outperforms the previous top-1 on the leaderboard which ensembles 30 models.3 Under the setting of fine-tuning LayoutLMv2LARGE on a question generation dataset (QG) and the DocVQA dataset successively, the single model performance increases by more than 1.6% ANLS and achieves the new SOTA."
    }, {
      "heading" : "3.4 Ablation Studies",
      "text" : "To fully understand the underlying impact of different components, we conduct an ablation study to explore the effect of visual information, the pretraining tasks, spatial-aware self-attention mechanism, as well as different text-side initialization models. Table 5 shows model performance on the DocVQA validation set. Under all the settings, we pre-train the models using all IIT-CDIP data for one epoch. The hyper-parameters are the same as those used to pre-train LayoutLMv2BASE in Section 3.2. “LayoutLM” denotes the vanilla LayoutLM architecture in (Xu et al., 2020), which can be regarded as a LayoutLMv2 architecture without visual module and spatial-aware self-attention mechanism. “X101-FPN” denotes the ResNeXt101-FPN visual backbone described in Section 3.2.\nWe first evaluate the effect of introducing visual information. From #1 to #2a, we add the visual module without changing the pre-training strategy, where results show that LayoutLMv2 pre-\n3Unpublished results, the leaderboard is available at https://rrc.cvc.uab.es/?ch=17&com=eval uation&task=1\ntrained with only MVLM can leverage visual information effectively. Then, we compare the two cross-modality alignment pre-training tasks TIA and TIM. According to the four results in #2, both tasks improve the model performance substantially, and the proposed TIA benefits the model more than the commonly used TIM. Using both tasks together is more effective than using either one alone. According to this observation, we keep all the three pre-training tasks and introduce the spatial-aware self-attention mechanism (SASAM) to the model architecture. Compare the results #2d and #3, the proposed SASAM can further improve the model accuracy. Finally, in settings #3 and #4, we change the text-side initialization checkpoint from BERT to UniLMv2, and confirm that LayoutLMv2 benefits from the better initialization."
    }, {
      "heading" : "4 Related Work",
      "text" : "In recent years, pre-training techniques have become popular in both NLP and CV areas, and have also been leveraged in the VrDU tasks.\nDevlin et al. (2019) introduced a new language representation model called BERT, which is designed to pre-train deep bidirectional representations from the unlabeled text by jointly conditioning on both left and right context in all layers. Bao et al. (2020) propose to pre-train a unified language model for both autoencoding and partially autoregressive language modeling tasks using a novel training procedure, referred to as a pseudo-masked language model. Our multi-modal Transformer architecture and the MVLM pre-training strategy extend Transformer and MLM used in these work to leverage visual information.\nLu et al. (2019) proposed ViLBERT for learning task-agnostic joint representations of image content and natural language by extending the popular\nBERT architecture to a multi-modal two-stream model. Su et al. (2020) proposed VL-BERT that adopts the Transformer model as the backbone, and extends it to take both visual and linguistic embedded features as input. Different from these vision-language pre-training approaches, the visual part of LayoutLMv2 directly uses the feature map instead of pooled ROI features, and benefits from the new TIA pre-training task.\nXu et al. (2020) proposed LayoutLM to jointly model interactions between text and layout information across scanned document images, benefiting a great number of real-world document image understanding tasks such as information extraction from scanned documents. This work is a natural extension of the vanilla LayoutLM, which takes advantage of textual, layout, and visual information in a single multi-modal pre-training framework."
    }, {
      "heading" : "5 Conclusion",
      "text" : "In this paper, we present a multi-modal pre-training approach for visually-rich document understanding tasks, aka LayoutLMv2. Distinct from existing methods for VrDU, the LayoutLMv2 model not only considers the text and layout information but also integrates the image information in the pretraining stage with a single multi-modal framework. Meanwhile, the spatial-aware self-attention mechanism is integrated into the Transformer architecture to capture the relative relationship among different bounding boxes. Furthermore, new pre-training objectives are also leveraged to enforce the learning of cross-modal interaction among different modalities. Experiment results on 6 different VrDU tasks have illustrated that the pre-trained LayoutLMv2 model has substantially outperformed the SOTA baselines in the document intelligence area, which greatly benefits a number of real-world document\nunderstanding tasks. For future research, we will further explore the network architecture as well as the pre-training strategies for the LayoutLM family. Meanwhile, we will also investigate the language expansion to make the multi-lingual LayoutLMv2 model available for different languages, especially the nonEnglish areas around the world."
    }, {
      "heading" : "Acknowledgments",
      "text" : "This work was supported by the National Key R&D Program of China via grant 2020AAA0106501 and the National Natural Science Foundation of China (NSFC) via grant 61976072 and 61772153."
    }, {
      "heading" : "A Details of Datasets",
      "text" : "Introduction to the dataset and task definitions along with the description of required data processing are presented as follows.\nPre-training Dataset Following LayoutLM, we pre-train LayoutLMv2 on the IIT-CDIP Test Collection (Lewis et al., 2006), which contains over 11 million scanned document pages. We extract\ntext and corresponding word-level bounding boxes from document page images with the Microsoft Read API.4\nFUNSD FUNSD (Jaume et al., 2019) is a dataset for form understanding in noisy scanned documents. It contains 199 real, fully annotated, scanned forms where 9,707 semantic entities are annotated above 31,485 words. The 199 samples are split into 149 for training and 50 for testing. The official OCR annotation is directly used with the layout information. The FUNSD dataset is suitable for a variety of tasks, where we focus on semantic entity labeling in this paper. Specifically, the task is assigning to each word a semantic entity label from a set of four predefined categories: question, answer, header, or other. The entity-level F1 score is used as the evaluation metric.\nCORD We also evaluate our model on the receipt key information extraction dataset, i.e. the public available subset of CORD (Park et al., 2019). The dataset includes 800 receipts for the training set, 100 for the validation set, and 100 for the test set. A photo and a list of OCR annotations are equipped for each receipt. An ROI that encompasses the area of receipt region is provided along with each photo because there can be irrelevant things in the background. We only use the ROI as input instead of the raw photo. The dataset defines 30 fields under 4 categories and the task aims to label each word to the right field. The evaluation metric is entity-level F1. We use the official OCR annotations.\nSROIE The SROIE dataset (Task 3) (Huang et al., 2019) aims to extract information from scanned receipts. There are 626 samples for training and 347 samples for testing in the dataset. The task is to extract values from each receipt of up to four predefined keys: company, date, address, or total. The evaluation metric is entity-level F1. We use the official OCR annotations and results on the test set are provided by the official evaluation site.\nKleister-NDA Kleister-NDA (Graliński et al., 2020) contains non-disclosure agreements collected from the EDGAR database, including 254 documents for training, 83 documents for validation, and 203 documents for testing. This task is defined to extract the values of four fixed keys. We get the entity-level F1 score from the official\n4https://docs.microsoft.com/en-us/azu re/cognitive-services/computer-vision/co ncept-recognizing-text\nevaluation tools.5 Words and bounding boxes are extracted from the raw PDF file. We use heuristics to locate entity spans because the normalized standard answers may not appear in the utterance. As the labeled answers are normalized into a canonical form, we apply post-processing heuristics to convert the extracted date information into the “YYYYMM-DD” format, and company names into the abbreviations such as “LLC” and “Inc.”.\nRVL-CDIP RVL-CDIP (Harley et al., 2015) consists of 400,000 grayscale images, with 8:1:1 for the training set, validation set, and test set. A multiclass single-label classification task is defined on RVL-CDIP. The images are categorized into 16 classes, with 25,000 images per class. The evaluation metric is the overall classification accuracy. Text and layout information is extracted by Microsoft OCR.\nDocVQA As a VQA dataset on the document understanding field, DocVQA (Mathew et al., 2021) consists of 50,000 questions defined on over 12,000 pages from a variety of documents. Pages are split into the training set, validation set, and test set with a ratio of about 8:1:1. The dataset is organized as a set of triples 〈page image, questions, answers〉. Thus, we use Microsoft Read API to extract text and bounding boxes from images. Heuristics are used to find given answers in the extracted text. The task is evaluated using an edit distance based metric ANLS (aka average normalized Levenshtein similarity). Given that human performance is about 98% ANLS on the test set, it is reasonable to assume that the found ground truth which reaches over 97% ANLS on training and validation sets is good enough to train a model. Results on the test set are provided by the official evaluation site."
    }, {
      "heading" : "B Model Training Details",
      "text" : "Pre-training We pre-train LayoutLMv2 models using Adam optimizer (Kingma and Ba, 2015; Loshchilov and Hutter, 2019), with the learning rate of 2 × 10−5, weight decay of 1 × 10−2,and (β1, β2) = (0.9, 0.999). The learning rate is linearly warmed up over the first 10% steps then linearly decayed. LayoutLMv2BASE is trained with a batch size of 64 for 5 epochs, and LayoutLMv2LARGE is trained with a batch size of 2048 for 20 epochs on the IIT-CDIP dataset.\n5https://gitlab.com/filipg/geval\nFine-tuning for Visual Question Answering We treat the DocVQA as an extractive QA task and build a token-level classifier on top of the text part of LayoutLMv2 output representations. Question tokens, context tokens and visual tokens are assigned to segment [A], [B] and [C], respectively. The maximum sequence length is set to L = 384.\nFine-tuning for Document Image Classification This task depends on high-level visual information, thereby we leverage the image features explicitly in the fine-tuning stage. We pool the visual embeddings into a global pre-encoder feature, and pool the visual part of LayoutLMv2 output representations into a global post-encoder feature. The pre and post-encoder features along with the [CLS] output feature are concatenated and fed into the final classification layer.\nFine-tuning for Sequential Labeling We formalize FUNSD, SROIE, CORD, and Kleister-NDA as the sequential labeling tasks. To fine-tune LayoutLMv2 models on these tasks, we build a tokenlevel classification layer above the text part of the output representations to predict the BIO tags for each entity field."
    }, {
      "heading" : "C Detailed Experiment Results",
      "text" : "Tables list per-task detailed results for the four entity extraction tasks, with Table 6 for FUNSD, Table 7 for CORD, Table 8 for SROIE, and Table 9 for Kleister-NDA."
    } ],
    "references" : [ {
      "title" : "Cutting the error by half: Investigation of very deep cnn and advanced training strategies for document image classification",
      "author" : [ "Muhammad Zeshan Afzal", "Andreas Kölsch", "Sheraz Ahmed", "Marcus Liwicki." ],
      "venue" : "2017 14th IAPR International Conference",
      "citeRegEx" : "Afzal et al\\.,? 2017",
      "shortCiteRegEx" : "Afzal et al\\.",
      "year" : 2017
    }, {
      "title" : "Unilmv2: Pseudo-masked language models for unified language model pre-training",
      "author" : [ "Hangbo Bao", "Li Dong", "Furu Wei", "Wenhui Wang", "Nan Yang", "Xiaodong Liu", "Yu Wang", "Jianfeng Gao", "Songhao Piao", "Ming Zhou", "Hsiao-Wuen Hon." ],
      "venue" : "Proceed-",
      "citeRegEx" : "Bao et al\\.,? 2020",
      "shortCiteRegEx" : "Bao et al\\.",
      "year" : 2020
    }, {
      "title" : "Uniter: Universal image-text representation learning",
      "author" : [ "Yen-Chun Chen", "Linjie Li", "Licheng Yu", "Ahmed El Kholy", "Faisal Ahmed", "Zhe Gan", "Yu Cheng", "Jingjing Liu." ],
      "venue" : "ECCV.",
      "citeRegEx" : "Chen et al\\.,? 2020",
      "shortCiteRegEx" : "Chen et al\\.",
      "year" : 2020
    }, {
      "title" : "Document image classification with intradomain transfer learning and stacked generalization of deep convolutional neural networks",
      "author" : [ "Arindam Das", "Saikat Roy", "Ujjwal Bhattacharya." ],
      "venue" : "2018 24th International Conference on Pattern Recogni-",
      "citeRegEx" : "Das et al\\.,? 2018",
      "shortCiteRegEx" : "Das et al\\.",
      "year" : 2018
    }, {
      "title" : "Modular multimodal architecture for document classification",
      "author" : [ "Tyler Dauphinee", "Nikunj Patel", "Mohammad Mehdi Rashidi." ],
      "venue" : "ArXiv, abs/1912.04376.",
      "citeRegEx" : "Dauphinee et al\\.,? 2019",
      "shortCiteRegEx" : "Dauphinee et al\\.",
      "year" : 2019
    }, {
      "title" : "BERT: Pre-training of deep bidirectional transformers for language understanding",
      "author" : [ "Jacob Devlin", "Ming-Wei Chang", "Kenton Lee", "Kristina Toutanova." ],
      "venue" : "Proceedings of the 2019 Conference of the North American Chapter of the Association",
      "citeRegEx" : "Devlin et al\\.,? 2019",
      "shortCiteRegEx" : "Devlin et al\\.",
      "year" : 2019
    }, {
      "title" : "Kleister: A novel task for information extraction involving long documents",
      "author" : [ "Filip Graliński", "Tomasz Stanisławek", "Anna Wróblewska", "Dawid Lipiński", "Agnieszka Kaliska", "Paulina Rosalska", "Bartosz Topolski", "Przemysław Biecek" ],
      "venue" : null,
      "citeRegEx" : "Graliński et al\\.,? \\Q2020\\E",
      "shortCiteRegEx" : "Graliński et al\\.",
      "year" : 2020
    }, {
      "title" : "Evaluation of deep convolutional nets for document image classification and retrieval",
      "author" : [ "Adam W Harley", "Alex Ufkes", "Konstantinos G Derpanis." ],
      "venue" : "International Conference on Document Analysis and Recognition (ICDAR).",
      "citeRegEx" : "Harley et al\\.,? 2015",
      "shortCiteRegEx" : "Harley et al\\.",
      "year" : 2015
    }, {
      "title" : "Mask R-CNN",
      "author" : [ "Kaiming He", "Georgia Gkioxari", "Piotr Dollár", "Ross B. Girshick." ],
      "venue" : "IEEE International Conference on Computer Vision, ICCV 2017, Venice, Italy, October 22-29, 2017, pages 2980–2988. IEEE Computer Society.",
      "citeRegEx" : "He et al\\.,? 2017",
      "shortCiteRegEx" : "He et al\\.",
      "year" : 2017
    }, {
      "title" : "BROS}: A pre-trained language model for understanding texts",
      "author" : [ "Teakgyu Hong", "DongHyun Kim", "Mingi Ji", "Wonseok Hwang", "Daehyun Nam", "Sungrae Park" ],
      "venue" : null,
      "citeRegEx" : "Hong et al\\.,? \\Q2021\\E",
      "shortCiteRegEx" : "Hong et al\\.",
      "year" : 2021
    }, {
      "title" : "Icdar2019 competition on scanned receipt ocr and information extraction",
      "author" : [ "Z. Huang", "K. Chen", "J. He", "X. Bai", "D. Karatzas", "S. Lu", "C.V. Jawahar." ],
      "venue" : "2019 International Conference on Document Analysis and Recognition (ICDAR), pages 1516–1520.",
      "citeRegEx" : "Huang et al\\.,? 2019",
      "shortCiteRegEx" : "Huang et al\\.",
      "year" : 2019
    }, {
      "title" : "Spatial dependency parsing for semi-structured document information extraction",
      "author" : [ "Wonseok Hwang", "Jinyeong Yim", "Seunghyun Park", "Sohee Yang", "Minjoon Seo" ],
      "venue" : null,
      "citeRegEx" : "Hwang et al\\.,? \\Q2020\\E",
      "shortCiteRegEx" : "Hwang et al\\.",
      "year" : 2020
    }, {
      "title" : "Funsd: A dataset for form understanding in noisy scanned documents",
      "author" : [ "Guillaume Jaume", "Hazim Kemal Ekenel", "JeanPhilippe Thiran." ],
      "venue" : "2019 International Conference on Document Analysis and Recognition Workshops (ICDARW).",
      "citeRegEx" : "Jaume et al\\.,? 2019",
      "shortCiteRegEx" : "Jaume et al\\.",
      "year" : 2019
    }, {
      "title" : "Adam: A method for stochastic optimization",
      "author" : [ "Diederik P. Kingma", "Jimmy Ba." ],
      "venue" : "3rd International Conference on Learning Representations, ICLR 2015, San Diego, CA, USA, May 7-9, 2015, Conference Track Proceedings.",
      "citeRegEx" : "Kingma and Ba.,? 2015",
      "shortCiteRegEx" : "Kingma and Ba.",
      "year" : 2015
    }, {
      "title" : "Building a test collection for complex document information processing",
      "author" : [ "D. Lewis", "G. Agam", "S. Argamon", "O. Frieder", "D. Grossman", "J. Heard." ],
      "venue" : "Proceedings of the 29th Annual International ACM SIGIR Conference on Research and Development in",
      "citeRegEx" : "Lewis et al\\.,? 2006",
      "shortCiteRegEx" : "Lewis et al\\.",
      "year" : 2006
    }, {
      "title" : "Feature networks for object detection",
      "author" : [ "Tsung-Yi Lin", "Piotr Dollar", "Ross Girshick", "Kaiming He", "Bharath Hariharan", "Serge Belongie." ],
      "venue" : "Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR).",
      "citeRegEx" : "Lin et al\\.,? 2017",
      "shortCiteRegEx" : "Lin et al\\.",
      "year" : 2017
    }, {
      "title" : "Graph convolution for multimodal information extraction from visually rich documents",
      "author" : [ "Xiaojing Liu", "Feiyu Gao", "Qiong Zhang", "Huasha Zhao." ],
      "venue" : "Proceedings of the 2019 Conference of the North",
      "citeRegEx" : "Liu et al\\.,? 2019",
      "shortCiteRegEx" : "Liu et al\\.",
      "year" : 2019
    }, {
      "title" : "ZeroShotCeres: Zero-shot relation extraction from semi-structured webpages",
      "author" : [ "Colin Lockard", "Prashant Shiralkar", "Xin Luna Dong", "Hannaneh Hajishirzi." ],
      "venue" : "Proceedings of the 58th Annual Meeting of the Association for Computational Linguistics,",
      "citeRegEx" : "Lockard et al\\.,? 2020",
      "shortCiteRegEx" : "Lockard et al\\.",
      "year" : 2020
    }, {
      "title" : "Decoupled weight decay regularization",
      "author" : [ "Ilya Loshchilov", "Frank Hutter." ],
      "venue" : "7th International Conference on Learning Representations, ICLR 2019, New Orleans, LA, USA, May 6-9, 2019. OpenReview.net.",
      "citeRegEx" : "Loshchilov and Hutter.,? 2019",
      "shortCiteRegEx" : "Loshchilov and Hutter.",
      "year" : 2019
    }, {
      "title" : "Vilbert: Pretraining task-agnostic visiolinguistic representations for vision-and-language tasks",
      "author" : [ "Jiasen Lu", "Dhruv Batra", "Devi Parikh", "Stefan Lee." ],
      "venue" : "Advances in Neural Information Processing Systems 32: Annual Conference on Neural Infor-",
      "citeRegEx" : "Lu et al\\.,? 2019",
      "shortCiteRegEx" : "Lu et al\\.",
      "year" : 2019
    }, {
      "title" : "Representation learning for information extraction from form-like documents",
      "author" : [ "Bodhisattwa Prasad Majumder", "Navneet Potti", "Sandeep Tata", "James Bradley Wendt", "Qi Zhao", "Marc Najork." ],
      "venue" : "Proceedings of the 58th Annual Meeting of the Asso-",
      "citeRegEx" : "Majumder et al\\.,? 2020",
      "shortCiteRegEx" : "Majumder et al\\.",
      "year" : 2020
    }, {
      "title" : "Docvqa: A dataset for vqa on document images",
      "author" : [ "Minesh Mathew", "Dimosthenis Karatzas", "C.V. Jawahar." ],
      "venue" : "Proceedings of the IEEE/CVF Winter Conference on Applications of Computer Vision (WACV), pages 2200–2209.",
      "citeRegEx" : "Mathew et al\\.,? 2021",
      "shortCiteRegEx" : "Mathew et al\\.",
      "year" : 2021
    }, {
      "title" : "Cord: A consolidated receipt dataset for postocr parsing",
      "author" : [ "Seunghyun Park", "Seung Shin", "Bado Lee", "Junyeop Lee", "Jaeheung Surh", "Minjoon Seo", "Hwalsuk Lee" ],
      "venue" : null,
      "citeRegEx" : "Park et al\\.,? \\Q2019\\E",
      "shortCiteRegEx" : "Park et al\\.",
      "year" : 2019
    }, {
      "title" : "Exploring the limits of transfer learning with a unified text-to-text transformer",
      "author" : [ "Colin Raffel", "Noam Shazeer", "Adam Roberts", "Katherine Lee", "Sharan Narang", "Michael Matena", "Yanqi Zhou", "Wei Li", "Peter J Liu." ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "Raffel et al\\.,? 2020",
      "shortCiteRegEx" : "Raffel et al\\.",
      "year" : 2020
    }, {
      "title" : "SQuAD: 100,000+ questions for machine comprehension of text",
      "author" : [ "Pranav Rajpurkar", "Jian Zhang", "Konstantin Lopyrev", "Percy Liang." ],
      "venue" : "Proceedings of the 2016 Conference on Empirical Methods in Natural Language Processing, pages 2383–2392, Austin,",
      "citeRegEx" : "Rajpurkar et al\\.,? 2016",
      "shortCiteRegEx" : "Rajpurkar et al\\.",
      "year" : 2016
    }, {
      "title" : "Deterministic routing between layout abstractions for multi-scale",
      "author" : [ "Ritesh Sarkhel", "Arnab Nandi" ],
      "venue" : null,
      "citeRegEx" : "Sarkhel and Nandi.,? \\Q2019\\E",
      "shortCiteRegEx" : "Sarkhel and Nandi.",
      "year" : 2019
    }, {
      "title" : "Self-attention with relative position representations",
      "author" : [ "Peter Shaw", "Jakob Uszkoreit", "Ashish Vaswani." ],
      "venue" : "Proceedings of the 2018 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Tech-",
      "citeRegEx" : "Shaw et al\\.,? 2018",
      "shortCiteRegEx" : "Shaw et al\\.",
      "year" : 2018
    }, {
      "title" : "VL-BERT: pretraining of generic visual-linguistic representations",
      "author" : [ "Weijie Su", "Xizhou Zhu", "Yue Cao", "Bin Li", "Lewei Lu", "Furu Wei", "Jifeng Dai." ],
      "venue" : "8th International Conference on Learning Representations, ICLR 2020, Addis Ababa, Ethiopia, April",
      "citeRegEx" : "Su et al\\.,? 2020",
      "shortCiteRegEx" : "Su et al\\.",
      "year" : 2020
    }, {
      "title" : "Videobert: A joint model for video and language representation learning",
      "author" : [ "Chen Sun", "Austin Myers", "Carl Vondrick", "Kevin Murphy", "Cordelia Schmid." ],
      "venue" : "2019 IEEE/CVF International Conference on Computer Vision, ICCV 2019, Seoul, Ko-",
      "citeRegEx" : "Sun et al\\.,? 2019",
      "shortCiteRegEx" : "Sun et al\\.",
      "year" : 2019
    }, {
      "title" : "Inception-v4, inception-resnet and the impact of residual connections on learning",
      "author" : [ "Christian Szegedy", "Sergey Ioffe", "Vincent Vanhoucke", "Alexander A. Alemi." ],
      "venue" : "Proceedings of the Thirty-First AAAI Conference on Artificial Intelligence, Febru-",
      "citeRegEx" : "Szegedy et al\\.,? 2017",
      "shortCiteRegEx" : "Szegedy et al\\.",
      "year" : 2017
    }, {
      "title" : "LXMERT: Learning cross-modality encoder representations from transformers",
      "author" : [ "Hao Tan", "Mohit Bansal." ],
      "venue" : "Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natu-",
      "citeRegEx" : "Tan and Bansal.,? 2019",
      "shortCiteRegEx" : "Tan and Bansal.",
      "year" : 2019
    }, {
      "title" : "Robust layout-aware IE for visually rich documents with pre-trained language models",
      "author" : [ "Mengxi Wei", "Yifan He", "Qiong Zhang." ],
      "venue" : "Proceedings of the 43rd International ACM SIGIR conference on research and development in Information Retrieval,",
      "citeRegEx" : "Wei et al\\.,? 2020",
      "shortCiteRegEx" : "Wei et al\\.",
      "year" : 2020
    }, {
      "title" : "Transformers: State-of-the-art natural language processing",
      "author" : [ "Teven Le Scao", "Sylvain Gugger", "Mariama Drame", "Quentin Lhoest", "Alexander Rush." ],
      "venue" : "Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing:",
      "citeRegEx" : "Scao et al\\.,? 2020",
      "shortCiteRegEx" : "Scao et al\\.",
      "year" : 2020
    }, {
      "title" : "Aggregated residual transformations for deep neural networks",
      "author" : [ "Saining Xie", "Ross B. Girshick", "Piotr Dollár", "Zhuowen Tu", "Kaiming He." ],
      "venue" : "2017 IEEE Conference on Computer Vision and Pattern Recognition, CVPR 2017, Honolulu, HI, USA, July",
      "citeRegEx" : "Xie et al\\.,? 2017",
      "shortCiteRegEx" : "Xie et al\\.",
      "year" : 2017
    }, {
      "title" : "Layoutlm: Pretraining of text and layout for document image understanding",
      "author" : [ "Yiheng Xu", "Minghao Li", "Lei Cui", "Shaohan Huang", "Furu Wei", "Ming Zhou." ],
      "venue" : "KDD ’20: The 26th ACM SIGKDD Conference on Knowledge Discovery and Data Min-",
      "citeRegEx" : "Xu et al\\.,? 2020",
      "shortCiteRegEx" : "Xu et al\\.",
      "year" : 2020
    }, {
      "title" : "Learning to extract semantic structure from documents using multimodal fully convolutional neural networks",
      "author" : [ "Xiao Yang", "Ersin Yumer", "Paul Asente", "Mike Kraley", "Daniel Kifer", "C. Lee Giles." ],
      "venue" : "2017 IEEE Conference on Computer Vision and Pat-",
      "citeRegEx" : "Yang et al\\.,? 2017",
      "shortCiteRegEx" : "Yang et al\\.",
      "year" : 2017
    }, {
      "title" : "Pick: Processing key information extraction from documents using improved graph learning-convolutional networks",
      "author" : [ "Wenwen Yu", "Ning Lu", "Xianbiao Qi", "Ping Gong", "Rong Xiao" ],
      "venue" : null,
      "citeRegEx" : "Yu et al\\.,? \\Q2020\\E",
      "shortCiteRegEx" : "Yu et al\\.",
      "year" : 2020
    }, {
      "title" : "Trie: End-to-end text reading and information extraction for document understanding",
      "author" : [ "Peng Zhang", "Yunlu Xu", "Zhanzhan Cheng", "Shiliang Pu", "Jing Lu", "Liang Qiao", "Yi Niu", "Fei Wu" ],
      "venue" : null,
      "citeRegEx" : "Zhang et al\\.,? \\Q2020\\E",
      "shortCiteRegEx" : "Zhang et al\\.",
      "year" : 2020
    }, {
      "title" : "Publaynet: largest dataset ever for document layout analysis",
      "author" : [ "Xu Zhong", "Jianbin Tang", "Antonio Jimeno Yepes." ],
      "venue" : "2019 International Conference on Document Analysis and Recognition (ICDAR), pages 1015–1022. IEEE.",
      "citeRegEx" : "Zhong et al\\.,? 2019",
      "shortCiteRegEx" : "Zhong et al\\.",
      "year" : 2019
    } ],
    "referenceMentions" : [ {
      "referenceID" : 35,
      "context" : "built on the shallow fusion between textual and visual/layout/style information (Yang et al., 2017; Liu et al., 2019; Sarkhel and Nandi, 2019; Yu et al., 2020; Majumder et al., 2020; Wei et al., 2020; Zhang et al., 2020).",
      "startOffset" : 80,
      "endOffset" : 220
    }, {
      "referenceID" : 16,
      "context" : "built on the shallow fusion between textual and visual/layout/style information (Yang et al., 2017; Liu et al., 2019; Sarkhel and Nandi, 2019; Yu et al., 2020; Majumder et al., 2020; Wei et al., 2020; Zhang et al., 2020).",
      "startOffset" : 80,
      "endOffset" : 220
    }, {
      "referenceID" : 25,
      "context" : "built on the shallow fusion between textual and visual/layout/style information (Yang et al., 2017; Liu et al., 2019; Sarkhel and Nandi, 2019; Yu et al., 2020; Majumder et al., 2020; Wei et al., 2020; Zhang et al., 2020).",
      "startOffset" : 80,
      "endOffset" : 220
    }, {
      "referenceID" : 36,
      "context" : "built on the shallow fusion between textual and visual/layout/style information (Yang et al., 2017; Liu et al., 2019; Sarkhel and Nandi, 2019; Yu et al., 2020; Majumder et al., 2020; Wei et al., 2020; Zhang et al., 2020).",
      "startOffset" : 80,
      "endOffset" : 220
    }, {
      "referenceID" : 20,
      "context" : "built on the shallow fusion between textual and visual/layout/style information (Yang et al., 2017; Liu et al., 2019; Sarkhel and Nandi, 2019; Yu et al., 2020; Majumder et al., 2020; Wei et al., 2020; Zhang et al., 2020).",
      "startOffset" : 80,
      "endOffset" : 220
    }, {
      "referenceID" : 31,
      "context" : "built on the shallow fusion between textual and visual/layout/style information (Yang et al., 2017; Liu et al., 2019; Sarkhel and Nandi, 2019; Yu et al., 2020; Majumder et al., 2020; Wei et al., 2020; Zhang et al., 2020).",
      "startOffset" : 80,
      "endOffset" : 220
    }, {
      "referenceID" : 37,
      "context" : "built on the shallow fusion between textual and visual/layout/style information (Yang et al., 2017; Liu et al., 2019; Sarkhel and Nandi, 2019; Yu et al., 2020; Majumder et al., 2020; Wei et al., 2020; Zhang et al., 2020).",
      "startOffset" : 80,
      "endOffset" : 220
    }, {
      "referenceID" : 17,
      "context" : "To this end, the second direction relies on the deep fusion among textual, visual, and layout information from a great number of unlabeled documents in different domains, where pre-training techniques play an important role in learning the cross-modality interaction in an end-to-end fashion (Lockard et al., 2020; Xu et al., 2020).",
      "startOffset" : 292,
      "endOffset" : 331
    }, {
      "referenceID" : 34,
      "context" : "To this end, the second direction relies on the deep fusion among textual, visual, and layout information from a great number of unlabeled documents in different domains, where pre-training techniques play an important role in learning the cross-modality interaction in an end-to-end fashion (Lockard et al., 2020; Xu et al., 2020).",
      "startOffset" : 292,
      "endOffset" : 331
    }, {
      "referenceID" : 34,
      "context" : "In this paper, we present an improved version of LayoutLM (Xu et al., 2020), aka LayoutLMv2.",
      "startOffset" : 58,
      "endOffset" : 75
    }, {
      "referenceID" : 26,
      "context" : "1-D relative position representations (Shaw et al., 2018; Raffel et al., 2020; Bao et al., 2020), we propose the spatial-aware self-attention mechanism for LayoutLMv2, which involves a 2-D relative position representation for token pairs.",
      "startOffset" : 38,
      "endOffset" : 96
    }, {
      "referenceID" : 23,
      "context" : "1-D relative position representations (Shaw et al., 2018; Raffel et al., 2020; Bao et al., 2020), we propose the spatial-aware self-attention mechanism for LayoutLMv2, which involves a 2-D relative position representation for token pairs.",
      "startOffset" : 38,
      "endOffset" : 96
    }, {
      "referenceID" : 1,
      "context" : "1-D relative position representations (Shaw et al., 2018; Raffel et al., 2020; Bao et al., 2020), we propose the spatial-aware self-attention mechanism for LayoutLMv2, which involves a 2-D relative position representation for token pairs.",
      "startOffset" : 38,
      "endOffset" : 96
    }, {
      "referenceID" : 30,
      "context" : "The second is the text-image matching strategy popular in previous vision-language pre-training models (Tan and Bansal, 2019; Lu et al., 2019; Su et al., 2020; Chen et al., 2020; Sun et al., 2019), where the model learns whether the document image and textual content are correlated.",
      "startOffset" : 103,
      "endOffset" : 196
    }, {
      "referenceID" : 19,
      "context" : "The second is the text-image matching strategy popular in previous vision-language pre-training models (Tan and Bansal, 2019; Lu et al., 2019; Su et al., 2020; Chen et al., 2020; Sun et al., 2019), where the model learns whether the document image and textual content are correlated.",
      "startOffset" : 103,
      "endOffset" : 196
    }, {
      "referenceID" : 27,
      "context" : "The second is the text-image matching strategy popular in previous vision-language pre-training models (Tan and Bansal, 2019; Lu et al., 2019; Su et al., 2020; Chen et al., 2020; Sun et al., 2019), where the model learns whether the document image and textual content are correlated.",
      "startOffset" : 103,
      "endOffset" : 196
    }, {
      "referenceID" : 2,
      "context" : "The second is the text-image matching strategy popular in previous vision-language pre-training models (Tan and Bansal, 2019; Lu et al., 2019; Su et al., 2020; Chen et al., 2020; Sun et al., 2019), where the model learns whether the document image and textual content are correlated.",
      "startOffset" : 103,
      "endOffset" : 196
    }, {
      "referenceID" : 28,
      "context" : "The second is the text-image matching strategy popular in previous vision-language pre-training models (Tan and Bansal, 2019; Lu et al., 2019; Su et al., 2020; Chen et al., 2020; Sun et al., 2019), where the model learns whether the document image and textual content are correlated.",
      "startOffset" : 103,
      "endOffset" : 196
    }, {
      "referenceID" : 12,
      "context" : "We select six publicly available benchmark datasets as the downstream tasks to evaluate the performance of the pre-trained LayoutLMv2 model, which are the FUNSD dataset (Jaume et al., 2019) for form understanding, the CORD dataset (Park et al.",
      "startOffset" : 169,
      "endOffset" : 189
    }, {
      "referenceID" : 22,
      "context" : ", 2019) for form understanding, the CORD dataset (Park et al., 2019) and the SROIE dataset (Huang et al.",
      "startOffset" : 49,
      "endOffset" : 68
    }, {
      "referenceID" : 10,
      "context" : ", 2019) and the SROIE dataset (Huang et al., 2019) for receipt understanding, the Kleister-NDA dataset (Graliński et al.",
      "startOffset" : 30,
      "endOffset" : 50
    }, {
      "referenceID" : 6,
      "context" : ", 2019) for receipt understanding, the Kleister-NDA dataset (Graliński et al., 2020) for long document understanding with a complex layout, the RVL-CDIP dataset (Harley et al.",
      "startOffset" : 60,
      "endOffset" : 84
    }, {
      "referenceID" : 7,
      "context" : ", 2020) for long document understanding with a complex layout, the RVL-CDIP dataset (Harley et al., 2015) for document image classification, and the DocVQA dataset (Mathew et al.",
      "startOffset" : 84,
      "endOffset" : 105
    }, {
      "referenceID" : 21,
      "context" : ", 2015) for document image classification, and the DocVQA dataset (Mathew et al., 2021) for visual question answering on document images.",
      "startOffset" : 66,
      "endOffset" : 87
    }, {
      "referenceID" : 33,
      "context" : "We use ResNeXt-FPN (Xie et al., 2017; Lin et al., 2017) architecture as the backbone of the visual encoder, whose parameters can be updated through backpropagation.",
      "startOffset" : 19,
      "endOffset" : 55
    }, {
      "referenceID" : 15,
      "context" : "We use ResNeXt-FPN (Xie et al., 2017; Lin et al., 2017) architecture as the backbone of the visual encoder, whose parameters can be updated through backpropagation.",
      "startOffset" : 19,
      "endOffset" : 55
    }, {
      "referenceID" : 23,
      "context" : "Similar practice has been shown effective on text-only Transformer architectures (Raffel et al., 2020; Bao et al., 2020).",
      "startOffset" : 81,
      "endOffset" : 120
    }, {
      "referenceID" : 1,
      "context" : "Similar practice has been shown effective on text-only Transformer architectures (Raffel et al., 2020; Bao et al., 2020).",
      "startOffset" : 81,
      "endOffset" : 120
    }, {
      "referenceID" : 14,
      "context" : "Following LayoutLM, we use IIT-CDIP Test Collection (Lewis et al., 2006) as the pre-training dataset.",
      "startOffset" : 52,
      "endOffset" : 72
    }, {
      "referenceID" : 22,
      "context" : ", 2019), CORD (Park et al., 2019), SROIE (Huang et al.",
      "startOffset" : 14,
      "endOffset" : 33
    }, {
      "referenceID" : 10,
      "context" : ", 2019), SROIE (Huang et al., 2019) and KleisterNDA (Graliński et al.",
      "startOffset" : 15,
      "endOffset" : 35
    }, {
      "referenceID" : 6,
      "context" : ", 2019) and KleisterNDA (Graliński et al., 2020) datasets define entity extraction tasks that aim to extract the value of a set of pre-defined keys, which we formalize as a sequential labeling task.",
      "startOffset" : 24,
      "endOffset" : 48
    }, {
      "referenceID" : 7,
      "context" : "RVL-CDIP (Harley et al., 2015) is for document image classification.",
      "startOffset" : 9,
      "endOffset" : 30
    }, {
      "referenceID" : 21,
      "context" : "DocVQA (Mathew et al., 2021), as the name suggests, is a dataset for visual question answering on document images.",
      "startOffset" : 7,
      "endOffset" : 28
    }, {
      "referenceID" : 1,
      "context" : "For the encoder along with the text embedding layer, LayoutLMv2 uses the same architecture as UniLMv2 (Bao et al., 2020), thus it is initialized from UniLMv2.",
      "startOffset" : 102,
      "endOffset" : 120
    }, {
      "referenceID" : 8,
      "context" : "For the ResNeXt-FPN part in the visual embedding layer, the backbone of a MaskRCNN (He et al., 2017) model trained on PubLayNet (Zhong et al.",
      "startOffset" : 83,
      "endOffset" : 100
    }, {
      "referenceID" : 38,
      "context" : ", 2017) model trained on PubLayNet (Zhong et al., 2019) is leveraged.",
      "startOffset" : 35,
      "endOffset" : 55
    }, {
      "referenceID" : 5,
      "context" : "answering task DocVQA and the other four entity extraction tasks, we follow common practice like (Devlin et al., 2019) and build task specified head layers over the text part of LayoutLMv2 outputs.",
      "startOffset" : 97,
      "endOffset" : 118
    }, {
      "referenceID" : 24,
      "context" : "In the DocVQA paper, experiment results show that the BERT model fine-tuned on the SQuAD dataset (Rajpurkar et al., 2016) outperforms the original BERT model.",
      "startOffset" : 97,
      "endOffset" : 121
    }, {
      "referenceID" : 5,
      "context" : "Specifically, we compare LayoutLMv2 with BERT (Devlin et al., 2019), UniLMv2 (Bao et al.",
      "startOffset" : 46,
      "endOffset" : 67
    }, {
      "referenceID" : 1,
      "context" : ", 2019), UniLMv2 (Bao et al., 2020), and LayoutLM (Xu et al.",
      "startOffset" : 17,
      "endOffset" : 35
    }, {
      "referenceID" : 34,
      "context" : ", 2020), and LayoutLM (Xu et al., 2020) for all the experiment settings.",
      "startOffset" : 22,
      "endOffset" : 39
    }, {
      "referenceID" : 11,
      "context" : "Compared to the baselines, the LayoutLMv2 models are superior to the SPADE (Hwang et al., 2020) decoder method, as well as the text+layout pre-training approach BROS (Hong et al.",
      "startOffset" : 75,
      "endOffset" : 95
    }, {
      "referenceID" : 9,
      "context" : ", 2020) decoder method, as well as the text+layout pre-training approach BROS (Hong et al., 2021) that is built on the SPADE decoder, which demonstrates the effectiveness of our modeling approach.",
      "startOffset" : 78,
      "endOffset" : 97
    }, {
      "referenceID" : 36,
      "context" : "Moreover, with the same modal information, our LayoutLMv2 models also outperform existing multi-modal approaches PICK (Yu et al., 2020), TRIE (Zhang et al.",
      "startOffset" : 118,
      "endOffset" : 135
    }, {
      "referenceID" : 37,
      "context" : ", 2020), TRIE (Zhang et al., 2020) and the previous top1 method on the leaderboard,2 confirming the effectiveness of our pre-training for text, layout, and visual information.",
      "startOffset" : 14,
      "endOffset" : 34
    }, {
      "referenceID" : 34,
      "context" : "“LayoutLM” denotes the vanilla LayoutLM architecture in (Xu et al., 2020), which can be regarded as a LayoutLMv2 architecture without visual module and spatial-aware self-attention mechanism.",
      "startOffset" : 56,
      "endOffset" : 73
    } ],
    "year" : 2021,
    "abstractText" : "Pre-training of text and layout has proved effective in a variety of visually-rich document understanding tasks due to its effective model architecture and the advantage of large-scale unlabeled scanned/digital-born documents. We propose LayoutLMv2 architecture with new pre-training tasks to model the interaction among text, layout, and image in a single multi-modal framework. Specifically, with a two-stream multi-modal Transformer encoder, LayoutLMv2 uses not only the existing masked visual-language modeling task but also the new text-image alignment and text-image matching tasks, which make it better capture the cross-modality interaction in the pre-training stage. Meanwhile, it also integrates a spatial-aware self-attention mechanism into the Transformer architecture so that the model can fully understand the relative positional relationship among different text blocks. Experiment results show that LayoutLMv2 outperforms LayoutLM by a large margin and achieves new state-ofthe-art results on a wide variety of downstream visually-rich document understanding tasks, including FUNSD (0.7895 → 0.8420), CORD (0.9493 → 0.9601), SROIE (0.9524 → 0.9781), Kleister-NDA (0.8340→ 0.8520), RVL-CDIP (0.9443→ 0.9564), and DocVQA (0.7295 → 0.8672). We made our model and code publicly available at https://aka.ms /layoutlmv2.",
    "creator" : "LaTeX with hyperref"
  }
}