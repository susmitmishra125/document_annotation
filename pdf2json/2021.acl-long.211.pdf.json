{
  "name" : "2021.acl-long.211.pdf",
  "metadata" : {
    "source" : "META",
    "title" : "Towards Quantifiable Dialogue Coherence Evaluation",
    "authors" : [ "Zheng Ye", "Liucun Lu", "Lishan Huang", "Liang Lin", "Xiaodan Liang" ],
    "emails" : [ "yezh7@mail2.sysu.edu.cn,", "lulc@mail2.sysu.edu.cn,", "huanglsh6@mail2.sysu.edu.cn,", "linliang@ieee.org,", "xdliang328@gmail.com" ],
    "sections" : [ {
      "heading" : null,
      "text" : "Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing, pages 2718–2729\nAugust 1–6, 2021. ©2021 Association for Computational Linguistics\n2718"
    }, {
      "heading" : "1 Introduction",
      "text" : "Dialogue coherence, which requires a response to be fluent, consistent and context-related, is an essential property for developing promising dialogue\n∗Corresponding Author. 1The code and trained checkpoints are available at https:\n//github.com/James-Yip/QuantiDCE.\nsystems (Cervone et al., 2018). However, it is still challenging to evaluate the coherence of a response generated by a dialogue system. Although human evaluation is always considered as the most accurate way to evaluate the coherence, it is expensive and high-latency, which cannot meet the evaluation demand of the frequent development of dialogue systems. Therefore, automatic evaluation metrics are developed to serve as human proxies that can rapidly compute the dialogue coherence and return relatively accurate results.\nThe current widely used metrics measure the lexical word-overlap between generated responses and reference responses, such as BLEU (Papineni et al., 2002) and ROUGE (Lin, 2004). However, they have been demonstrated to be biased and correlate poorly with human judgements since no semantic information is considered (Liu et al., 2016; Novikova et al., 2017). To overcome this issue, researchers turned to develop learnable metrics based on neural networks that incorporate the semantic information, such as RUBER (Tao et al.,\n2018), BERT-RUBER (Ghazarian et al., 2019) and GRADE (Huang et al., 2020). However, these metrics deviate from the actual human rating due to two limitations. First, they simplify the coherence evaluation task in a two-level setting, i.e., coherent or incoherent, by maximizing the differences between the positive coherent dialogues and the negative incoherent ones obtained by some negative sampling strategies. In contrast, humans usually adopt Likert scaling and give coherence scores from multiple levels like 1 to 5, as shown in Figure 1. Second, to avoid relying on large-scale human-annotated data, they are mostly trained in a purely unsupervised manner and cannot align with the human rating due to the absence of introducing the actual human rating standards during training.\nTo address the above limitations, we propose a novel dialogue coherence metric training framework, named as Quantifiable Dialogue Coherence Evaluation (QuantiDCE). This framework consists of two training stages: Multi-Level Ranking (MLR) pre-training and Knowledge Distillation (KD) finetuning. At the MLR pre-training stage, a new multilevel ranking (MLR) loss is proposed for learning the coarse judgement of coherence degrees. Specifically, the MLR loss separates the context-response pairs with different coherence levels and compacts the pairs within the same level in one-dimensional score space. As a result, the pretrained model is able to distinguish different coherence-level dialogue responses for a given context and predicts more accurate coherence scores. At the KD finetuning stage, the pretrained model is further finetuned to learn the actual human rating standards with only very few human-annotated coherence scores. To mitigate overfitting into the scarce annotated data during fine-tuning, a novel knowledge distillation regularization loss is introduced to retain the knowledge learned at the pre-training stage, where the pretrained model (teacher) provides the soft targets for the model during fine-tuning (student). Experimental results show that the metric trained by our QuantiDCE obviously outperforms the other state-of-the-art metrics in terms of the Pearson, Spearman and Kendall correlations with human judgements by around 5% points on average. To summarize our contributions:\n1) We propose QuantiDCE, a novel quantifiable training framework for dialogue coherence evaluation, which aims to align the automatic scores with the actual human rating standards via MLR\npre-training and KD fine-tuning. To the best of our knowledge, it is the first attempt to consider the quantifiable problem for dialogue coherence evaluation.\n2) Extensive experiments demonstrate the effectiveness of our QuantiDCE, which enables the trained metric to have obviously stronger correlations with human judgements than the other stateof-the-art metrics."
    }, {
      "heading" : "2 Related Work",
      "text" : "Automatic Coherence Evaluation. The widely used automatic metrics, such as BLEU (Papineni et al., 2002), METEOR (Banerjee and Lavie, 2005) and ROUGE (Lin, 2004), use statistical rules to measure the degree of lexical word-overlap between generated responses and reference responses. However, these metrics have been demonstrated to correlate poorly with human judgments due to the absence of semantic information (Liu et al., 2016; Novikova et al., 2017). Therefore, the subsequent metrics are considered to incorporate the semantic information. For instance, BERTScore (Zhang et al., 2020) turns to measure the soft semantic word-overlap rather than the hard lexical wordoverlap like BLEU. Moreover, learnable metrics encoding the semantic information have been attracting interests recently, which are trained in a supervised manner with large-scale human-annotated data, such as ADEM (Lowe et al., 2017), or trained in an unsupervised manner with automatically constructed data, such as RUBER (Tao et al., 2018) and BERT-RUBER (Ghazarian et al., 2019). Furthermore, the recently proposed coherence metric, GRADE (Huang et al., 2020), introduces the graph information of dialogue topic transitions and achieves the current state-of-the-art results. Note that these learnable metrics are trained in a two-level training objective to separate the coherent dialogues from the incoherent ones, while our QuantiDCE models the task in a multi-level setting which is closer to the actual human rating.\nKnowledge Distillation. Knowledge distillation (KD) is a method that transfers the knowledge from a large trained teacher model to a smaller student model by using the soft targets provided by the teacher (Hinton et al., 2015). In recent years, KD has been applied to many specific tasks (Sun et al., 2020; Wei et al., 2019; Kim and Rush, 2016; Sourty et al., 2020). Unlike these previous works, we use KD to retain knowledge learned at the pre-training\nstage during fine-tuning and do not compress the model size of the student model."
    }, {
      "heading" : "3 QuantiDCE Framework",
      "text" : "In this section, we present QuantiDCE, a two-stage framework for dialogue coherence metric learning, consisting of Multi-Level Ranking (MLR) pre-training and Knowledge Distillation (KD) finetuning. As illustrated in Figure 2, given a metric model M (Section 3.1), QuantiDCE enables M to learn multi-level representations for contextresponse pairs with different levels of coherence degrees during the pre-training stage (Section 3.2), and further to learn the rating standards of humans with only a fraction of data during the fine-tuning stage (Section 3.3). After these two training stages, the quantifiable gap between automatic metrics and humans can be obviously reduced."
    }, {
      "heading" : "3.1 Model Architecture",
      "text" : "In our QuantiDCE framework, the metric modelM is composed of: (1) an encoder network for encoding the input context-response pairs into features and (2) a predictor network for transforming the encoded features into coherence scores. Specifically, we adopt BERT (Devlin et al., 2019) as the encoder\nnetwork and a multi-layer perceptron (MLP) as the predictor network.\nGiven a context c = {c1, · · · , cm} and a response r = {r1, · · · , rn} where ci and ri are tokens of the context and the response respectively, the c and r are concatenated as {[CLS], c1, · · · , cm, [SEP], r1, · · · , rn, [SEP]}, denoted as [c; r]. Then the coherence score ŝ of the response r w.r.t. the context c is predicted by:\nŝ =MLP (BERT ([c; r])), (1)\nwhere MLP is a three-layer fully-connected network in which the activation functions of the three layers are two exponential linear units (Clevert et al., 2016) and a sigmoid function, respectively."
    }, {
      "heading" : "3.2 MLR Pre-Training",
      "text" : "For learning the coarse judgement of coherence degrees without the direct supervision of score annotations, the model M is first pretrained by minimizing a new multi-level ranking (MLR) loss on a large-scale dialogue dataset. Concretely, the MLR loss is composed of a separation loss, a compactness loss and an ordering loss.\nFormally, given a training dataset Dpt = {(ci,Ri)}N1i=1 where ci is a dialogue context and\nRi = {(rji,1, · · · , r j i,K)}Lj=1 is a response set with L coherence levels2 andK responses for each level, the model M is trained by minimizing the following MLR loss:\nLmlr = 1\nN1 N1∑ i=1 (`sepi + ` com i + ` ord i ), (2)\nwhere `sepi , ` com i , and ` ord i refer to the separation loss, the compactness loss and the ordering loss of the ith example, respectively.\nThe separation loss aims to separate the features of context-response pairs with different coherence levels by separating the coherence scores of the different pairs3. Moreover, to efficiently compute the loss, we first compute the centroids of the context-response pairs belonging to the same coherence level for the ith dialogue example, i.e., ei = {eji = ∑K k=1 ŝ j i,k|j ∈ [1, L], e j i ∈ R} where ŝji,k is the coherence score of the context-response pair (ci, r j i,k), and the separation loss between the centroids is then computed as follows:\n`sepi = L−1∑ j=1 L∑ l=j+1 max(0, w ∗ λ− d(eji , e l i)), (3)\nwhere d(·) is the L1 distance, λ is the lower bound for the distance between two centroids, and w = l− j is the distance weight used for amplifying the lower bound w.r.t. the coherence-level gap.\nThe compactness loss aims to compact the pairs within the same level, which served as a regularization role to avoid the occurrence of outliers for each coherence level. Specifically, the coherence score ŝji,k is forced to be closer to the corresponding centroid eji as follows:\n`comi = L∑\nj=1 K∑ k=1 max(0,d(eji , ŝ j i,k)− µ), (4)\nwhere µ is the upper bound for the distance between the centroid of a certain coherence level and the score within this level.\n2The coherence level is in ascending order, i.e., the response in a higher level is more coherent than the lower one.\n3We also tried to directly restrict the features of differentlevel pairs to be separated, but the performance dropped compared with restricting the scores.\nThe ordering loss is finally introduced to assure that the rank order of the predicted scores satisfies the pre-defined order of coherence degrees, i.e., ŝji,k < ŝ j+1 i,k , j ∈ [1, L−1], k ∈ [1,K]. It is critical since the separation loss only restricts the scores of the pairs from different coherence levels to be separated and this restriction is also satisfied when the scores of the highest level are lower than the scores of the lowest level. Similar to the separation loss, the ordering loss is also computed between each two centroids as follows:\n`ordi = L−1∑ j=1 L∑ l=j+1 max(0, eli − e j i ). (5)"
    }, {
      "heading" : "3.3 KD Fine-Tuning",
      "text" : "The model M pretrained by the MLR loss is further trained at the KD fine-tuning stage to directly learn the actual human rating standards with only a fraction of annotated data.\nFormally, given a training dataset Dft = {(ci, ri, si)}N2i=1 where ci, ri and si are the dialogue context, the corresponding response and the human-annotated coherence score of ri w.r.t. ci respectively, the previous fine-tuning approach for the scoring task usually optimizes the model M with an MSE loss between the predicted score ŝi and the human score si:\n`msei = (si − ŝi)2. (6)\nHowever, by minimizing `msei for each example, the model M will be easily over-fitting on the very few annotated data, and thus the model generalizability will be dramatically reduced. To overcome this issue, a novel knowledge distillation (KD) regularization is introduced for retaining the knowledge learned at the MLR pre-training stage. Concretely, the pretrained model M is treated as the teacher model that provides the soft targets for the student model M̂ which is entirely copied from M . And we adopt the distillation objectives of TinyBERT (Jiao et al., 2020), including the distillations of the embedding layer, the Transformer layers and the prediction layer. The KD loss is then formulated as:\n`kdi = T+1∑ t=0 ||Oti − Ôti ||22 + T∑ t=1 ||Ati − Âti||22, (7)\nwhere || · ||22 indicates the squared L2 norm, T is the number of the Transformer layers, Oti and Ô t i are\nAlgorithm 1 Training Procedure of QuantiDCE Input: training datasets Dpt and Dft, metric model M Output: student model M̂ 1: initialize M with BERTBASE 2: for all (ci,Ri) ∈ Dpt do 3: Si =M(ci,Ri) 4: compute the centroids ei for Si 5: compute `sepi and ` ord i for ei\n6: compute `comi between ei and Si 7: compute Lmlr 8: update M to minimize Lmlr 9: end for\n10: initialize M̂ with M 11: for all (ci, ri, si) ∈ Dft do 12: Oi, Ai =M(ci, ri) 13: ŝi, Ôi, Âi = M̂(ci, ri) 14: compute `msei between si and ŝi 15: compute `kdi between Oi, Ai and Ôi, Âi 16: compute Lkd mse 17: update M̂ to minimize Lkd mse 18: end for 19: return student model M̂\nthe tth layer outputs of M and M̂ respectively, Ati and Âti are the attention matrices of the t\nth transformer layer. Note that the layer 0 and the layer T+1 refer to the embedding layer and the prediction layer respectively.\nOverall, the loss function for KD fine-tuning, named as KD-MSE loss, is the weighted sum of `msei and ` kd i across the whole training dataset Dft:\nLkd mse = 1\nN2 N2∑ i=1 (α ∗ `msei + β ∗ `kdi ), (8)\nwhere α and β are hyperparameters, and we empirically found that α = 1 and β = 5 performs well.\nThe overall training procedure is summarized in Algorithm 1."
    }, {
      "heading" : "4 Experiments",
      "text" : ""
    }, {
      "heading" : "4.1 Experimental Setup",
      "text" : "Baseline Metrics. We compare the metric model trained by our QuantiDCE with eight popular automatic dialogue metrics, including three lexical word-overlap metrics: BLEU (Papineni et al., 2002), ROUGE (Lin, 2004) and METEOR (Banerjee and Lavie, 2005), one semantic word-overlap metric, BERTScore (Zhang et al.,\n2020), and four learnable metrics: ADEM (Lowe et al., 2017), BERT-RUBER (Ghazarian et al., 2019), BLEURT (Sellam et al., 2020) and GRADE (Huang et al., 2020).\nEvaluation. Our QuantiDCE and the baselines are evaluated by computing the correlations between the model-predicted scores and the humanrated scores. Specifically, we adopt Pearson, Spearman and Kendall as the correlation measures and a large-scale human judgement benchmark (Huang et al., 2020) to provide the human-rated scores. This benchmark contains 1,200 unique (context, response, human-rated score) triplets for metric evaluation where the contexts were randomly selected from the test set of three chit-chat datasets including DailyDialog (Li et al., 2017), ConvAI2 (Dinan et al., 2019) and EmpatheticDialogues (Rashkin et al., 2019), and the responses were produced by both the retrieval-based dialogue models and the generation-based ones to assure response diversity.\nTraining Datasets. We use two datasets, DailyDialog++4 and DailyDialogEVAL5, to support the pre-training and fine-tuning of QuantiDCE, respectively. The DailyDialog++ dataset (Sai et al., 2020) contains over 11K conversations, which augments the original DailyDialog dataset with multiple responses of different quality levels including five golden reference responses, five adversarial irrelevant responses and five random selected responses for each context. Therefore, in this work, we set the number of coherence levels L = 3 where the pairs containing the random responses, the adversarial responses and the reference responses respectively belong to the levels from 1 to 3. As to the fine-tuning data, we use the DailyDialog human judgement dataset, denoted as DailyDialogEVAL, which is a subset of the adopted evaluation benchmark (Huang et al., 2020), with 300 human rating data in total, and randomly split the data into training (90%) and validation (10%) sets.\nImplementation Details. We use BERTBASE to initialize the encoder network, which is in line with the current SOTA metric, GRADE. For the MLR pre-training, we pretrain our model for 5 epochs with batch size 3 and learning rate 2e-5 where the lower bound for the separation loss λ = 0.3 and the upper bound for the compactness loss\n4https://github.com/iitmnlp/ Dialogue-Evaluation-with-BERT\n5https://github.com/li3cmz/GRADE\nµ = 0.1. For the KD fine-tuning, we further finetune the pretrained model for 20 epochs with batch size 10 and learning rate 5e-6. For all the training, BERTAdam is used as the optimizer with β1 = 0.9 and β2 = 0.999. For the Transformer-layer distillation, we distill all the Transformer layers since the model architectures of the teacher and the student are exactly the same."
    }, {
      "heading" : "4.2 Experimental Results",
      "text" : "Metric Performance. The correlation results of QuantiDCE and the other baseline metrics on the large-scale human judgement benchmark are presented in Table 1, including the ConvAI2 and the EmpatheticDialogues datasets.6 For a fair comparison, the learnable baseline metrics, ADEM, BERT-RUBER and GRADE, are trained on the training dataset we adopted, i.e., DailyDialog++.7 Generally, QuantiDCE achieves an absolute averaged correlation improvement by around 5% points over the current SOTA, GRADE. Besides, all the results of QuantiDCE are statistically significant with p-value <0.01.\n6The DailyDialogEVAL dataset was not used for evaluation since we used it for fine-tuning.\n7BLEURT was not trained on DailyDialog++ since this dataset is not suitable for the BLEURT pre-training strategy. Instead, we trained BLEURT with the fine-tuning data we used. The training details of these baseline metrics are provided in Appendix A.\nPre-Training Objective. To verify the superiority of our pre-training objective, namely the MLR loss, we investigated the performance of several existing loss functions for pre-training compared with ours. Specifically, two categories of loss functions used for metric training are adopted, including (a) the two-level setting and (b) the multi-level setting. The binary cross entropy (BCE) loss and the margin ranking loss are adopted for the two-level setting, while another three loss functions are adopted for the multi-level setting, including the supervised contrastive (SupCon) loss (Khosla et al., 2020), the fast-approximated triplet (FAT) loss (Yuan et al., 2019) and the vanilla MLR loss (Lin et al., 2020) 8. As shown in Table 2, the performance of our MLR loss is the best among all the pre-training objectives. And we also found that the multi-level setting losses perform better than the two-level ones, especially on the ConvAI2 dataset. Moreover, in order to more intuitively analyze the performances of these pre-training objectives, we also visualize the encoded features and the predicted scores of the model M after being pretrained by the above loss functions on the DailyDialog++ dataset without fine-tuning.9 As shown in Figure 3, (a) the BCE loss cannot separate the level-1 scores from the level-2 ones and the corresponding features are also mixed; (b) the FAT loss, on the other hand, separates the features of different levels well, but does not consider the relative gaps where the distances between the level-1 and level-3 features are\n8The details of these pre-training loss fucntions are provided in Appendix B.\n9The visualization results of the ranking loss, SupCon loss and Vanilla MLR loss are provided in Appendix C.\nnot larger than those between level-1 and level-2; (c) in contrast, our MLR loss separates both the features and the scores well and also considers the relative gaps between different levels.\nFine-Tuning Objective. Furthermore, we also verified the effectiveness of our KD-MSE loss during fine-tuning by comparing with other fine-tuning losses, including the pure MSE loss without KD regularization as shown in Equation 6 and the same MSE loss except for freezing the encoder network and only finetuning the predictor network i.e. the MLP, denoted as MSE (fix encoder). As the results shown in Table 3, compared with the other two losses, the model finetuned by our KD-MSE loss has the highest correlation results on both ConvAI2 and EmpatheticDialogues. Moreover, by compar-\ning the results of MSE and KD-MSE, we can find that introducing KD regularization leads to obvious averaged correlation improvements by 20.2% points on ConvAI2 and 11.3% points on EmpatheticDialogues, which verifies the effectiveness of the KD loss. Besides, we also reported the lastepoch correlation results on the training dataset, DailyDialogEVAL. And the results of MSE and MSE (fix encoder) indicate the phenomena of overfitting and under-fitting into DailyDialogEVAL respectively, which explain the reasons of their low performance on the two evaluation datasets. In contrast, our KD-MSE loss enables the model to learn the actual human rating standards from the scarce annotated data and avoid overfitting it si-\nmultaneously. Finally, in Figure 4, we present the visualization of the scores predicted by our QuantiDCE after KD fine-tuning. Compared with the score distributions before fine-tuning in Figure 3(c), the finetuned score distributions of the level-1 and level-3 are wider and partly overlap with the level2 distribution. It is predictable as the judgements of coherence are always subjective and humans tend to give vague and middle scores instead of extremely high or low scores."
    }, {
      "heading" : "4.3 Ablation Studies",
      "text" : "Component Analysis. To verify the contributions of the core components in our QuantiDCE, we further conducted ablation studies on the ConvAI2 dataset. As shown in Table 4, both the MLR pretraining and KD fine-tuning contribute to the better performance of QuantiDCE. Besides, we also conducted ablations by removing one of the secondary loss during MLR pre-training, including the separation loss, the compactness loss and the ordering loss. The results show that the performance benefits from all these losses in which the separation loss and the ordering loss are crucial for training a metric with strong and positive human correlations.\nNumber of Data for Fine-Tuning. Moreover, we also investigated how the scale of data for finetuning effects the model performance by increasing the number of fine-tuning data 5% each time from zero. The trend of the model performance is presented in Figure 5. We observed that minimizing our KD-MSE loss made the correlation results have a gradually increasing trend after an initial decrease.10 More specifically, the result achieved the standard before fine-tuning at around the 70% data scale and continued increasing until 100% with a final improvement by around 2% points. For comparison, the performance trends of MSE and MSE (fix encoder) are also provided. And the results present overall decreasing trends of the model performance, which indicates that the model trained by MSE or MSE (fix encoder) cannot benefit from the increasing of data scale, due to the severe overfitting or under-fitting. Therefore, to effectively utilize the limited data, it is important to enable the update of the entire network and add some constraints to avoid over-fitting, such as our proposed KD regularization."
    }, {
      "heading" : "4.4 Case Study",
      "text" : "To illustrate the performance of QuantiDCE, two representative examples are shown in Table 5 . The first example shows the strength of QuantiDCE where the coherence score given by ours is closer to the human rating score compared with the extremely high score given by GRADE. However, in the second example, both our QuantiDCE and GRADE deviate from the human score, possibly because the number of coherence levels we adopted in this work (L = 3) is insufficient as humans usually consider more levels of dialogue coherence.\n10The initial decrease probably attributes to the randomness of data sampling where the smaller the sampling ratio is, the higher the probability that noisy samples dominate the sampled data will be. And overfitting into the noisy samples leads to the performance decrease."
    }, {
      "heading" : "5 Conclusion",
      "text" : "In this paper, we propose QuantiDCE, a novel training framework aiming to bridge the gap between the training objective and the actual human rating and train a quantifiable dialogue coherence metric. In general, QuantiDCE includes two training stages, MLR pre-training for learning the coarse human judgements of dialogue coherence degrees, and KD fine-tuning for learning the actual human rating standards. Experimental results show that the metric trained by QuantiDCE presents strong correlations with human judgements. For future work, it is interesting to investigate a more efficient way to obtain multi-level data and extend the multilevel setting into the general evaluation for natural language generation."
    }, {
      "heading" : "Acknowledgments",
      "text" : "We thank all anonymous reviewers for their constructive comments. This work was supported in part by National Key R&D Program of China under Grant No. 2020AAA0109700, National Natural Science Foundation of China (NSFC) under Grant No.U19A2073 and No.61976233, Guangdong Province Basic and Applied Basic Research (Regional Joint Fund-Key) Grant No.2019B1515120039, Shenzhen Fundamental Research Program (Project No. RCYX20200714114642083, No. JCYJ20190807154211365), Zhijiang Lab’s Open Fund (No. 2020AA3AB14) and CSIG Young Fellow Support Fund."
    }, {
      "heading" : "A Training Details of the learnable baseline metrics",
      "text" : "a) Following Sai et al. (2020), we trained ADEM by first initializing it with the official checkpoint and further finetuning on DailyDialog++ with a target of 5 for level-3 pairs and 1 for level-1 pairs; b) BERT-RUBER and GRADE were both trained on DailyDialog++ where level-3 pairs as positive\nsamples and both level-1 and level-2 pairs as negative samples, except that the former use crossentropy loss while the latter use ranking loss; c) BLEURT was initialized with the official recommended checkpoint BLEURT-Base and finetuned on DailyDilaogEVAL by following the office guidelines11."
    }, {
      "heading" : "B Details of the Pre-Training Losses",
      "text" : "BCE Loss. The binary cross entropy (BCE) loss is adopted for the experiments of the two-level setting, where both the adversarial irrelevant responses and random selected responses of the dailydialog++ dataset (Sai et al., 2020) are treated as negative samples and labeled as 0, while the golden reference responses are treated as positive samples and labeled as 1.\nMargin Ranking Loss. Similarly, the margin ranking loss simplifies the evaluation task as a two-level setting and maximizes the differences between the positive coherent dialogues and the negative incoherent ones. As the name suggests, the focus of the margin ranking loss is ranking, which aims at ranking the scores of positive coherent dialogues ahead of the negative incoherent ones.\nSupCon Loss. The supervised contrastive (SupCon) loss (Khosla et al., 2020), which pulls the positive anchors closer and pushes the negatives farther away in representation space, can be adopted for the multi-level setting. Here, for our multi-level setting, we consider the dialogues of level-1, level2, and level-3 as positive anchors successively, and the remaining two levels as corresponding negatives.\nFAT Loss. The fast-approximated triplet (FAT) loss (Yuan et al., 2019) replaces the traditional point-to-point distances of the triplet loss with point-to-cluster distances, through an upper bound relaxation of the triplet form, which is first applied for the classification task and obviously reduces the computation cost. To use FAT loss in our evaluation task, we consider the different coherence levels as different classes and perform the FAT loss to separate the context-response pairs with different coherence levels.\n11https://github.com/google-research/ bleurt\nVanilla MLR Loss. The vanilla MLR loss (Lin et al., 2020) is the extension of the margin ranking loss to a multi-level version by repeatedly applying the original margin ranking loss between different levels, which can be directly applied to our evaluation task.\nC Visualizations of the Pre-Training Losses\nWe have already compared the visualization results of the BCE loss and the FAT loss. For a supplement, here we mainly introduce the visualizations of the margin ranking loss, the SupCon loss and the vanilla MLR loss in detail.\nAs we can see in Figure 6, (a) the margin ranking loss cannot separate the level-1 scores from the level-2 ones and the corresponding features are also mixed, which is similar to the BCE loss; (b) the SupCon loss, on the other hand, can distinguish the features and scores of the three levels to some extent, and the scores of different levels are also separated but do not follow the real rank order, i.e., level-1 < level-2 < level-3; (c) the final vanilla MLR loss can separate the context-response pairs with different coherence level in feature space and the predicted scores also follow the actual rank order. However, its score distributions are not compact enough for the level-1 and level-3."
    } ],
    "references" : [ {
      "title" : "METEOR: An automatic metric for MT evaluation with improved correlation with human judgments",
      "author" : [ "Satanjeev Banerjee", "Alon Lavie." ],
      "venue" : "Proceedings of the ACL Workshop on Intrinsic and Extrinsic Evaluation Measures for Machine Transla-",
      "citeRegEx" : "Banerjee and Lavie.,? 2005",
      "shortCiteRegEx" : "Banerjee and Lavie.",
      "year" : 2005
    }, {
      "title" : "Coherence models for dialogue",
      "author" : [ "Alessandra Cervone", "Evgeny Stepanov", "Giuseppe Riccardi." ],
      "venue" : "Proceedings of the 19th Annual Conference of the International Speech Communcation Association, pages 1011–1015.",
      "citeRegEx" : "Cervone et al\\.,? 2018",
      "shortCiteRegEx" : "Cervone et al\\.",
      "year" : 2018
    }, {
      "title" : "Fast and accurate deep network learning by exponential linear units (elus)",
      "author" : [ "Djork-Arné Clevert", "Thomas Unterthiner", "Sepp Hochreiter." ],
      "venue" : "International Conference on Learning Representations.",
      "citeRegEx" : "Clevert et al\\.,? 2016",
      "shortCiteRegEx" : "Clevert et al\\.",
      "year" : 2016
    }, {
      "title" : "BERT: Pre-training of deep bidirectional transformers for language understanding",
      "author" : [ "Jacob Devlin", "Ming-Wei Chang", "Kenton Lee", "Kristina Toutanova." ],
      "venue" : "Proceedings of the 2019 Conference of the North American Chapter of the Association",
      "citeRegEx" : "Devlin et al\\.,? 2019",
      "shortCiteRegEx" : "Devlin et al\\.",
      "year" : 2019
    }, {
      "title" : "The second conversational intelligence challenge (convai2)",
      "author" : [ "Mikhail Burtsev", "Jason Weston." ],
      "venue" : "Computing Research Repository, arXiv:1902.00098. Version 1.",
      "citeRegEx" : "Burtsev and Weston.,? 2019",
      "shortCiteRegEx" : "Burtsev and Weston.",
      "year" : 2019
    }, {
      "title" : "Better automatic evaluation of open-domain dialogue systems with contextualized embeddings",
      "author" : [ "Sarik Ghazarian", "Johnny Wei", "Aram Galstyan", "Nanyun Peng." ],
      "venue" : "Proceedings of the Workshop on Methods for Optimizing and Evaluating Neural Lan-",
      "citeRegEx" : "Ghazarian et al\\.,? 2019",
      "shortCiteRegEx" : "Ghazarian et al\\.",
      "year" : 2019
    }, {
      "title" : "Distilling the knowledge in a neural network",
      "author" : [ "Geoffrey Hinton", "Oriol Vinyals", "Jeff Dean." ],
      "venue" : "Computing Research Repository, arXiv:1503.02531. Version 1.",
      "citeRegEx" : "Hinton et al\\.,? 2015",
      "shortCiteRegEx" : "Hinton et al\\.",
      "year" : 2015
    }, {
      "title" : "GRADE: Automatic graphenhanced coherence metric for evaluating opendomain dialogue systems",
      "author" : [ "Lishan Huang", "Zheng Ye", "Jinghui Qin", "Liang Lin", "Xiaodan Liang." ],
      "venue" : "Proceedings of the 2020 Conference on Empirical Methods in Natural",
      "citeRegEx" : "Huang et al\\.,? 2020",
      "shortCiteRegEx" : "Huang et al\\.",
      "year" : 2020
    }, {
      "title" : "TinyBERT: Distilling BERT for natural language understanding",
      "author" : [ "Xiaoqi Jiao", "Yichun Yin", "Lifeng Shang", "Xin Jiang", "Xiao Chen", "Linlin Li", "Fang Wang", "Qun Liu." ],
      "venue" : "Findings of the Association for Computational Linguistics: EMNLP 2020, pages",
      "citeRegEx" : "Jiao et al\\.,? 2020",
      "shortCiteRegEx" : "Jiao et al\\.",
      "year" : 2020
    }, {
      "title" : "Supervised contrastive learning",
      "author" : [ "Prannay Khosla", "Piotr Teterwak", "Chen Wang", "Aaron Sarna", "Yonglong Tian", "Phillip Isola", "Aaron Maschinot", "Ce Liu", "Dilip Krishnan." ],
      "venue" : "Advances in Neural Information Processing Systems 33: Annual Con-",
      "citeRegEx" : "Khosla et al\\.,? 2020",
      "shortCiteRegEx" : "Khosla et al\\.",
      "year" : 2020
    }, {
      "title" : "Sequencelevel knowledge distillation",
      "author" : [ "Yoon Kim", "Alexander M. Rush." ],
      "venue" : "Proceedings of the 2016 Conference on Empirical Methods in Natural Language Processing, pages 1317–1327, Austin, Texas. Association for Computational Linguistics.",
      "citeRegEx" : "Kim and Rush.,? 2016",
      "shortCiteRegEx" : "Kim and Rush.",
      "year" : 2016
    }, {
      "title" : "ROUGE: A package for automatic evaluation of summaries",
      "author" : [ "Chin-Yew Lin." ],
      "venue" : "Text Summarization Branches Out, pages 74–81, Barcelona, Spain. Association for Computational Linguistics.",
      "citeRegEx" : "Lin.,? 2004",
      "shortCiteRegEx" : "Lin.",
      "year" : 2004
    }, {
      "title" : "The world is not binary: Learning to rank with grayscale data for dialogue response selection",
      "author" : [ "Zibo Lin", "Deng Cai", "Yan Wang", "Xiaojiang Liu", "Haitao Zheng", "Shuming Shi." ],
      "venue" : "Proceedings of the 2020 Conference on Empirical Methods in Natural",
      "citeRegEx" : "Lin et al\\.,? 2020",
      "shortCiteRegEx" : "Lin et al\\.",
      "year" : 2020
    }, {
      "title" : "How NOT to evaluate your dialogue system: An empirical study of unsupervised evaluation metrics for dialogue response generation",
      "author" : [ "Chia-Wei Liu", "Ryan Lowe", "Iulian Serban", "Mike Noseworthy", "Laurent Charlin", "Joelle Pineau." ],
      "venue" : "Proceedings of",
      "citeRegEx" : "Liu et al\\.,? 2016",
      "shortCiteRegEx" : "Liu et al\\.",
      "year" : 2016
    }, {
      "title" : "Towards an automatic Turing test: Learning to evaluate dialogue responses",
      "author" : [ "Ryan Lowe", "Michael Noseworthy", "Iulian Vlad Serban", "Nicolas Angelard-Gontier", "Yoshua Bengio", "Joelle Pineau." ],
      "venue" : "Proceedings of the 55th Annual Meeting of the",
      "citeRegEx" : "Lowe et al\\.,? 2017",
      "shortCiteRegEx" : "Lowe et al\\.",
      "year" : 2017
    }, {
      "title" : "Why we need new evaluation metrics for NLG",
      "author" : [ "Jekaterina Novikova", "Ondřej Dušek", "Amanda Cercas Curry", "Verena Rieser." ],
      "venue" : "Proceedings of the 2017 Conference on Empirical Methods in Natural Language Processing, pages 2241–2252,",
      "citeRegEx" : "Novikova et al\\.,? 2017",
      "shortCiteRegEx" : "Novikova et al\\.",
      "year" : 2017
    }, {
      "title" : "Bleu: a method for automatic evaluation of machine translation",
      "author" : [ "Kishore Papineni", "Salim Roukos", "Todd Ward", "WeiJing Zhu." ],
      "venue" : "Proceedings of the 40th Annual Meeting of the Association for Computational Linguistics, pages 311–318, Philadelphia,",
      "citeRegEx" : "Papineni et al\\.,? 2002",
      "shortCiteRegEx" : "Papineni et al\\.",
      "year" : 2002
    }, {
      "title" : "Towards empathetic opendomain conversation models: A new benchmark and dataset",
      "author" : [ "Hannah Rashkin", "Eric Michael Smith", "Margaret Li", "Y-Lan Boureau." ],
      "venue" : "Proceedings of the 57th Annual Meeting of the Association for Computational Linguis-",
      "citeRegEx" : "Rashkin et al\\.,? 2019",
      "shortCiteRegEx" : "Rashkin et al\\.",
      "year" : 2019
    }, {
      "title" : "Improving dialog evaluation with a multi-reference adversarial dataset and large scale pretraining",
      "author" : [ "Ananya B. Sai", "Akash Kumar Mohankumar", "Siddhartha Arora", "Mitesh M. Khapra" ],
      "venue" : null,
      "citeRegEx" : "Sai et al\\.,? \\Q2020\\E",
      "shortCiteRegEx" : "Sai et al\\.",
      "year" : 2020
    }, {
      "title" : "BLEURT: Learning robust metrics for text generation",
      "author" : [ "Thibault Sellam", "Dipanjan Das", "Ankur Parikh." ],
      "venue" : "Proceedings of the 58th Annual Meeting of the Association for Computational Linguistics, pages 7881–7892, Online. Association for Computa-",
      "citeRegEx" : "Sellam et al\\.,? 2020",
      "shortCiteRegEx" : "Sellam et al\\.",
      "year" : 2020
    }, {
      "title" : "Knowledge base embedding by cooperative knowledge distillation",
      "author" : [ "Raphaël Sourty", "Jose G. Moreno", "François-Paul Servant", "Lynda Tamine-Lechani." ],
      "venue" : "Proceedings of the 28th International Conference on Computational Linguistics, pages 5579–",
      "citeRegEx" : "Sourty et al\\.,? 2020",
      "shortCiteRegEx" : "Sourty et al\\.",
      "year" : 2020
    }, {
      "title" : "Distill and replay for continual language learning",
      "author" : [ "Jingyuan Sun", "Shaonan Wang", "Jiajun Zhang", "Chengqing Zong." ],
      "venue" : "Proceedings of the 28th International Conference on Computational Linguistics, pages 3569–3579, Barcelona, Spain (Online).",
      "citeRegEx" : "Sun et al\\.,? 2020",
      "shortCiteRegEx" : "Sun et al\\.",
      "year" : 2020
    }, {
      "title" : "Ruber: An unsupervised method for automatic evaluation of open-domain dialog systems",
      "author" : [ "Chongyang Tao", "Lili Mou", "Dongyan Zhao", "Rui Yan." ],
      "venue" : "AAAI.",
      "citeRegEx" : "Tao et al\\.,? 2018",
      "shortCiteRegEx" : "Tao et al\\.",
      "year" : 2018
    }, {
      "title" : "Online distilling from checkpoints for neural machine translation",
      "author" : [ "Hao-Ran Wei", "Shujian Huang", "Ran Wang", "Xin-yu Dai", "Jiajun Chen." ],
      "venue" : "Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Lin-",
      "citeRegEx" : "Wei et al\\.,? 2019",
      "shortCiteRegEx" : "Wei et al\\.",
      "year" : 2019
    }, {
      "title" : "In defense of the triplet loss again: Learning robust person re-identification with fast approximated triplet loss and label distillation",
      "author" : [ "Ye Yuan", "Wuyang Chen", "Yang Yang", "Zhangyang Wang." ],
      "venue" : "Computing Research Repository, arXiv:1912.07863.",
      "citeRegEx" : "Yuan et al\\.,? 2019",
      "shortCiteRegEx" : "Yuan et al\\.",
      "year" : 2019
    }, {
      "title" : "Bertscore: Evaluating text generation with bert",
      "author" : [ "Tianyi Zhang", "Varsha Kishore", "Felix Wu", "Kilian Q. Weinberger", "Yoav Artzi." ],
      "venue" : "International Conference on Learning Representations.",
      "citeRegEx" : "Zhang et al\\.,? 2020",
      "shortCiteRegEx" : "Zhang et al\\.",
      "year" : 2020
    }, {
      "title" : "The supervised contrastive (SupCon) loss (Khosla et al., 2020), which pulls the positive anchors closer and pushes the negatives farther away in representation space, can be adopted for the multi-level setting",
      "author" : [ "SupCon Loss" ],
      "venue" : null,
      "citeRegEx" : "Loss.,? \\Q2020\\E",
      "shortCiteRegEx" : "Loss.",
      "year" : 2020
    }, {
      "title" : "The vanilla MLR loss (Lin et al., 2020) is the extension of the margin ranking loss to a multi-level version by repeatedly applying the original margin ranking loss",
      "author" : [ "Vanilla MLR Loss" ],
      "venue" : null,
      "citeRegEx" : "Loss.,? \\Q2020\\E",
      "shortCiteRegEx" : "Loss.",
      "year" : 2020
    } ],
    "referenceMentions" : [ {
      "referenceID" : 16,
      "context" : "The current widely used metrics measure the lexical word-overlap between generated responses and reference responses, such as BLEU (Papineni et al., 2002) and ROUGE (Lin, 2004).",
      "startOffset" : 131,
      "endOffset" : 154
    }, {
      "referenceID" : 13,
      "context" : "However, they have been demonstrated to be biased and correlate poorly with human judgements since no semantic information is considered (Liu et al., 2016; Novikova et al., 2017).",
      "startOffset" : 137,
      "endOffset" : 178
    }, {
      "referenceID" : 15,
      "context" : "However, they have been demonstrated to be biased and correlate poorly with human judgements since no semantic information is considered (Liu et al., 2016; Novikova et al., 2017).",
      "startOffset" : 137,
      "endOffset" : 178
    }, {
      "referenceID" : 5,
      "context" : "2719 2018), BERT-RUBER (Ghazarian et al., 2019) and GRADE (Huang et al.",
      "startOffset" : 23,
      "endOffset" : 47
    }, {
      "referenceID" : 16,
      "context" : "The widely used automatic metrics, such as BLEU (Papineni et al., 2002), METEOR (Banerjee and Lavie, 2005)",
      "startOffset" : 48,
      "endOffset" : 71
    }, {
      "referenceID" : 11,
      "context" : "and ROUGE (Lin, 2004), use statistical rules to measure the degree of lexical word-overlap between generated responses and reference responses.",
      "startOffset" : 10,
      "endOffset" : 21
    }, {
      "referenceID" : 13,
      "context" : "However, these metrics have been demonstrated to correlate poorly with human judgments due to the absence of semantic information (Liu et al., 2016; Novikova et al., 2017).",
      "startOffset" : 130,
      "endOffset" : 171
    }, {
      "referenceID" : 15,
      "context" : "However, these metrics have been demonstrated to correlate poorly with human judgments due to the absence of semantic information (Liu et al., 2016; Novikova et al., 2017).",
      "startOffset" : 130,
      "endOffset" : 171
    }, {
      "referenceID" : 25,
      "context" : "For instance, BERTScore (Zhang et al., 2020) turns to measure the soft semantic word-overlap rather than the hard lexical wordoverlap like BLEU.",
      "startOffset" : 24,
      "endOffset" : 44
    }, {
      "referenceID" : 14,
      "context" : "Moreover, learnable metrics encoding the semantic information have been attracting interests recently, which are trained in a supervised manner with large-scale human-annotated data, such as ADEM (Lowe et al., 2017), or trained in an unsupervised manner with automatically constructed data, such as RUBER (Tao et al.",
      "startOffset" : 196,
      "endOffset" : 215
    }, {
      "referenceID" : 22,
      "context" : ", 2017), or trained in an unsupervised manner with automatically constructed data, such as RUBER (Tao et al., 2018) and BERT-RUBER (Ghazarian et al.",
      "startOffset" : 97,
      "endOffset" : 115
    }, {
      "referenceID" : 7,
      "context" : "Furthermore, the recently proposed coherence metric, GRADE (Huang et al., 2020), introduces the graph information of dialogue topic transitions and achieves the current state-of-the-art results.",
      "startOffset" : 59,
      "endOffset" : 79
    }, {
      "referenceID" : 6,
      "context" : "Knowledge distillation (KD) is a method that transfers the knowledge from a large trained teacher model to a smaller student model by using the soft targets provided by the teacher (Hinton et al., 2015).",
      "startOffset" : 181,
      "endOffset" : 202
    }, {
      "referenceID" : 21,
      "context" : "In recent years, KD has been applied to many specific tasks (Sun et al., 2020; Wei et al., 2019; Kim and Rush, 2016; Sourty et al., 2020).",
      "startOffset" : 60,
      "endOffset" : 137
    }, {
      "referenceID" : 23,
      "context" : "In recent years, KD has been applied to many specific tasks (Sun et al., 2020; Wei et al., 2019; Kim and Rush, 2016; Sourty et al., 2020).",
      "startOffset" : 60,
      "endOffset" : 137
    }, {
      "referenceID" : 10,
      "context" : "In recent years, KD has been applied to many specific tasks (Sun et al., 2020; Wei et al., 2019; Kim and Rush, 2016; Sourty et al., 2020).",
      "startOffset" : 60,
      "endOffset" : 137
    }, {
      "referenceID" : 20,
      "context" : "In recent years, KD has been applied to many specific tasks (Sun et al., 2020; Wei et al., 2019; Kim and Rush, 2016; Sourty et al., 2020).",
      "startOffset" : 60,
      "endOffset" : 137
    }, {
      "referenceID" : 3,
      "context" : "Specifically, we adopt BERT (Devlin et al., 2019) as the encoder network and a multi-layer perceptron (MLP) as the predictor network.",
      "startOffset" : 28,
      "endOffset" : 49
    }, {
      "referenceID" : 2,
      "context" : "where MLP is a three-layer fully-connected network in which the activation functions of the three layers are two exponential linear units (Clevert et al., 2016) and a sigmoid function, respectively.",
      "startOffset" : 138,
      "endOffset" : 160
    }, {
      "referenceID" : 8,
      "context" : "And we adopt the distillation objectives of TinyBERT (Jiao et al., 2020), including the distillations of the embedding layer, the Transformer layers and the prediction layer.",
      "startOffset" : 53,
      "endOffset" : 72
    }, {
      "referenceID" : 16,
      "context" : "We compare the metric model trained by our QuantiDCE with eight popular automatic dialogue metrics, including three lexical word-overlap metrics: BLEU (Papineni et al., 2002), ROUGE (Lin, 2004) and METEOR (Banerjee and Lavie, 2005), one semantic word-overlap metric, BERTScore (Zhang et al.",
      "startOffset" : 151,
      "endOffset" : 174
    }, {
      "referenceID" : 11,
      "context" : ", 2002), ROUGE (Lin, 2004) and METEOR (Banerjee and Lavie, 2005), one semantic word-overlap metric, BERTScore (Zhang et al.",
      "startOffset" : 15,
      "endOffset" : 26
    }, {
      "referenceID" : 0,
      "context" : ", 2002), ROUGE (Lin, 2004) and METEOR (Banerjee and Lavie, 2005), one semantic word-overlap metric, BERTScore (Zhang et al.",
      "startOffset" : 38,
      "endOffset" : 64
    }, {
      "referenceID" : 25,
      "context" : ", 2002), ROUGE (Lin, 2004) and METEOR (Banerjee and Lavie, 2005), one semantic word-overlap metric, BERTScore (Zhang et al., 2020), and four learnable metrics: ADEM (Lowe et al.",
      "startOffset" : 110,
      "endOffset" : 130
    }, {
      "referenceID" : 14,
      "context" : ", 2020), and four learnable metrics: ADEM (Lowe et al., 2017), BERT-RUBER (Ghazarian et al.",
      "startOffset" : 42,
      "endOffset" : 61
    }, {
      "referenceID" : 5,
      "context" : ", 2017), BERT-RUBER (Ghazarian et al., 2019), BLEURT (Sellam et al.",
      "startOffset" : 20,
      "endOffset" : 44
    }, {
      "referenceID" : 19,
      "context" : ", 2019), BLEURT (Sellam et al., 2020) and GRADE (Huang et al.",
      "startOffset" : 16,
      "endOffset" : 37
    }, {
      "referenceID" : 7,
      "context" : "Specifically, we adopt Pearson, Spearman and Kendall as the correlation measures and a large-scale human judgement benchmark (Huang et al., 2020) to provide the human-rated scores.",
      "startOffset" : 125,
      "endOffset" : 145
    }, {
      "referenceID" : 17,
      "context" : ", 2019) and EmpatheticDialogues (Rashkin et al., 2019), and the responses were produced by both the retrieval-based dialogue models and the generation-based ones to assure response diversity.",
      "startOffset" : 32,
      "endOffset" : 54
    }, {
      "referenceID" : 18,
      "context" : "The DailyDialog++ dataset (Sai et al., 2020) contains over 11K conversations, which augments",
      "startOffset" : 26,
      "endOffset" : 44
    }, {
      "referenceID" : 7,
      "context" : "As to the fine-tuning data, we use the DailyDialog human judgement dataset, denoted as DailyDialogEVAL, which is a subset of the adopted evaluation benchmark (Huang et al., 2020), with 300 human rating data in total, and randomly split the data into training (90%) and validation (10%) sets.",
      "startOffset" : 158,
      "endOffset" : 178
    }, {
      "referenceID" : 9,
      "context" : "ranking loss are adopted for the two-level setting, while another three loss functions are adopted for the multi-level setting, including the supervised contrastive (SupCon) loss (Khosla et al., 2020), the fast-approximated triplet (FAT) loss (Yuan et al.",
      "startOffset" : 179,
      "endOffset" : 200
    }, {
      "referenceID" : 24,
      "context" : ", 2020), the fast-approximated triplet (FAT) loss (Yuan et al., 2019) and the vanilla MLR loss (Lin et al.",
      "startOffset" : 50,
      "endOffset" : 69
    }, {
      "referenceID" : 12,
      "context" : ", 2019) and the vanilla MLR loss (Lin et al., 2020) 8.",
      "startOffset" : 33,
      "endOffset" : 51
    } ],
    "year" : 2021,
    "abstractText" : "Automatic dialogue coherence evaluation has attracted increasing attention and is crucial for developing promising dialogue systems. However, existing metrics have two major limitations: (a) they are mostly trained in a simplified two-level setting (coherent vs. incoherent), while humans give Likert-type multi-level coherence scores, dubbed as “quantifiable”; (b) their predicted coherence scores cannot align with the actual human rating standards due to the absence of human guidance during training. To address these limitations, we propose Quantifiable Dialogue Coherence Evaluation (QuantiDCE), a novel framework aiming to train a quantifiable dialogue coherence metric that can reflect the actual human rating standards. Specifically, QuantiDCE includes two training stages, Multi-Level Ranking (MLR) pre-training and Knowledge Distillation (KD) fine-tuning. During MLR pre-training, a new MLR loss is proposed for enabling the model to learn the coarse judgement of coherence degrees. Then, during KD fine-tuning, the pretrained model is further finetuned to learn the actual human rating standards with only very few human-annotated data. To advocate the generalizability even with limited finetuning data, a novel KD regularization is introduced to retain the knowledge learned at the pre-training stage. Experimental results show that the model trained by QuantiDCE presents stronger correlations with human judgements than the other state-of-the-art metrics. 1",
    "creator" : "LaTeX with hyperref"
  }
}