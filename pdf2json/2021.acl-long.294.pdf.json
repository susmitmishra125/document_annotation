{
  "name" : "2021.acl-long.294.pdf",
  "metadata" : {
    "source" : "META",
    "title" : "H-Transformer-1D: Fast One-Dimensional Hierarchical Attention for Sequences",
    "authors" : [ "Zhenhai Zhu", "Radu Soricut" ],
    "emails" : [ "zhenhai@google.com", "rsoricut@google.com" ],
    "sections" : [ {
      "heading" : null,
      "text" : "Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing, pages 3801–3815\nAugust 1–6, 2021. ©2021 Association for Computational Linguistics\n3801"
    }, {
      "heading" : "1 Introduction",
      "text" : "Linearly combining information using contentbased weights, a method generically known as attention, is a key building block in many deep neural networks such as recurrent neural networks (RNN) (Luong et al., 2015), convolutional neural networks (CNN) (Bello et al., 2019) and graph convolutional networks (GCN) (Velickovic et al., 2018). One particular type of such attention, called multi-head scaled dot-product attention, is one of the main components of the Transformer architecture proposed by Vaswani et al. (2017), which has been shown to push the state-of-theart (SOTA) performance for various understanding and generation tasks. These include standard natural language processing (NLP) tasks such as machine translation, document classification, entailment, summarization and question answering (Zaheer et al., 2020; Dai et al., 2019; Baevski and Auli, 2019), as well as music generation (Huang\net al., 2018), image generation (Parmar et al., 2018; Chen et al., 2020) and genomics (Zaheer et al., 2020; Choromanski et al., 2020). The Transformer is also the backbone architecture for models such as BERT (Devlin et al., 2019) (and its numerous relatives) and GPT3 (Brown et al., 2020), which have delivered impressive performance across many NLP tasks. However, the standard attention mechanism of the Transformer has a run time and memory usage that scales quadratically with sequence length. Therefore, this quadratic complexity has become a critical bottleneck in processing long sequences (over 1,000 tokens), and has since motivated many new attention algorithms, see (Tay et al., 2020d) for a survey of such work.\nIn this paper, we draw inspiration from two branches in numerical analysis: Hierarchical Matrix (H-Matrix) (Hackbusch, 1999, 2000) and Multigrid method (Briggs et al., 2000). We propose a hierarchical attention that has linear complexity in run time and memory, and only utilizes dense linear algebra operations optimized for GPUs or TPUs.\nWe hypothesize that the inductive bias embodied by the proposed hierarchical structure for the attention matrix is effective in capturing the hierarchical structure in the sequences typically seen in many natural language processing and computer vision tasks. The main benchmark we use in this paper is the Long Range Arena (LRA) benchmark (Tay et al., 2020c), which has been specifically designed to evaluate and compare various sub-quadratic attention algorithms. Our new hierarchical attention mechanism achieves best average performance to-date on the LRA benchmark by more than 6 points over the previous-best BigBird algorithm (Zaheer et al., 2020), while pushing SOTA performance higher in 4 of the 5 successful tasks. Furthermore, using this new atten-\ntion, a Transformer-based language model trained on the One-Billion Word dataset (Chelba et al., 2014) sets a new SOTA performance record by reducing the test perplexity by 1.55 points comparing to the previous-best Transformer-XL (Dai et al., 2019) with 5x more parameters. Overall, these empirical results both validate the soundness of our approximation method for computing attention weights, as well as the the appropriateness of the inductive bias present in the proposed hierarchical attention."
    }, {
      "heading" : "2 Related Works",
      "text" : "It is well established in the NLP literature that the embeddings of nearby tokens tend to be more similar than the distant ones (Manning and Schütze, 1999). This leads to the intuition that token similarity and hence the attention should decrease with the sequence distance between a query token and a key token1. This motivates the sliding-window local attention (Parmar et al., 2018; Ramachandran et al., 2019; Qiu et al., 2019) which amounts to truncating off-diagonal entries in the attention matrix beyond a user-specified sequence distance. A second approach is to keepO(1) number of nonzeros per row in the attention matrix. The nonzero entry selection is either content-based (Kitaev et al., 2020; Roy et al., 2020; Tay et al., 2020b; Zhou et al., 2020), hand-crafted (Beltagy et al., 2020; Brown et al., 2020; Child et al., 2019; Ho et al., 2019) or simply random (Zaheer et al., 2020). It is also well known in the NLP literature that long-range contextual information is necessary for many NLP tasks (Khandelwal et al., 2018; Liu and Lapata, 2019). So a set of global tokens are also considered. This adds O(1) number of dense rows and columns to the attention matrix (Zaheer et al., 2020; Ainslie et al., 2020; Beltagy et al., 2020). A third approach is to approximate the attention matrix with a low-rank factored form (Choromanski et al., 2020; Wang et al., 2020; Tay et al., 2020a).\nThe first two approaches are based on the premise that one needs to explicitly zero out entries in the attention matrix in order to reduce the quadratic complexity. Decades of research by the scientific computing and numerical analysis community has resulted in more sophisticated algorithms to sparsify matrices. A\n1Eq. (11) and (12) offer a simple illustration of this intuition.\nsmall set of samples of these algorithms and their engineering applications include Fast Multipole Method (Greengard and Rokhlin, 1987; Greengard, 1994; Nabors et al., 1994; Shi et al., 1998), Pre-corrected FFT (Phillips and White, 1997; Zhu et al., 2005), Hierarchical Singular Value Decomposition (SVD) (Kapur and Long, 1997) and Hierarchical Matrix (H-Matrix) (Hackbusch, 1999, 2000; Zhu and White, 2005). These are generally called Multilevel Methods (Brandt and Lubrecht, 1990). The hierarchical attention proposed in this paper is inspired by these Multilevel Methods in general and the H-Matrix in particular. The hierarchical matrix structure allows a linear complexity in both constructing and applying the attention matrix."
    }, {
      "heading" : "3 Definition and Notation",
      "text" : "Given matrices Q, K and V , with rows representing sequences of token embedding or feature vectors for query, key and value respectively, the output weighted by the scaled dot-product attention in the Transformer (Vaswani et al., 2017) is defined as\nZ = softmax( QKT√\nd )V (1)\nwhere Z,Q,K, V ∈ RL×d, L is the length of the sequences, and d is the embedding or feature size. In a more compact matrix form, Eq. (1) can be written as\nZ = D−1AV (2)\nwhere\nA = eS (3)\nSi,j = QiK T j√ d\n(4)\nD = diag{A · 1L} (5) 1L = [1, 1, ..., 1] T . (6)\nHere, A,S ∈ RL×L, 1L ∈ RL is a vector with all ones, and Si,j represents the unnormalized cosine similarity between query embedding Qi (the i-th row in Q) and key embedding Kj (the j-th row in K).\nFor the sake of clarity, we focus on the singlehead attention in the exposition of the proposed algorithm. Extension to the multi-head case is straightforward since each attention head is computed independently (Vaswani et al., 2017).\nComputing the similarity matrix S in Eq. (4) and the attention matrixA in Eq. (3) takesO(L2d) time and O(L2) memory. Similarly, computing AV in Eq. (2) takes O(L2d) time, and computing A · 1L in Eq. (5) takes O(L2) time. The O(L2d) andO(L2) complexities are the bottlenecks for applying the attention mechanism over very long sequences."
    }, {
      "heading" : "4 Introduction on H-Matrix and Multigrid Method",
      "text" : ""
    }, {
      "heading" : "4.1 H-Matrix",
      "text" : "The singular-value decomposition of the attention matrix A in Eq. (3) is\nA = UΣV T (7)\nwhere Σ = diag{σ1, σ2, ..., σL} and σi is the i-th singular value. The numerical rank of matrix A is r if ∑L i=r+1 σi < for a given tolerance (Trefethen and Bau, 1997). The standard rank-r approximation to matrix A is\nA ≈ Û Σ̂V̂ T = Û Ṽ T (8)\nwhere Σ̂ = diag{σ1, σ2, ..., σr}, Û , V̂ ∈ RL×r have the first r columns of U and V , and Ṽ = V̂ Σ̂. This is the low-rank approximation used in (Choromanski et al., 2020; Wang et al., 2020; Tay et al., 2020a). This approximation compresses L2 entries inA to 2rL entries in Û and Ṽ T . So the compression rate is L2r .\nThe H-Matrix generalizes this low-rank approximation by using matrix block hierarchy. Consider a two-level H-Matrix with 4 × 4 and 2 × 2 block partition at level-0 and level-1, respectively. Matrix A is partitioned as\nA =  A (0) 11 A (0) 12 A (0) 21 A (0) 22\nA (1) 12\nA (1) 21\nA (0) 33 A (0) 34 A (0) 43 A (0) 44  . (9) The low-rank approximation in Eq. (8) is applied to the off-diagonal blocks at each level. For example,\nA (l) 12 ≈ Û (l) 12 Ṽ (l) 12 T (10)\nwhere l = 0, 1. To give a concrete example, suppose each entry in matrixA has the analytical form\nAi,j = e Si,j (11)\nSi,j = 2e −(i−j)2 − 1 (12)\nwhere i, j = 0, 1, 2, ..., 15 2. With the block hierarchy defined in Eq. (9), the size of the matrix block at level-1 and level-0 is 8× 8 and 4× 4, respectively. For tolerance = 10−3, one can verify that the numerical rank map of matrix A is 4 2 2 4 2\n2 4 2\n2 4  (13) where the number in each block is the numerical rank of the corresponding block in Eq. (9). Note that matrix A still has full numerical rank of 16 at a looser tolerance 10−1. So the standard lowrank approximation is ineffective in this case. But even this simple two-level H-matrix already offers a compression rate of 43 since storing an H-matrix with the rank map in Eq. (13) takes 192 entries 3. In addition, one can verify that no entry Ai,j in Eq. (11) is very small, since Si,j ∈ [−1, 1] in Eq. (12). Therefore, truncating off-diagonal entries of matrix A, as proposed in (Parmar et al., 2018), would produce a poor approximation. In practice, the number of levels is adapted to the underlining governing equations that result in matrix A and it can easily be over 10 (Kapur and Long, 1997; Hackbusch, 2000; Zhu and White, 2005). In turn, this can substantially increase the compression rate. In general, the computation complexity of the H-Matrix is either O(L) or O(L logL), depending on the underlining physics (Hackbusch, 1999, 2000)."
    }, {
      "heading" : "4.2 Elements of the Multigrid Method",
      "text" : "Multigrid Method is a multi-level nested iterative method for solving large-scale sparse matrices resulting from discretized partial-differential equations (PDEs) (Briggs et al., 2000; Trottenberg et al., 2000). At its core are two simple but powerfully complementary ideas: relaxation and correction. Our proposed hierarchical attention only uses the correction scheme as a building block since there is no sparse matrix to relax on.\nThe correction scheme has two components: restriction or coarsening, and interpolation or pro-\n2Matrix A in Eq.(11) is a symmetric Toeplitz matrix (Golub and Loan, 1996) and hence only has 16 unique entries. But we ignore this fact and treat A as a general matrix here.\n3Each one of four diagonal blocks at level-0 takes 16 entries. Each one of four off-diagonal blocks at level-0 takes 16 entries. Each one of two off-diagonal blocks at level-1 takes 32 entries.\nlongation. Consider a vector v̄h of scalar values defined on a set of N grids with uniform interval h. The simplest coarsening is to take the average of the scalar values on each pair of grids, i.e.,\nv̄2hj = 1\n2 (v̄h2j + v̄ h 2j+1) (14)\nwhere j = 0, 1, 2, ...N/2 − 1. The superscript in Eq. (14) indicates that the grid interval at these two levels is h and 2h, respectively. The simplest interpolation is to duplicate the value on each coarse grid to values on a pair of fine grids, i.e.,\nv̄h2j = v̄ 2h j , v̄ h 2j+1 = v̄ 2h j (15)\nwhere j = 0, 1, 2, ...N/2− 1."
    }, {
      "heading" : "5 Intuition for Hierarchical Attention",
      "text" : "The hierarchical low-rank structure like Eq. (13) turns out to be pervasive in many if not all physics phenomena. Much of the theoretical analysis by (Greengard and Rokhlin, 1987; Hackbusch, 1999) is concerned with quantifying such aspects. The key insight into these Multilevel Methods can be summarized as follows: perform no approximation for near interactions, and apply progressively lower-precision approximation for progressively longer distance interactions. The simple case shown in Eq. (9)-(13) is a good example. To satisfy the tolerance of 10−3, we need full rank (no approximation) for the diagonal blocks (near interactions), higher precision approximation (rank-2 vs full-rank of 4) for the 4× 4 off-diagonal blocks at level-0 (mid-distance) and lower precision approximation (rank-2 vs full-rank of 8) for the 8×8 off-diagonal blocks at level-1 (long-distance).\nIn this section, we present some intuition to answer two important questions: 1) Does the hierarchical low-rank structure hold for the attention matrixA in Eq. (3)? 2) What is the algorithm to efficiently compute the hierarchical low-rank structure? We only give an informal exposition of the hierarchical attention. The formal mathematical derivation is deferred to the Appendix."
    }, {
      "heading" : "5.1 Hierarchical Structure As Inductive Bias",
      "text" : "The error analysis in (Greengard and Rokhlin, 1987; Hackbusch, 1999) offers little direct insight since the attention matrix A in Eq. (3) is data dependent by definition and hence its analytical form like Eq. (11) and (12) is generally unknown. So\ngathering empirical evidences seems the only viable path to answer the first question listed above.\nThe ablation studies by (Khandelwal et al., 2018) examine the effect of context words on a language model. Within the context range of about 200 tokens, word order is only relevant within the 20 most recent tokens or about a sentence. In the long-range context, order has almost no effect on performance, suggesting that the model maintains a high-level, rough semantic representation of faraway words. The observation is succinctly summarized by the title of the paper ”sharp nearby, fuzzy far away”. Remarkably, this is in spirit very close to the key insight into the Multilevel Methods.\nA few recent attention-related studies have explored this direction with some success, such as word-level and sentence-level attentions in (Miculicich et al., 2018; Abreu et al., 2019), and sentence-level and paragraph-level attentions in (Liu and Lapata, 2019). Even though the proposed hierarchical attention in these studies only has two levels, as opposed to ten or more levels typically used by the Multilevel Methods, the reported positive results are quite suggestive.\nWe therefore hypothesize that the same hierarchical low-rank structure as shown in Eq (13) might also hold for the attention matrix in many NLP tasks. And we treat it as the inductive bias in the hierarchical attention mechanism proposed in this paper. As pointed out in (Goyal and Bengio, 2020), inductive biases encourage the learning algorithm to prioritise solutions with certain properties. Hence good benchmark performance delivered by a Transformer-based model with proposed hierarchical attention can be regarded as a positive evidence to support the hierarchical low-rank structure hypothesis."
    }, {
      "heading" : "5.2 Informal Exposition of Hierarchical Attention",
      "text" : "In the standard definition of attention in Eq. (3) and (4), there is no preference given to any keys based on the sequence distance between a query and keys. The observation in (Khandelwal et al., 2018) clearly suggests that a distance-dependent attention mechanism should be a better alternative.\nWe will take three steps to informally explain the hierarchical attention mechanism. First, the attention matrix blocks for nearby, mid-distance and long-distance attention are separated in sec-\ntion 5.2.1. This is the first step toward the distance-dependent attention mentioned above. Second, a token hierarchy is established in section 5.2.2. Third, the hierarchical attention is constructed in section 5.2.3"
    }, {
      "heading" : "5.2.1 Attention Partition",
      "text" : "Consider a 16-word sentence in Fig. 1. The sentence is partitioned at three segment granularity. This induces a three-level partition of the attention matrix A for the original sequence:\nA = A(2) +A(1) +A(0) (16)\nwhere\nA(2) =\n[ 0 A\n(2) 12\nA (2) 21 0\n] (17)\nA(1) =  A (1) 12 A (1) 21 A (1) 23 A (1) 32 A (1) 34\nA (1) 43\n (18)\nA(0) =  A (0) 11 A (0) 12 A (0) 21 A (0) 22 A (0) 23 . . . . . . . . .\nA (0) 87 A (0) 88  . (19)\nNote that the nonzero entries in A(0), A(1) and A(2) are the same as the corresponding entries of matrix A in Eq. (3). Matrix block size of A(0)ij , A (1) ij andA (2) ij is 2×2, 4×4 and 8×8, respectively. Following the key insight into Multilevel Methods, we perform no approximation to any level-0 matrix block A(0)ij and apply a low-rank approximation to off-diagonal matrix blocks in A(1) and A(2). If we set the numerical rank of all these blocks to 2, then we can assemble the three rank maps into a single rank map as 4 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n2 2 2\n2 2\n . (20)\n4We omit some of implementation details to handle the overlapping entries between adjacent levels.\nThe hierarchical structure embodied by the predetermined rank map in Eq. (20) represents the inductive bias for the attention matrix A in Eq. (16). But this construction step is inefficient because we need to form the original attention matrix and then perform SVD to discover the low-rank approximation."
    }, {
      "heading" : "5.2.2 Token Hierarchy",
      "text" : "To illustrate the notion of token hierarchy, consider the same 16-word sentence in Fig. 2. A simple 3-level binary-tree hierarchy can be set up by following the simple coarsening defined in Eq. (14): 1) At level-0, each one of the 16 words is mapped to its word embedding; 2) At level-1, each token (parent node) corresponds to a pair of adjacent words at level-0 (child nodes), which are shown inside each box. The embedding of each parent token is simply the average of its child token embeddings; 3) At level-2, each token (parent node) corresponds to one pair of adjacent tokens at level-1 (child nodes) or 4 adjacent words at level-0 (grand child nodes), which are shown inside each box. The embedding of each parent token is simply the average of its child token embeddings.\nIn general, the height of the binary tree is O(log2(L) and the total number of tree nodes is O(2L), where L is the sequence length. We only need word embeddings for the leaf nodes since the embeddings of all other tree nodes can be recursively computed. The formal definition and notations of the recursion for query and key are detailed in section 6.1."
    }, {
      "heading" : "5.2.3 Informal Construction of Hierarchical Attention",
      "text" : "It is clear from Fig. 2 that the embeddings of higher level tokens represent a coarser level representation of a larger chunk of the text. The tokens at different levels can be understood as multi-scale snapshots of the original token sequence at level-0.\nHence this token hierarchy naturally induces a set of multi-scale attention matrices. Let Ã(i) be the attention matrix induced by the tokens at level-i. It is clear from Fig. 2 that the size of Ã(0), Ã(1) and Ã(2) is 16×16, 8×8 and 4×4, respectively. This multi-scale viewpoint does not directly lead to a useful algorithm since matrix Ã(0) contains all the information and there is little additional information from Ã(1) and Ã(2).\nA key step to arrive at the hierarchical attention is to apply the contextual sliding window at each hierarchy level. The tokens at each level are partitioned into segments of size 2 in Fig. 2. One way to implement the local attention is to allow each query token segment to attend only two adjacent key token segments, one to its left and another to its right. At level-0, each query token segment also attends to the collocated key token segment. The token segment partition and local attention lead to a tri-diagonal block sparse matrix structure for Ã(0) and bi-diagonal block sparse matrix structure for Ã(1) and Ã(2). Their sparsity patterns are\nÃ(0) ∝  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n2 2 2\n2 2\n (21)\nÃ(1) ∝  2 2 2\n2 2\n2  (22) Ã(2) ∝ [ 2\n2\n] (23)\nwhere the 2 in the nonzero blocks indicates that these are dense blocks of size 2× 2.\nIt is clear that Ã(0) is identical to A(0) in Eq. (19). The efficiency gain comes from Ã(2) and Ã(1). Each nonzero entry in Ã(2) and Ã(1) captures the aggregated or coarse attention between two disjoint chunk of four and two tokens, respectively. Progressively larger token chunks lead to progressively lower-precision approximation to the original attention blocks. This is precisely the intention of the rank map in Eq. (20). We can now see that Ã(2) and Ã(1) provide an efficient way to approximate A(2) in Eq. (17) and A(1) in Eq. (18), respectively."
    }, {
      "heading" : "6 Key Components in Hierarchical Attention",
      "text" : ""
    }, {
      "heading" : "6.1 Constructing Hierarchical Attention",
      "text" : "The simple example in Fig. 2 can be easily generalized. Eq. (14) is used to coarsen or merge rows in matrices Q, K and V in Eq. (1). For sequence length L = 2M+1, the coarsening establishes a binary tree of depth M for Q, K and V , respectively. Each tree node represents a matrix row and there are 2M+1−l nodes or rows at level-l. To facilitate the discussion, we define a few hierarchy related notations here. Let Q̃(l), K̃(l) and Ṽ (l) be coarsened versions of Q, K and V at level-l in the binary tree. We note that l = 0 is a special case, which is defined as\nQ̃(0) = Q, K̃(0) = K, Ṽ (0) = V. (24)\nFollowing Eq. (14), the recursion to coarsen Q, K and V is:\nQ̃ (l+1) j =\n1 2 (Q̃ (l) 2j + Q̃ (l) 2j+1) (25)\nK̃ (l+1) j =\n1 2 (K̃ (l) 2j + K̃ (l) 2j+1) (26)\nṼ (l+1) j = (Ṽ (l) 2j + Ṽ (l) 2j+1) (27)\nwhere l = 0, 1, ...,M − 2 and j = 0, 1, 2, ..., 2M−l. It should be noted that the coarsening of V in Eq. (27) does not have the averaging factor 12 . We defer more details on coarsening to Appendix Section A.1.\nNow we are ready to compute the nonzero entries in Eq. (21), (22) and (23) and construct hierarchical attention matrix Ã(l). Substituting Eq. (25) and (26) into (4) and then into (3), we obtain\nÃ (l) ij = e\nS̃ (l) ij = e\nQ̃ (l) i (K̃ (l) j )T\n√ d (28)\nAgain, we note that l = 0 is a special case because Ã\n(0) ij = Aij ."
    }, {
      "heading" : "6.2 Applying Hierarchical Attention",
      "text" : "The hierarchical matrix structure in Eq. (17), (18) and (19) naturally leads to a hierarchical approach to the matrix-matrix multiplication in Eq. (2) and the matrix-vector multiplication in Eq. (5). We use the matrix-matrix multiplication as an example since matrix-vector multiplication is just a special case of the matrix-matrix multiplication.\nIn view of Eq. (17), (18) and (19), we write the matrix-matrix multiplication in Eq. (2) as\nY = AV ≈ A(0)V (0) + Ã(1)Ṽ (1) + Ã(2)Ṽ (2) = Y (0) + P (0) ( Ỹ (1) + P (1)Ỹ (2) ) (29)\nwhere Ỹ (l) = Ã(l)Ṽ (l), l = 1, 2 (30)\nWe defer the detailed derivation of Eq. (29) to Appendix Section A.5 and A.6."
    }, {
      "heading" : "7 Algorithm And Computational Complexity",
      "text" : "To facilitate the description and the complexity analysis of the algorithm, we define a few more hierarchy-related notations. In addition to sequence length L, number of hierarchy levels M and embedding or feature size d in Eq. (1), the new notations include: 1) Nr : numerical rank of the off-diagonal blocks (for instance, 2 in Eq. (20)). This is also the diagonal block size at level-0; 2) N\n(l) b : number of blocks at level-l. Note that L and d are usually data-dependent hyper-parameters, while Nr is the only model hyper-parameter responsible for our method’s inductive bias. In turn, N\n(l) b and M are derived parameters, computed as:\nN (0) b =\nL\nNr , N\n(l+1) b =\nN (l) b\n2 (31)\nM = log2(N (0) b ). (32)\nIt is easy to verify that\nM−1∑ l=0 N (l) b = M−1∑ l=0 N (0) b 2l ≈ 2N (0)b . (33)\nIt is important to note that only the diagonal blocks at level-0 and the super-diagonal and subdiagonal blocks at level-l are needed in applying the hierarchical attention matrix. This is clearly\nshown in Eq. (21)- (23). This means that only N\n(l) b − 1 super-diagonal and sub-diagonal blocks are computed at level-l. This is crucial to the overall linear complexity in run time and memory.\nWe should also note that all matrix blocks in coarse attention matrix Ã(l) have the same size Nr ×Nr. This is due to the rank map in Eq. (20). This is crucial for efficiency reason since the single-instruction-multiple-data (SIMD) programming style supported by the dense linear algebra libraries for GPU and TPU encourages uniform tensor shapes.\nWe summarize the main steps to construct and apply the hierarchical attention in Algorithm 1.\nAlgorithm 1 H-Transformer-1D Input: Q(query), K(key), V (value) Output: Z\nCoarsen Q using Eq. (25) and coarsen K using Eq. (26) Compute diagonal blocks in Ã(0) and superdiagonal and sub-diagonal blocks in Ã(l) using Eq. (28) Coarsen V using Eq. (27) Compute Y = AV in Eq. (2) using Eq. (29) Compute D in Eq. (5) using Eq. (29) Compute Z = D−1Y\nThe computational cost for Algorithm 1 has two parts:\n1. Computing the hierarchical attention matrix:\n(a) diagonal blocks at level-0: dN2rN (0) b (b) Super- and sub-diagonal blocks at levell: 4dN2r (N (l) b − 1) (c) total: 5dLNr = O(dL)\n2. Computing matrix-matrix (MM) multiplication in Eq. (2) and matrix-vector (MV) multiplication in Eq. (5):\n(a) MM: 5dLNr (b) MV: 5LNr (c) total: 5(d+ 1)LNr = O(dL)\nSo the overall run time complexity of the hierarchical attention algorithm is O(dL). Likewise, the memory complexity can be shown to be O(dL) as well. We defer the detailed analysis to appendix Section A.5 and A.6."
    }, {
      "heading" : "8 Experiments And Results",
      "text" : "We have implemented the proposed hierarchical attention using Jax, an open source library 5 for automatic gradient computation and linear algebra operations on GPUs and TPUs. All numerical operations in our algorithm use the Numpy native linear algebra functions supported by Jax. In all our experiments in this section, we use the standard Transformer architecture described in (Vaswani et al., 2017) as the backbone for our HTransformer-1D model. Unless specified otherwise, the model parameters are: number of layers is 6, number of heads is 8, word embedding size is 512 and the feed-forward module (FFN) size is 2048. We follow the API for the standard multihead scaled dot-product attention implementation 6 so that we can perform a simple drop-in replacement of the standard multihead attention with our hierarchical attention implementation. This allows for an easy and fair comparison."
    }, {
      "heading" : "8.1 Long-Range Arena",
      "text" : "The open-source Long-Range Arena (LRA) benchmark 7 has been proposed as a standard way to probe and quantify the capabilities of various xformer (long-range Transformer) architectures (Tay et al., 2020c). In our case, it also serves to highlight the effectiveness of the inductive bias\n5https://github.com/google/jax 6https://github.com/google/flax/blob/master/flax/nn 7https://github.com/google-research/long-range-arena\ninspired by the H-Matrix method, as well as the capability of our hierarchical attention to handle long sequences.\nThe LRA has several desirable qualities that made us focus on it as a primary evaluation benchmark: generality (restricted to encoder-only tasks to accommodate most proposals); simplicity (no pretraining, no data augmentation allowed); difficulty (large headroom with existing approaches); long-input focus (so that modeling improvements in this area are visible); diverse (6 tasks, covering math, language, image, and spatial modeling); and lightweight (so that modeling improvements are measurable independently of the ability to train and run high-capacity models).\nThe tasks that comprise LRA are: ListOps (sequences of arithmetical expressions of lengths of up to 2K that tests the ability to reason hierarchically while handling long context); Text (byte/character-level text classification at document level, which both simulates longer input sequences – max length 4K – and increases the difficulty level); Retrieval (byte/character-level document retrieval, which simulates the ability to model document similarity as a score between two independently-encoded long input sequences – max length 4K + 4K = 8K); Image (image classification based on the CIFAR-10 dataset, where an NxN image is flattened to a sequence of length N2 pixels); Pathfinder (long-range spatial dependency task, with images consisting of two small\ncircles and dash-line paths that either connect the two circles or not – image dimensions of 32x32 for a pixel sequence of length 1,024); Path-X (same as Pathfinder, but for image dimensions of 128x128 for a total pixel sequence of length 16,384). The default Transformer model parameters such as number of layers and number of heads etc are pre-determined by the benchmark configuration for each task.\nThe results obtained by our H-Transformer-1D model on the LRA benchmark are given in Table 1. Overall, the H-Transformer-1D model achieves 61.41 average accuracy, a +6.4 points improvement over the previous-best average performance from BigBird (Zaheer et al., 2020). We want to highlight ListOps, Text and Retrieval because they all involve long sequences and H-Transformer-1D model improves SOTA performance by relatively large margins. These should be strong evidences to support our hypothesis in section 5.1 and validate the inductive bias due to the hierarchical attention."
    }, {
      "heading" : "8.2 Language Models Trained on One-Billion Words",
      "text" : "We have used Flax, an open-source library 8 to train neural networks, as the code base for the model training. Our H-Transformer-1D model uses the standard Transformer decoder implementation in Flax as the backbone. Only the attention is replaced with our hierarchical attention. We trained both the Transformer baseline and HTransformer-1D on the One-Billion Word benchmark (Chelba et al., 2014). We tried different Nr\n8https://github.com/google/flax\n(numerical rank) in our H-Transformer-1D model. These represent different inductive bias. We found that H-Transformer-1D with Nr = 16 generated text with quality comparable to that of the baseline Transformer. For both Transformer baseline and H-Transformer-1D, we also tried two sets of model parameters: 1) embedding size is 512 and feed-forward module size is 2048 and hence the parameter count is 53M; 2) embedding size is 1024 and feed-forward module size is 4096 and hence the parameter count is 144M. The test perplexity results of these four models and various SOTA models are shown in table 2.\nH-Transformer-1D delivers the lowest perplexity to-date while using 5× smaller model capacity than that of the previous SOTA model Transformer-XL (Dai et al., 2019). This is another strong evidence to support our hypothesis in section 5.1 and validate the inductive bias due to the hierarchical attention."
    }, {
      "heading" : "9 Conclusions and Future Work",
      "text" : "We have proposed a new Transformer attention using the inductive bias inspired by the HMatrix. The new algorithm has linear complexity in run time and memory usage and is fully compatible with dense linear algebra libraries on GPU and TPU. The effectiveness of this new attention is demonstrated by the empirical evidences from long-range arena benchmark and One-Billion word language modeling. Future work include applying the new attention to music and genomics, developing proper inductive bias for cross-attention and extending the onedimensional hierarchical attention to 2D images."
    }, {
      "heading" : "A Appendix",
      "text" : "A.1 Restriction or Coarsening Matrices\nFor sequence length L = 2M , the coarsening establishes a binary tree of depthM forQ,K and V , respectively. The root of the binary tree at level(M − 1) has two nodes which correspond to the two matrix rows coarsened from four matrix rows at level-(M − 2). The piecewise constant restriction matrix at level-(M − 2) is\nR(M−2) = [ 1 1 0 0 0 0 1 1 ] 2×4 . (34)\nLikewise, the piecewise constant restriction matrix at level-(M − 3) is\nR(M−3) =  1 1 0 0 0 0 0 0 0 0 1 1 0 0 0 0\n0 0 0 0 1 1 0 0 0 0 0 0 0 0 1 1  4×8\n=\n[ R(M−2) 0\n0 R(M−2)\n] . (35)\nIn general, the restriction matrices follow the recursion\nR(l−1) =\n[ R(l) 0\n0 R(l)\n] (36)\nwhich starts from R(M−2) of size 2 × 4 and goes backward to R(0) of size L2 × L.\nA.2 Interpolation Matrices\nGiven Y (l) at level-l, the interpolated Y (l−1) at level-(l − 1) can be written as\nY (l−1) = P (l)Y (l) (37)\nwhere l = 1, 2, ...,M − 1, sparse matrix P (l) has size L(l−1) × L(l), and L(l) = 2M−l is the node count at level-l of the binary tree.\nThis recursion also follows the binary tree hierarchy. The four matrix rows at level-(M − 2) are interpolated from the two matrix rows at level(M − 1). Specifically, the piecewise constant interpolation matrix at level-(M − 1) is\nP (M−1) =  1 0 1 0 0 1 0 1  4×2 . (38)\nLikewise, the piecewise constant interpolation matrix at level-(M − 2) is\nP (M−2) =  1 0 0 0 1 0 0 0 0 1 0 0 0 1 0 0\n0 0 1 0 0 0 1 0 0 0 0 1 0 0 0 1  8×4\n=\n[ P (M−1) 0\n0 P (M−1)\n] . (39)\nIn general, the interpolation matrices follow the recursion\nP (l−1) =\n[ P (l) 0\n0 P (l)\n] (40)\nwhich starts from P (M−1) of size 4 × 2 and goes backward to P (0) of sizeL×L2 . In view of Eq. (34) and (38), it is obvious that\nP (M−1) = (R(M−2))T . (41)\nIn view of the recursions in Eq. (36) and (40), it is easy to prove by induction that\nP (l) = (R(l−1))T . (42)\nA.3 Expansion Matrices For the purpose of factored low-rank approximation for the off-diagonal attention matrix blocks, we design a series of so-called expansion matrices. The first two expansion matrices in this series are\nT (M−1) = P (M−1) =  1 0 1 0 0 1 0 1  4×2\n= [ 12 0 0 12 ] (43)\nand\nT (M−2) = P (M−2)P (M−1) =  1 0 1 0 1 0 1 0\n0 1 0 1 0 1 0 1  8×2\n= [ 14 0 0 14 ] (44)\nwhere 1N is a length-N vector of ones. The general form of matrix T (l) is defined as\nT (l) = ΠM−1i=l P (i) (45)\nwhere l = 1, 2, ...,M − 1. In view of Eq. (43), (45) and (40), it is easy to prove by induction that\nT (l) =\n[ 12M−l 0\n0 12M−l\n] (46)\nand it has size 2M−l+1 × 2. Further more, in view of Eq. (45) and (42), we have\n(T (l))T = Πli=M−1R (i−1). (47)\nA.4 Low-Rank Factored Form Matrix T (l) plays a pivotal role in constructing the low-rank approximation to the off-diagonal attention matrix blocks. Let the ij-th block in the coarsened attention matrix at level-1 be\nÃ (1) ij = [ a11 a12 a21 a22 ] (48)\nwhere aij is the entry resulted from the inner product between a row in Q̃(1) and K̃(1). The rank-2 approximation to the corresponding ij-th block in the original attention matrix A at level-1 can be written as\nA (1) ij ≈ T (M−1)Ã (1) ij (T (M−1))T (49)\n=  1 0 1 0 0 1 0 1 [ a11 a12a21 a22 ] [ 1 1 0 0 0 0 1 1 ]\n=  a11 a11 a12 a12 a11 a11 a12 a12 a21 a21 a22 a22 a21 a21 a22 a22  . (50) It is clear that the resulting 4 × 4 matrix A(1)ij is essentially the piecewise constant interpolation of the 2 × 2 matrix Ã(1)ij along row and column direction. And since both T (M−1) and Ã(1)ij have full rank 2, A(1)ij necessarily has rank 2. One can also view aij as being similar to the average value at the ij-th cluster center in the K-mean method. The role of matrix T (M−1) is to expand from these 2×2 clusters to the 4×4 grid and hence the name expansion matrix.\nSince we maintain the same numerical rank 2 for all super- and sub-diagonal attention matrix blocks, the rank-2 approximation to the ij-th\nblock in the original attention matrix A at level-l is\nA (l) ij ≈ T (M−l)Ã (l) ij (T (M−l))T\n= ΠM−1i=M−lP (i)Ã (l) ij Π M−l i=M−1R (i−1)(51)\nwhere the last equality is due to Eq. (45) and (47). We note that matrix T (l) has full column rank 2 by design and this can be easily shown from Eq. (46). We have used this fact to construct the rank-2 approximation in Eq. (51).\nA.5 Construct Hierarchical Attention Matrix To see how Eq. (51) can be used, consider a simple three-level partition of the attention matrix A for sequence length L = 16\nA =\n[ A\n(2) 11 A (2) 12\nA (2) 21 A (2) 22\n] (52)\nA (2) 11 =  A (0) 11 A (0) 12 A (0) 21 A (0) 22\nA (1) 12\nA (1) 21\nA (0) 33 A (0) 34 A (0) 43 A (0) 44\n (53)\nA (2) 22 =  A (0) 55 A (0) 56 A (0) 65 A (0) 66\nA (1) 34\nA (1) 43\nA (0) 77 A (0) 78 A (0) 87 A (0) 88  (54) where the size of level-0, level-1 and level-2 matrix blocks is 2 × 2, 4 × 4 and 8 × 8, respectively. Note that the number of levels is M = log2(L/2) = 3. We use this simple three-level example to illustrate the key steps in both constructing and applying the hierarchical attention matrix.\nIn view of Eq. (51), we have\nA ≈\n[ Ã\n(2) 11 T (1)Ã (2) 12 (T (1))T\nT (1)Ã (2) 21 (T (1))T Ã (2) 22\n] (55)\nÃ (2) 11 =  A (0) 11 A (0) 12 A (0) 21 A (0) 22\nT (2)Ã (1) 12 (T (2))T\nT (2)Ã (1) 21 (T\n(2))T A\n(0) 33 A (0) 34\nA (0) 43 A (0) 44  (56)\nÃ (2) 22 =  A (0) 55 A (0) 56 A (0) 65 A (0) 66\nT (2)Ã (1) 34 (T (2))T\nT (2)Ã (1) 43 (T\n(2))T A\n(0) 77 A (0) 78\nA (0) 87 A (0) 88  . (57)\nWe note that matrices T (l), l = 1, 2 are never explicitly formed and are only implicitly used, as shown in next section. So only the diagonal blocks at level-0 and super- and sub-diagonal blocks of the coarsened matrix Ã at level-l need to be explicitly computed. By design, all these blocks have the same size 2 × 2 if we set the numerical rank to Nr = 2. The total number of superand sub-diagonal blocks in the binary tree hierarchy is upper bounded by twice the number of super- and sub-diagonal blocks at level-0, which is 2N (0)b . Hence the total number of entries is 5N\n(0) b N 2 r = 5LNr = O(LNr). Each entry is equal to the inner product between Q̃(l)i and K̃ (l) j and hence the run time cost per entry is O(d), where d is the embedding size. So the final total run time cost is O(Ld) and memory foot print is O(L). Here we leave out Nr since it is a constant model hyper parameter.\nA.6 Apply Hierarchical Attention Matrix\nComputing matrix-matrix product AV follows the hierarchical structure of matrix A in Eq. (55), (56) and (57). We first partition matrix V according to the three-level binary tree established by the coarsening process, i.e.,\nV =  V (0) 1 V (0) 2 ...\nV (0) 7 V (0) 8\n =  V (1) 1 V (1) 2 V (1) 3\nV (1) 4\n = [ V (2) 1\nV (2) 2\n] .\n(58) Note that these are partitions of the same matrix V at 3 different levels. For sequence length L = 16, matrix V has size 16 × d, and the size of the partitioned blocks V (0)i , V (1) j and V (2) k are 2 × d, 4 × d and 8 × d, respectively. In the derivation to come, we may exchange partitions at different levels. For instance, in view of Eq. (58), we have\nV (2) 1 =\n[ V\n(1) 1 V (1) 2\n] . (59)\nSo we may replace V (2)1 with the right-hand side in Eq. (59).\nIn view of Eq. (52) and (58), matrix-matrix product AV can be written as\nY = AV =\n[ A\n(2) 11 V (2) 1\nA (2) 22 V (2) 2\n] + [ A (2) 12 V (2) 2\nA (2) 21 V (2) 1\n]\n=\n[ A\n(2) 11 V (2) 1\nA (2) 22 V (2) 2\n] + Y (2). (60)\nIn view of Eq. (55), we have\nY (2) =\n[ A\n(2) 12 V (2) 2\nA (2) 21 V (2) 1\n]\n≈\n[ T (1)Ã\n(2) 12 (T (1))TV (2) 2\nT (1)Ã (2) 21 (T (1))TV (2) 1\n]\n=\n[ P (1)P (2)Ã\n(2) 12 R (1)R(0)V (2) 2\nP (1)P (2)Ã (2) 21 R (1)R(0)V (2) 1\n]\n= P (0)P (1)\n[ Ã\n(2) 12 Ṽ (2) 2\nÃ (2) 21 Ṽ (2) 1\n]\n= P (0)P (1)\n[ Ỹ\n(2) 1 Ỹ (2) 2\n] (61)\nwhere\n[ Ṽ\n(2) 1 Ṽ (2) 2\n] = [ R(1)R(0)V (2) 1\nR(1)R(0)V (2) 2\n] . (62)\nThe third equality in Eq. (61) is due to Eq. (45) and (47) where l = 1. The fourth equality in Eq. (61) is due to Eq. (40).\nIn view of Eq. (56), we have\nA (2) 11 V (2) 1 ≈ Ã (2) 11 V (2) 1\n=  A (0) 11 A (0) 12 A (0) 21 A (0) 22\nT (2)Ã (1) 12 (T (2))T\nT (2)Ã (1) 21 (T\n(2))T A\n(0) 33 A (0) 34\nA (0) 43 A (0) 44\nV (2)1\n=  Y (0) 1 Y (0) 2\nY (0) 3 Y (0) 4\n+ Y (1)1 (63)\nwhere\nY (1) 1 =\n[ T (2)Ã\n(1) 12 (T (2))TV (1) 2\nT (2)Ã (1) 21 (T (2))TV (1) 1\n]\n=\n[ P (2)Ã\n(1) 12 R (1)V (1) 2\nP (2)Ã (1) 21 R (1)V (1) 1\n]\n= P (1)\n[ Ã\n(1) 12 Ṽ (1) 2\nÃ (1) 21 Ṽ (1) 1\n]\n= P (1)\n[ Ỹ\n(1) 1 Ỹ (1) 2\n] (64)\nand [ Ṽ\n(1) 1 Ṽ (1) 2\n] = [ R(1)V (1) 1\nR(1)V (1) 2\n] . (65)\nThe second equality in Eq. (64) is due to Eq. (45) and (47) where l = 2. The third equality in Eq. (64) is due to Eq. (40).\nIn view of Eq.(57), we have\nA (2) 22 V (2) 2 ≈ Ã (2) 22 V (2) 2\n=  A (0) 55 A (0) 56 A (0) 65 A (0) 66\nT (1)Ã (1) 34 (T (1))T\nT (1)Ã (1) 43 (T\n(1))T A\n(0) 77 A (0) 78\nA (0) 87 A (0) 88\nV (2)2\n=  Y (0) 5 Y (0) 6\nY (0) 7 Y (0) 8 + Y (1)2 (66) where\nY (1) 2 =\n[ P (2)Ã\n(1) 34 R (1)V (1) 4\nP (2)Ã (1) 43 R (1)V (1) 3\n]\n= P (1)\n[ Ã\n(1) 34 Ṽ (1) 4\nÃ (1) 43 Ṽ (1) 3\n]\n= P (1)\n[ Ỹ\n(1) 3 Ỹ (1) 4\n] (67)\nand [ Ṽ\n(1) 3 Ṽ (1) 4\n] = [ R(1)V (1) 3\nR(1)V (1) 4\n] . (68)\nSubstituting Eq. (61), (63) and (66) into (60), we obtain the final result for the matrix-matrix product\nY = AV ≈ Y (0) + P (0) ( Ỹ (1) + P (1)Ỹ (2) ) (69)\nwhere\nY (0) =  A (0) 11 V (0) 1 +A (0) 12 V (0) 2 A (0) 21 V (0) 1 +A (0) 22 V (0) 2\n... A\n(0) 87 V (0) 7 +A (0) 88 V (0) 8\n (70)\nỸ (1) =  Ỹ (1) 1 Ỹ (1) 2\nỸ (1) 3 Ỹ (1) 4\n =  Ã (1) 12 Ṽ (1) 2 Ã (1) 21 Ṽ (1) 1\nÃ (1) 34 Ṽ (1) 4 Ã (1) 43 Ṽ (1) 3\n (71)\nỸ (2) =\n[ Ỹ\n(2) 1 Ỹ (2) 2\n] = [ Ã (2) 12 Ṽ (2) 2\nÃ (2) 21 Ṽ (2) 1\n] (72)\nTo summarize, matrix-matrix product computation includes the following steps:\n1. Compute Ṽ (1) in Eq. (65) and (68), and compute Ṽ (2) in Eq. (62);\n2. Compute Y (0) in Eq. (70), Ỹ (1) in Eq. (71) and Ỹ (2) in Eq. (72);\n3. Interpolate and cumulative sum in Eq. (69);\nNote that all operations in step-2 are dense matrixmatrix product, well suited for dense linear algebra libraries optimized for GPU and TPU. The total number of super- and sub-diagonal blocks is upper bounded by twice the number of super- and sub-diagonal blocks at level-0, which is 2N (0)b . The run time of each dense matrix-matrix product is O(N2r d). So the total run time is 5N (0) b N 2 r d = 5LNrd = O(Ld). Here we leave out Nr since it is a constant model hyper-parameter.\nThe coarsening in step-1 and interpolation in step-3 all use sparse matrices with fixed sparsity patterns. Hence matrices P (l) and R(l) are never explicitly formed and applying them can be easily done with standard library functions. Take Jax Numpy library as an example, coarsening can be done with sum() along row axis and interpolation can be done with repeat() along row axis. For this reason, step-1 and step-3 only have dense matrix operations as well.\nThe formulation of the matrix-matrix product for the general level-M case is"
    }, {
      "heading" : "Y = AV = Y (0) + P (0)(Ỹ (1) + P (1)(Ỹ (2)",
      "text" : "+ P (2)(· · ·+ P (M−2)Ỹ (M−1)) · · · )). (73)\nThis formulation is a direct consequence of the nested attention matrix structure and can be derived similarly as Eq. (69)."
    } ],
    "references" : [ {
      "title" : "Hierarchical attentional hybrid neural networks for document classification",
      "author" : [ "Jader Abreu", "Luis Fred", "David Macêdo", "C. Zanchettin." ],
      "venue" : "ArXiv, abs/1901.06610.",
      "citeRegEx" : "Abreu et al\\.,? 2019",
      "shortCiteRegEx" : "Abreu et al\\.",
      "year" : 2019
    }, {
      "title" : "Etc: Encoding long and structured inputs in transformers",
      "author" : [ "Joshua Ainslie", "S. Ontañón", "C. Alberti", "V. Cvicek", "Zachary Kenneth Fisher", "Philip Pham", "Anirudh Ravula", "S. Sanghai", "Qifan Wang", "L. Yang." ],
      "venue" : "EMNLP.",
      "citeRegEx" : "Ainslie et al\\.,? 2020",
      "shortCiteRegEx" : "Ainslie et al\\.",
      "year" : 2020
    }, {
      "title" : "Adaptive input representations for neural language modeling",
      "author" : [ "Alexei Baevski", "M. Auli." ],
      "venue" : "ArXiv, abs/1809.10853.",
      "citeRegEx" : "Baevski and Auli.,? 2019",
      "shortCiteRegEx" : "Baevski and Auli.",
      "year" : 2019
    }, {
      "title" : "Attention augmented convolutional networks",
      "author" : [ "I. Bello", "Barret Zoph", "Ashish Vaswani", "Jonathon Shlens", "Quoc V. Le." ],
      "venue" : "2019 IEEE/CVF International Conference on Computer Vision (ICCV), pages 3285–3294.",
      "citeRegEx" : "Bello et al\\.,? 2019",
      "shortCiteRegEx" : "Bello et al\\.",
      "year" : 2019
    }, {
      "title" : "Longformer: The long-document transformer",
      "author" : [ "Iz Beltagy", "Matthew E. Peters", "Arman Cohan." ],
      "venue" : "ArXiv, abs/2004.05150.",
      "citeRegEx" : "Beltagy et al\\.,? 2020",
      "shortCiteRegEx" : "Beltagy et al\\.",
      "year" : 2020
    }, {
      "title" : "Multilevel matrix multiplication and fast solution of integral equations",
      "author" : [ "A. Brandt", "A.A. Lubrecht." ],
      "venue" : "90:348–370.",
      "citeRegEx" : "Brandt and Lubrecht.,? 1990",
      "shortCiteRegEx" : "Brandt and Lubrecht.",
      "year" : 1990
    }, {
      "title" : "A Multigrid Tutorial",
      "author" : [ "W.L. Briggs", "V.E. Henson", "S.F. McCormick." ],
      "venue" : "SIAM.",
      "citeRegEx" : "Briggs et al\\.,? 2000",
      "shortCiteRegEx" : "Briggs et al\\.",
      "year" : 2000
    }, {
      "title" : "Language models are few-shot learners",
      "author" : [ "Amodei." ],
      "venue" : "ArXiv, abs/2005.14165.",
      "citeRegEx" : "Amodei.,? 2020",
      "shortCiteRegEx" : "Amodei.",
      "year" : 2020
    }, {
      "title" : "One billion word benchmark for measuring progress in statistical language modeling",
      "author" : [ "Ciprian Chelba", "Tomas Mikolov", "M. Schuster", "Qi Ge", "T. Brants", "Phillipp Koehn", "T. Robinson." ],
      "venue" : "ArXiv, abs/1312.3005.",
      "citeRegEx" : "Chelba et al\\.,? 2014",
      "shortCiteRegEx" : "Chelba et al\\.",
      "year" : 2014
    }, {
      "title" : "Generative pretraining from pixels",
      "author" : [ "Mark Chen", "Alec Radford", "Rewon Child", "Jeffrey Wu", "Heewoo Jun", "David Luan", "Ilya Sutskever." ],
      "venue" : "Proceedings of the 37th International Conference on Machine Learning, PMLR 119.",
      "citeRegEx" : "Chen et al\\.,? 2020",
      "shortCiteRegEx" : "Chen et al\\.",
      "year" : 2020
    }, {
      "title" : "Generating long sequences with sparse transformers",
      "author" : [ "R. Child", "Scott Gray", "A. Radford", "Ilya Sutskever." ],
      "venue" : "ArXiv, abs/1904.10509.",
      "citeRegEx" : "Child et al\\.,? 2019",
      "shortCiteRegEx" : "Child et al\\.",
      "year" : 2019
    }, {
      "title" : "Transformer-xl: Attentive language models beyond a fixed-length context",
      "author" : [ "Zihang Dai", "Z. Yang", "Yiming Yang", "J. Carbonell", "Quoc V. Le", "R. Salakhutdinov." ],
      "venue" : "ACL.",
      "citeRegEx" : "Dai et al\\.,? 2019",
      "shortCiteRegEx" : "Dai et al\\.",
      "year" : 2019
    }, {
      "title" : "Bert: Pre-training of deep bidirectional transformers for language understanding",
      "author" : [ "J. Devlin", "Ming-Wei Chang", "Kenton Lee", "Kristina Toutanova." ],
      "venue" : "NAACL-HLT.",
      "citeRegEx" : "Devlin et al\\.,? 2019",
      "shortCiteRegEx" : "Devlin et al\\.",
      "year" : 2019
    }, {
      "title" : "Matrix Computation",
      "author" : [ "G.H. Golub", "C.F. Van Loan." ],
      "venue" : "The John Hopkins University Press, Baltimore.",
      "citeRegEx" : "Golub and Loan.,? 1996",
      "shortCiteRegEx" : "Golub and Loan.",
      "year" : 1996
    }, {
      "title" : "Inductive biases for deep learning of higher-level cognition",
      "author" : [ "Anirudh Goyal", "Yoshua Bengio." ],
      "venue" : "ArXiv, abs/2011.15091.",
      "citeRegEx" : "Goyal and Bengio.,? 2020",
      "shortCiteRegEx" : "Goyal and Bengio.",
      "year" : 2020
    }, {
      "title" : "Fast algorithms for classical physics",
      "author" : [ "L Greengard." ],
      "venue" : "Science, 265:909–914.",
      "citeRegEx" : "Greengard.,? 1994",
      "shortCiteRegEx" : "Greengard.",
      "year" : 1994
    }, {
      "title" : "A fast algorithm for particle simulations",
      "author" : [ "L Greengard", "V Rokhlin." ],
      "venue" : "73:325–348.",
      "citeRegEx" : "Greengard and Rokhlin.,? 1987",
      "shortCiteRegEx" : "Greengard and Rokhlin.",
      "year" : 1987
    }, {
      "title" : "A sparse matrix arithmetic based on h-matrices",
      "author" : [ "W. Hackbusch." ],
      "venue" : "part I: Introduction to H-matrices. Computing, 62:89–108.",
      "citeRegEx" : "Hackbusch.,? 1999",
      "shortCiteRegEx" : "Hackbusch.",
      "year" : 1999
    }, {
      "title" : "A sparse matrix arithmetic based on H-matrices",
      "author" : [ "W. Hackbusch." ],
      "venue" : "part II: Application to multidimensional problems. Computing, 64:21–47.",
      "citeRegEx" : "Hackbusch.,? 2000",
      "shortCiteRegEx" : "Hackbusch.",
      "year" : 2000
    }, {
      "title" : "Axial attention in multidimensional transformers",
      "author" : [ "Jonathan Ho", "Nal Kalchbrenner", "Dirk Weissenborn", "Tim Salimans." ],
      "venue" : "ArXiv, abs/1912.12180.",
      "citeRegEx" : "Ho et al\\.,? 2019",
      "shortCiteRegEx" : "Ho et al\\.",
      "year" : 2019
    }, {
      "title" : "Music transformer",
      "author" : [ "Cheng-Zhi Anna Huang", "Ashish Vaswani", "Jakob Uszkoreit", "Noam Shazeer", "Ian Simon", "Curtis Hawthorne", "Andrew M. Dai", "Matthew D. Hoffman", "Monica Dinculescu", "Douglas Eck." ],
      "venue" : "arXiv: Learning.",
      "citeRegEx" : "Huang et al\\.,? 2018",
      "shortCiteRegEx" : "Huang et al\\.",
      "year" : 2018
    }, {
      "title" : "IES3: A fast integral equation solver for efficient 3-dimensional extraction",
      "author" : [ "S. Kapur", "D.E. Long." ],
      "venue" : "International Conference on Computer AidedDesign, pages 448–455.",
      "citeRegEx" : "Kapur and Long.,? 1997",
      "shortCiteRegEx" : "Kapur and Long.",
      "year" : 1997
    }, {
      "title" : "Sharp nearby, fuzzy far away: How neural language models use context",
      "author" : [ "Urvashi Khandelwal", "He He", "Peng Qi", "Dan Jurafsky." ],
      "venue" : "ArXiv, abs/1805.04623.",
      "citeRegEx" : "Khandelwal et al\\.,? 2018",
      "shortCiteRegEx" : "Khandelwal et al\\.",
      "year" : 2018
    }, {
      "title" : "Reformer: The efficient transformer",
      "author" : [ "Nikita Kitaev", "Lukasz Kaiser", "Anselm Levskaya." ],
      "venue" : "ArXiv, abs/2001.04451.",
      "citeRegEx" : "Kitaev et al\\.,? 2020",
      "shortCiteRegEx" : "Kitaev et al\\.",
      "year" : 2020
    }, {
      "title" : "Hierarchical transformers for multi-document summarization",
      "author" : [ "Yang Liu", "Mirella Lapata." ],
      "venue" : "ACL.",
      "citeRegEx" : "Liu and Lapata.,? 2019",
      "shortCiteRegEx" : "Liu and Lapata.",
      "year" : 2019
    }, {
      "title" : "Effective approaches to attention-based neural machine translation",
      "author" : [ "Thang Luong", "Hieu Pham", "Christopher D. Manning." ],
      "venue" : "ArXiv, abs/1508.04025.",
      "citeRegEx" : "Luong et al\\.,? 2015",
      "shortCiteRegEx" : "Luong et al\\.",
      "year" : 2015
    }, {
      "title" : "Foundations of Statistical Natural Language Processing",
      "author" : [ "Chris Manning", "Hinrich Schütze." ],
      "venue" : "MIT Press, Cambridge, MA.",
      "citeRegEx" : "Manning and Schütze.,? 1999",
      "shortCiteRegEx" : "Manning and Schütze.",
      "year" : 1999
    }, {
      "title" : "Document-level neural machine translation with hierarchical attention networks",
      "author" : [ "Lesly Miculicich", "Dhananjay Ram", "Nikolaos Pappas", "James Henderson." ],
      "venue" : "EMNLP.",
      "citeRegEx" : "Miculicich et al\\.,? 2018",
      "shortCiteRegEx" : "Miculicich et al\\.",
      "year" : 2018
    }, {
      "title" : "Multipole accelerated preconditioned iterative methods for three-dimensional potential integral equations of the first kind",
      "author" : [ "K. Nabors", "T. Korsmeyer", "J. White." ],
      "venue" : "SIAM J. Sci. and Stat. Comp.",
      "citeRegEx" : "Nabors et al\\.,? 1994",
      "shortCiteRegEx" : "Nabors et al\\.",
      "year" : 1994
    }, {
      "title" : "Image transformer",
      "author" : [ "Niki Parmar", "Ashish Vaswani", "Jakob Uszkoreit", "Lukasz Kaiser", "Noam Shazeer", "Alexander Ku", "Dustin Tran." ],
      "venue" : "ArXiv, abs/1802.05751.",
      "citeRegEx" : "Parmar et al\\.,? 2018",
      "shortCiteRegEx" : "Parmar et al\\.",
      "year" : 2018
    }, {
      "title" : "A precorrectedFFT method for electrostatic analysis of complicated 3D structures",
      "author" : [ "Joel R. Phillips", "J.K. White." ],
      "venue" : "IEEE Transactions on ComputerAided Design of Integrated Circuits and Systems, pages 1059–1072.",
      "citeRegEx" : "Phillips and White.,? 1997",
      "shortCiteRegEx" : "Phillips and White.",
      "year" : 1997
    }, {
      "title" : "Blockwise selfattention for long document understanding",
      "author" : [ "Jiezhong Qiu", "Hao Ma", "Omer Levy", "Scott Yih", "Sinong Wang", "Jie Tang." ],
      "venue" : "ArXiv, abs/1911.02972.",
      "citeRegEx" : "Qiu et al\\.,? 2019",
      "shortCiteRegEx" : "Qiu et al\\.",
      "year" : 2019
    }, {
      "title" : "Stand-alone self-attention in vision models",
      "author" : [ "Prajit Ramachandran", "Niki Parmar", "Ashish Vaswani", "Irwan Bello", "Anselm Levskaya", "Jonathon Shlens." ],
      "venue" : "ArXiv, abs/1906.05909.",
      "citeRegEx" : "Ramachandran et al\\.,? 2019",
      "shortCiteRegEx" : "Ramachandran et al\\.",
      "year" : 2019
    }, {
      "title" : "Efficient content-based sparse attention with routing transformers",
      "author" : [ "Aurko Roy", "M. Saffar", "Ashish Vaswani", "David Grangier." ],
      "venue" : "ArXiv, abs/2003.05997.",
      "citeRegEx" : "Roy et al\\.,? 2020",
      "shortCiteRegEx" : "Roy et al\\.",
      "year" : 2020
    }, {
      "title" : "Meshtensorflow: Deep learning for supercomputers",
      "author" : [ "Noam Shazeer", "Youlong Cheng", "Niki Parmar", "Dustin Tran", "Ashish Vaswani", "Penporn Koanantakool", "P. Hawkins", "H. Lee", "Mingsheng Hong", "C. Young", "Ryan Sepassi", "Blake A. Hechtman." ],
      "venue" : "In",
      "citeRegEx" : "Shazeer et al\\.,? 2018",
      "shortCiteRegEx" : "Shazeer et al\\.",
      "year" : 2018
    }, {
      "title" : "A fast hierarchical algorithm for 3-d capacitance extraction",
      "author" : [ "W. Shi", "J. Liu", "N. Kakani", "T. Yu." ],
      "venue" : "ACM/IEEE Design Automation Conference.",
      "citeRegEx" : "Shi et al\\.,? 1998",
      "shortCiteRegEx" : "Shi et al\\.",
      "year" : 1998
    }, {
      "title" : "Synthesizer: Rethinking self-attention in transformer models",
      "author" : [ "Yi Tay", "Dara Bahri", "Donald Metzler", "D. Juan", "Zhe Zhao", "Che Zheng." ],
      "venue" : "ArXiv, abs/2005.00743.",
      "citeRegEx" : "Tay et al\\.,? 2020a",
      "shortCiteRegEx" : "Tay et al\\.",
      "year" : 2020
    }, {
      "title" : "Sparse sinkhorn attention",
      "author" : [ "Yi Tay", "Dara Bahri", "L. Yang", "Donald Metzler", "D. Juan." ],
      "venue" : "ICML.",
      "citeRegEx" : "Tay et al\\.,? 2020b",
      "shortCiteRegEx" : "Tay et al\\.",
      "year" : 2020
    }, {
      "title" : "Long range arena: A benchmark for efficient transformers",
      "author" : [ "Yi Tay", "M. Dehghani", "Samira Abnar", "Y. Shen", "Dara Bahri", "Philip Pham", "J. Rao", "Liu Yang", "Sebastian Ruder", "Donald Metzler." ],
      "venue" : "ArXiv, abs/2011.04006.",
      "citeRegEx" : "Tay et al\\.,? 2020c",
      "shortCiteRegEx" : "Tay et al\\.",
      "year" : 2020
    }, {
      "title" : "Efficient transformers: A survey",
      "author" : [ "Yi Tay", "M. Dehghani", "Dara Bahri", "Donald Metzler." ],
      "venue" : "ArXiv, abs/2009.06732.",
      "citeRegEx" : "Tay et al\\.,? 2020d",
      "shortCiteRegEx" : "Tay et al\\.",
      "year" : 2020
    }, {
      "title" : "Numerical linear algebra",
      "author" : [ "L.N. Trefethen", "D. Bau." ],
      "venue" : "SIAM, Philadelphia.",
      "citeRegEx" : "Trefethen and Bau.,? 1997",
      "shortCiteRegEx" : "Trefethen and Bau.",
      "year" : 1997
    }, {
      "title" : "Multigrid",
      "author" : [ "Ulrich Trottenberg", "Cornelius W. Oosterlee", "Anton Schuller." ],
      "venue" : "Academic Press.",
      "citeRegEx" : "Trottenberg et al\\.,? 2000",
      "shortCiteRegEx" : "Trottenberg et al\\.",
      "year" : 2000
    }, {
      "title" : "Attention is all you need",
      "author" : [ "Ashish Vaswani", "Noam Shazeer", "Niki Parmar", "Jakob Uszkoreit", "Llion Jones", "Aidan N. Gomez", "Lukasz Kaiser", "Illia Polosukhin." ],
      "venue" : "ArXiv, abs/1706.03762.",
      "citeRegEx" : "Vaswani et al\\.,? 2017",
      "shortCiteRegEx" : "Vaswani et al\\.",
      "year" : 2017
    }, {
      "title" : "Graph attention networks",
      "author" : [ "Petar Velickovic", "Guillem Cucurull", "Arantxa Casanova", "Adriana Romero", "Pietro Liò", "Yoshua Bengio." ],
      "venue" : "ArXiv, abs/1710.10903.",
      "citeRegEx" : "Velickovic et al\\.,? 2018",
      "shortCiteRegEx" : "Velickovic et al\\.",
      "year" : 2018
    }, {
      "title" : "Linformer: Self-attention with linear complexity",
      "author" : [ "Sinong Wang", "Belinda Z. Li", "Madian Khabsa", "Han Fang", "Hao Ma." ],
      "venue" : "ArXiv, abs/2006.04768.",
      "citeRegEx" : "Wang et al\\.,? 2020",
      "shortCiteRegEx" : "Wang et al\\.",
      "year" : 2020
    }, {
      "title" : "Big bird: Transformers for longer sequences",
      "author" : [ "Manzil Zaheer", "Guru Guruganesh", "Kumar Avinava Dubey", "Joshua Ainslie", "Chris Alberti", "Santiago Ontañón", "Philip Pham", "Anirudh Ravula", "Qifan Wang", "Li Yang", "Amr Ahmed" ],
      "venue" : null,
      "citeRegEx" : "Zaheer et al\\.,? \\Q2020\\E",
      "shortCiteRegEx" : "Zaheer et al\\.",
      "year" : 2020
    }, {
      "title" : "Informer: Beyond efficient transformer for long sequence time-series forecasting",
      "author" : [ "Hao-Yi Zhou", "Shanghang Zhang", "Jieqi Peng", "Shuai Zhang", "Jianxin Li", "Hui Xiong", "Wancai Zhang." ],
      "venue" : "ArXiv, abs/2012.07436.",
      "citeRegEx" : "Zhou et al\\.,? 2020",
      "shortCiteRegEx" : "Zhou et al\\.",
      "year" : 2020
    }, {
      "title" : "Algorithms in FastImp: A fast and wideband impedance extraction program for complicated 3D geometries",
      "author" : [ "Zhenhai Zhu", "Ben Song", "J.K. White." ],
      "venue" : "IEEE Transactions on Computer-Aided Design of Integrated Circuits and Systems.",
      "citeRegEx" : "Zhu et al\\.,? 2005",
      "shortCiteRegEx" : "Zhu et al\\.",
      "year" : 2005
    }, {
      "title" : "Fastsies: a fast stochastic integral equation solver for modeling the rough surface effect",
      "author" : [ "Zhenhai Zhu", "J.K. White." ],
      "venue" : "International Conference on Computer Aided-Design, pages 675–682.",
      "citeRegEx" : "Zhu and White.,? 2005",
      "shortCiteRegEx" : "Zhu and White.",
      "year" : 2005
    } ],
    "referenceMentions" : [ {
      "referenceID" : 25,
      "context" : "Linearly combining information using contentbased weights, a method generically known as attention, is a key building block in many deep neural networks such as recurrent neural networks (RNN) (Luong et al., 2015), convolutional neural networks (CNN) (Bello et al.",
      "startOffset" : 193,
      "endOffset" : 213
    }, {
      "referenceID" : 3,
      "context" : ", 2015), convolutional neural networks (CNN) (Bello et al., 2019) and graph convolutional networks (GCN) (Velickovic et al.",
      "startOffset" : 45,
      "endOffset" : 65
    }, {
      "referenceID" : 43,
      "context" : ", 2019) and graph convolutional networks (GCN) (Velickovic et al., 2018).",
      "startOffset" : 47,
      "endOffset" : 72
    }, {
      "referenceID" : 45,
      "context" : "These include standard natural language processing (NLP) tasks such as machine translation, document classification, entailment, summarization and question answering (Zaheer et al., 2020; Dai et al., 2019; Baevski and Auli, 2019), as well as music generation (Huang et al.",
      "startOffset" : 166,
      "endOffset" : 229
    }, {
      "referenceID" : 11,
      "context" : "These include standard natural language processing (NLP) tasks such as machine translation, document classification, entailment, summarization and question answering (Zaheer et al., 2020; Dai et al., 2019; Baevski and Auli, 2019), as well as music generation (Huang et al.",
      "startOffset" : 166,
      "endOffset" : 229
    }, {
      "referenceID" : 2,
      "context" : "These include standard natural language processing (NLP) tasks such as machine translation, document classification, entailment, summarization and question answering (Zaheer et al., 2020; Dai et al., 2019; Baevski and Auli, 2019), as well as music generation (Huang et al.",
      "startOffset" : 166,
      "endOffset" : 229
    }, {
      "referenceID" : 20,
      "context" : ", 2019; Baevski and Auli, 2019), as well as music generation (Huang et al., 2018), image generation (Parmar et al.",
      "startOffset" : 61,
      "endOffset" : 81
    }, {
      "referenceID" : 29,
      "context" : ", 2018), image generation (Parmar et al., 2018; Chen et al., 2020) and genomics (Zaheer et al.",
      "startOffset" : 26,
      "endOffset" : 66
    }, {
      "referenceID" : 9,
      "context" : ", 2018), image generation (Parmar et al., 2018; Chen et al., 2020) and genomics (Zaheer et al.",
      "startOffset" : 26,
      "endOffset" : 66
    }, {
      "referenceID" : 12,
      "context" : "The Transformer is also the backbone architecture for models such as BERT (Devlin et al., 2019) (and its numerous relatives) and GPT3 (Brown et al.",
      "startOffset" : 74,
      "endOffset" : 95
    }, {
      "referenceID" : 39,
      "context" : "Therefore, this quadratic complexity has become a critical bottleneck in processing long sequences (over 1,000 tokens), and has since motivated many new attention algorithms, see (Tay et al., 2020d) for a survey of such work.",
      "startOffset" : 179,
      "endOffset" : 198
    }, {
      "referenceID" : 6,
      "context" : "In this paper, we draw inspiration from two branches in numerical analysis: Hierarchical Matrix (H-Matrix) (Hackbusch, 1999, 2000) and Multigrid method (Briggs et al., 2000).",
      "startOffset" : 152,
      "endOffset" : 173
    }, {
      "referenceID" : 38,
      "context" : "The main benchmark we use in this paper is the Long Range Arena (LRA) benchmark (Tay et al., 2020c), which has been specifically designed to evaluate and compare various sub-quadratic attention algorithms.",
      "startOffset" : 80,
      "endOffset" : 99
    }, {
      "referenceID" : 45,
      "context" : "Our new hierarchical attention mechanism achieves best average performance to-date on the LRA benchmark by more than 6 points over the previous-best BigBird algorithm (Zaheer et al., 2020), while pushing SOTA performance higher in 4 of the 5 successful tasks.",
      "startOffset" : 167,
      "endOffset" : 188
    }, {
      "referenceID" : 8,
      "context" : "3802 tion, a Transformer-based language model trained on the One-Billion Word dataset (Chelba et al., 2014) sets a new SOTA performance record by reducing the test perplexity by 1.",
      "startOffset" : 86,
      "endOffset" : 107
    }, {
      "referenceID" : 11,
      "context" : "55 points comparing to the previous-best Transformer-XL (Dai et al., 2019) with 5x more parameters.",
      "startOffset" : 56,
      "endOffset" : 74
    }, {
      "referenceID" : 26,
      "context" : "It is well established in the NLP literature that the embeddings of nearby tokens tend to be more similar than the distant ones (Manning and Schütze, 1999).",
      "startOffset" : 128,
      "endOffset" : 155
    }, {
      "referenceID" : 29,
      "context" : "This motivates the sliding-window local attention (Parmar et al., 2018; Ramachandran et al., 2019; Qiu et al., 2019) which amounts to truncating off-diagonal entries in the attention matrix beyond a user-specified sequence distance.",
      "startOffset" : 50,
      "endOffset" : 116
    }, {
      "referenceID" : 32,
      "context" : "This motivates the sliding-window local attention (Parmar et al., 2018; Ramachandran et al., 2019; Qiu et al., 2019) which amounts to truncating off-diagonal entries in the attention matrix beyond a user-specified sequence distance.",
      "startOffset" : 50,
      "endOffset" : 116
    }, {
      "referenceID" : 31,
      "context" : "This motivates the sliding-window local attention (Parmar et al., 2018; Ramachandran et al., 2019; Qiu et al., 2019) which amounts to truncating off-diagonal entries in the attention matrix beyond a user-specified sequence distance.",
      "startOffset" : 50,
      "endOffset" : 116
    }, {
      "referenceID" : 23,
      "context" : "The nonzero entry selection is either content-based (Kitaev et al., 2020; Roy et al., 2020; Tay et al., 2020b; Zhou et al., 2020), hand-crafted (Beltagy et al.",
      "startOffset" : 52,
      "endOffset" : 129
    }, {
      "referenceID" : 33,
      "context" : "The nonzero entry selection is either content-based (Kitaev et al., 2020; Roy et al., 2020; Tay et al., 2020b; Zhou et al., 2020), hand-crafted (Beltagy et al.",
      "startOffset" : 52,
      "endOffset" : 129
    }, {
      "referenceID" : 37,
      "context" : "The nonzero entry selection is either content-based (Kitaev et al., 2020; Roy et al., 2020; Tay et al., 2020b; Zhou et al., 2020), hand-crafted (Beltagy et al.",
      "startOffset" : 52,
      "endOffset" : 129
    }, {
      "referenceID" : 46,
      "context" : "The nonzero entry selection is either content-based (Kitaev et al., 2020; Roy et al., 2020; Tay et al., 2020b; Zhou et al., 2020), hand-crafted (Beltagy et al.",
      "startOffset" : 52,
      "endOffset" : 129
    }, {
      "referenceID" : 4,
      "context" : ", 2020), hand-crafted (Beltagy et al., 2020; Brown et al., 2020; Child et al., 2019; Ho et al., 2019) or simply random (Zaheer et al.",
      "startOffset" : 22,
      "endOffset" : 101
    }, {
      "referenceID" : 10,
      "context" : ", 2020), hand-crafted (Beltagy et al., 2020; Brown et al., 2020; Child et al., 2019; Ho et al., 2019) or simply random (Zaheer et al.",
      "startOffset" : 22,
      "endOffset" : 101
    }, {
      "referenceID" : 19,
      "context" : ", 2020), hand-crafted (Beltagy et al., 2020; Brown et al., 2020; Child et al., 2019; Ho et al., 2019) or simply random (Zaheer et al.",
      "startOffset" : 22,
      "endOffset" : 101
    }, {
      "referenceID" : 22,
      "context" : "It is also well known in the NLP literature that long-range contextual information is necessary for many NLP tasks (Khandelwal et al., 2018; Liu and Lapata, 2019).",
      "startOffset" : 115,
      "endOffset" : 162
    }, {
      "referenceID" : 24,
      "context" : "It is also well known in the NLP literature that long-range contextual information is necessary for many NLP tasks (Khandelwal et al., 2018; Liu and Lapata, 2019).",
      "startOffset" : 115,
      "endOffset" : 162
    }, {
      "referenceID" : 45,
      "context" : "This adds O(1) number of dense rows and columns to the attention matrix (Zaheer et al., 2020; Ainslie et al., 2020; Beltagy et al., 2020).",
      "startOffset" : 72,
      "endOffset" : 137
    }, {
      "referenceID" : 1,
      "context" : "This adds O(1) number of dense rows and columns to the attention matrix (Zaheer et al., 2020; Ainslie et al., 2020; Beltagy et al., 2020).",
      "startOffset" : 72,
      "endOffset" : 137
    }, {
      "referenceID" : 4,
      "context" : "This adds O(1) number of dense rows and columns to the attention matrix (Zaheer et al., 2020; Ainslie et al., 2020; Beltagy et al., 2020).",
      "startOffset" : 72,
      "endOffset" : 137
    }, {
      "referenceID" : 44,
      "context" : "A third approach is to approximate the attention matrix with a low-rank factored form (Choromanski et al., 2020; Wang et al., 2020; Tay et al., 2020a).",
      "startOffset" : 86,
      "endOffset" : 150
    }, {
      "referenceID" : 36,
      "context" : "A third approach is to approximate the attention matrix with a low-rank factored form (Choromanski et al., 2020; Wang et al., 2020; Tay et al., 2020a).",
      "startOffset" : 86,
      "endOffset" : 150
    }, {
      "referenceID" : 16,
      "context" : "small set of samples of these algorithms and their engineering applications include Fast Multipole Method (Greengard and Rokhlin, 1987; Greengard, 1994; Nabors et al., 1994; Shi et al., 1998), Pre-corrected FFT (Phillips and White, 1997; Zhu et al.",
      "startOffset" : 106,
      "endOffset" : 191
    }, {
      "referenceID" : 15,
      "context" : "small set of samples of these algorithms and their engineering applications include Fast Multipole Method (Greengard and Rokhlin, 1987; Greengard, 1994; Nabors et al., 1994; Shi et al., 1998), Pre-corrected FFT (Phillips and White, 1997; Zhu et al.",
      "startOffset" : 106,
      "endOffset" : 191
    }, {
      "referenceID" : 28,
      "context" : "small set of samples of these algorithms and their engineering applications include Fast Multipole Method (Greengard and Rokhlin, 1987; Greengard, 1994; Nabors et al., 1994; Shi et al., 1998), Pre-corrected FFT (Phillips and White, 1997; Zhu et al.",
      "startOffset" : 106,
      "endOffset" : 191
    }, {
      "referenceID" : 35,
      "context" : "small set of samples of these algorithms and their engineering applications include Fast Multipole Method (Greengard and Rokhlin, 1987; Greengard, 1994; Nabors et al., 1994; Shi et al., 1998), Pre-corrected FFT (Phillips and White, 1997; Zhu et al.",
      "startOffset" : 106,
      "endOffset" : 191
    }, {
      "referenceID" : 30,
      "context" : ", 1998), Pre-corrected FFT (Phillips and White, 1997; Zhu et al., 2005), Hierarchical Singular Value Decomposition (SVD) (Kapur and Long, 1997) and Hierarchical Matrix (H-Matrix) (Hackbusch, 1999, 2000; Zhu and White, 2005).",
      "startOffset" : 27,
      "endOffset" : 71
    }, {
      "referenceID" : 47,
      "context" : ", 1998), Pre-corrected FFT (Phillips and White, 1997; Zhu et al., 2005), Hierarchical Singular Value Decomposition (SVD) (Kapur and Long, 1997) and Hierarchical Matrix (H-Matrix) (Hackbusch, 1999, 2000; Zhu and White, 2005).",
      "startOffset" : 27,
      "endOffset" : 71
    }, {
      "referenceID" : 21,
      "context" : ", 2005), Hierarchical Singular Value Decomposition (SVD) (Kapur and Long, 1997) and Hierarchical Matrix (H-Matrix) (Hackbusch, 1999, 2000; Zhu and White, 2005).",
      "startOffset" : 57,
      "endOffset" : 79
    }, {
      "referenceID" : 48,
      "context" : ", 2005), Hierarchical Singular Value Decomposition (SVD) (Kapur and Long, 1997) and Hierarchical Matrix (H-Matrix) (Hackbusch, 1999, 2000; Zhu and White, 2005).",
      "startOffset" : 115,
      "endOffset" : 159
    }, {
      "referenceID" : 5,
      "context" : "These are generally called Multilevel Methods (Brandt and Lubrecht, 1990).",
      "startOffset" : 46,
      "endOffset" : 73
    }, {
      "referenceID" : 42,
      "context" : "Given matrices Q, K and V , with rows representing sequences of token embedding or feature vectors for query, key and value respectively, the output weighted by the scaled dot-product attention in the Transformer (Vaswani et al., 2017) is defined as",
      "startOffset" : 213,
      "endOffset" : 235
    }, {
      "referenceID" : 42,
      "context" : "Extension to the multi-head case is straightforward since each attention head is computed independently (Vaswani et al., 2017).",
      "startOffset" : 104,
      "endOffset" : 126
    }, {
      "referenceID" : 40,
      "context" : "The numerical rank of matrix A is r if ∑L i=r+1 σi < for a given tolerance (Trefethen and Bau, 1997).",
      "startOffset" : 75,
      "endOffset" : 100
    }, {
      "referenceID" : 44,
      "context" : "This is the low-rank approximation used in (Choromanski et al., 2020; Wang et al., 2020; Tay et al., 2020a).",
      "startOffset" : 43,
      "endOffset" : 107
    }, {
      "referenceID" : 36,
      "context" : "This is the low-rank approximation used in (Choromanski et al., 2020; Wang et al., 2020; Tay et al., 2020a).",
      "startOffset" : 43,
      "endOffset" : 107
    }, {
      "referenceID" : 29,
      "context" : "Therefore, truncating off-diagonal entries of matrix A, as proposed in (Parmar et al., 2018), would produce a poor approximation.",
      "startOffset" : 71,
      "endOffset" : 92
    }, {
      "referenceID" : 21,
      "context" : "In practice, the number of levels is adapted to the underlining governing equations that result in matrix A and it can easily be over 10 (Kapur and Long, 1997; Hackbusch, 2000; Zhu and White, 2005).",
      "startOffset" : 137,
      "endOffset" : 197
    }, {
      "referenceID" : 18,
      "context" : "In practice, the number of levels is adapted to the underlining governing equations that result in matrix A and it can easily be over 10 (Kapur and Long, 1997; Hackbusch, 2000; Zhu and White, 2005).",
      "startOffset" : 137,
      "endOffset" : 197
    }, {
      "referenceID" : 48,
      "context" : "In practice, the number of levels is adapted to the underlining governing equations that result in matrix A and it can easily be over 10 (Kapur and Long, 1997; Hackbusch, 2000; Zhu and White, 2005).",
      "startOffset" : 137,
      "endOffset" : 197
    }, {
      "referenceID" : 6,
      "context" : "Multigrid Method is a multi-level nested iterative method for solving large-scale sparse matrices resulting from discretized partial-differential equations (PDEs) (Briggs et al., 2000; Trottenberg et al., 2000).",
      "startOffset" : 163,
      "endOffset" : 210
    }, {
      "referenceID" : 41,
      "context" : "Multigrid Method is a multi-level nested iterative method for solving large-scale sparse matrices resulting from discretized partial-differential equations (PDEs) (Briggs et al., 2000; Trottenberg et al., 2000).",
      "startOffset" : 163,
      "endOffset" : 210
    }, {
      "referenceID" : 13,
      "context" : "(11) is a symmetric Toeplitz matrix (Golub and Loan, 1996) and hence only has 16 unique entries.",
      "startOffset" : 36,
      "endOffset" : 58
    }, {
      "referenceID" : 16,
      "context" : "Much of the theoretical analysis by (Greengard and Rokhlin, 1987; Hackbusch, 1999) is concerned with quantifying such aspects.",
      "startOffset" : 36,
      "endOffset" : 82
    }, {
      "referenceID" : 17,
      "context" : "Much of the theoretical analysis by (Greengard and Rokhlin, 1987; Hackbusch, 1999) is concerned with quantifying such aspects.",
      "startOffset" : 36,
      "endOffset" : 82
    }, {
      "referenceID" : 16,
      "context" : "The error analysis in (Greengard and Rokhlin, 1987; Hackbusch, 1999) offers little direct insight since the attention matrix A in Eq.",
      "startOffset" : 22,
      "endOffset" : 68
    }, {
      "referenceID" : 17,
      "context" : "The error analysis in (Greengard and Rokhlin, 1987; Hackbusch, 1999) offers little direct insight since the attention matrix A in Eq.",
      "startOffset" : 22,
      "endOffset" : 68
    }, {
      "referenceID" : 22,
      "context" : "The ablation studies by (Khandelwal et al., 2018) examine the effect of context words on a language model.",
      "startOffset" : 24,
      "endOffset" : 49
    }, {
      "referenceID" : 27,
      "context" : "A few recent attention-related studies have explored this direction with some success, such as word-level and sentence-level attentions in (Miculicich et al., 2018; Abreu et al., 2019), and sentence-level and paragraph-level attentions in (Liu and Lapata, 2019).",
      "startOffset" : 139,
      "endOffset" : 184
    }, {
      "referenceID" : 0,
      "context" : "A few recent attention-related studies have explored this direction with some success, such as word-level and sentence-level attentions in (Miculicich et al., 2018; Abreu et al., 2019), and sentence-level and paragraph-level attentions in (Liu and Lapata, 2019).",
      "startOffset" : 139,
      "endOffset" : 184
    }, {
      "referenceID" : 24,
      "context" : ", 2019), and sentence-level and paragraph-level attentions in (Liu and Lapata, 2019).",
      "startOffset" : 62,
      "endOffset" : 84
    }, {
      "referenceID" : 14,
      "context" : "As pointed out in (Goyal and Bengio, 2020), inductive biases encourage the learning algorithm to prioritise solutions with certain properties.",
      "startOffset" : 18,
      "endOffset" : 42
    }, {
      "referenceID" : 22,
      "context" : "The observation in (Khandelwal et al., 2018) clearly suggests that a distance-dependent attention mechanism should be a better alternative.",
      "startOffset" : 19,
      "endOffset" : 44
    }, {
      "referenceID" : 42,
      "context" : "In all our experiments in this section, we use the standard Transformer architecture described in (Vaswani et al., 2017) as the backbone for our HTransformer-1D model.",
      "startOffset" : 98,
      "endOffset" : 120
    }, {
      "referenceID" : 38,
      "context" : "The open-source Long-Range Arena (LRA) benchmark 7 has been proposed as a standard way to probe and quantify the capabilities of various xformer (long-range Transformer) architectures (Tay et al., 2020c).",
      "startOffset" : 184,
      "endOffset" : 203
    }, {
      "referenceID" : 45,
      "context" : "4 points improvement over the previous-best average performance from BigBird (Zaheer et al., 2020).",
      "startOffset" : 77,
      "endOffset" : 98
    }, {
      "referenceID" : 8,
      "context" : "We trained both the Transformer baseline and HTransformer-1D on the One-Billion Word benchmark (Chelba et al., 2014).",
      "startOffset" : 95,
      "endOffset" : 116
    }, {
      "referenceID" : 11,
      "context" : "H-Transformer-1D delivers the lowest perplexity to-date while using 5× smaller model capacity than that of the previous SOTA model Transformer-XL (Dai et al., 2019).",
      "startOffset" : 146,
      "endOffset" : 164
    } ],
    "year" : 2021,
    "abstractText" : "We describe an efficient hierarchical method to compute attention in the Transformer architecture. The proposed attention mechanism exploits a matrix structure similar to the Hierarchical Matrix (H-Matrix) developed by the numerical analysis community, and has linear run time and memory complexity. We perform extensive experiments to show that the inductive bias embodied by our hierarchical attention is effective in capturing the hierarchical structure in the sequences typical for natural language and vision tasks. Our method is superior to alternative sub-quadratic proposals by over +6 points on average on the Long Range Arena benchmark. It also sets a new SOTA test perplexity on One-Billion Word dataset with 5x fewer model parameters than that of the previous-best Transformer-based models.",
    "creator" : "LaTeX with hyperref"
  }
}