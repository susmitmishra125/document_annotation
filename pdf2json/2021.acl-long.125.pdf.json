{
  "name" : "2021.acl-long.125.pdf",
  "metadata" : {
    "source" : "META",
    "title" : "Topic-Driven and Knowledge-Aware Transformer for Dialogue Emotion Detection",
    "authors" : [ "Lixing Zhu", "Gabriele Pergola", "Lin Gui", "Deyu Zhou", "Yulan He" ],
    "emails" : [ "lixing.zhu@warwick.ac.uk", "gabriele.pergola@warwick.ac.uk", "lin.gui@warwick.ac.uk", "yulan.he@warwick.ac.uk", "d.zhou@seu.edu.cn" ],
    "sections" : [ {
      "heading" : null,
      "text" : "Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing, pages 1571–1582\nAugust 1–6, 2021. ©2021 Association for Computational Linguistics\n1571"
    }, {
      "heading" : "1 Introduction",
      "text" : "The abundance in dialogues extracted from online conversations and TV series provides unprecedented opportunity to train models for automatic emotion detection, which are important for the development of empathetic conversational agents or chat bots for psychotherapy (Hsu and Ku, 2018; Jiao et al., 2019; Zhang et al., 2019; Cao et al., 2019). However, it is challenging to capture the contextual semantics of personal experience described in one’s utterance. For example, the emotion of the sentence “I just passed the exam” can be either happy or sad depending on the expectation of the subject. There are strands of works utilizing the dialogue context to enhance the utterance representation (Jiao et al., 2019; Zhang et al., 2019;\nMajumder et al., 2019), where influences from historical utterances were handled by recurrent units, and attention signals were further introduced to intensify the positional order of the utterances.\nDespite the progress made by the aforementioned methods, detecting emotions in dialogues is however still a challenging task due to the way emotions are expressed and how the meanings of utterances vary based on the particular topic discussed, as well as the implicit knowledge shared between participants. Figure 1 gives an example of how topics and background knowledge could impact the mood of interlocutors. Normally, dialogues around specific topics carry certain language patterns (Serban et al., 2017), affecting not only the utterance’s meaning, but also the particular emo-\ntions conveyed by specific expressions. Existing dialogue emotion detection methods did not put emphasis on modelling these holistic properties of dialogues (i.e., conversational topics and tones). Consequently, they were fundamentally limited in capturing the affective states of interlocutors related to the particular themes discussed. Besides, emotion and topic detection heavily relies on leveraging underlying commonsense knowledge shared between interlocutors. Although there have been attempts in incorporating it, such as the COSMIC (Ghosal et al., 2020), existing approaches do not perform fine-grained extraction of relevant information based on both the topics and the emotions involved.\nRecently, the Transformer architecture (Vaswani et al., 2017) has empowered language models to transfer large quantities of data to low-resource domains, making it viable to discover topics in conversational texts. In this paper, we propose to add an extra layer to the pre-trained language model to model the latent topics, which is learned by fine-tuning on dialogue datasets to alleviate the data sparsity problem. Inspired by the success of Transformers, we use the Transformer EncoderDecoder structure to perform the Seq2Seq prediction in which an emotion label sequence is predicted given an utterance sequence (i.e., each utterance is assigned with an emotion label). We posit that the dialogue emotion of the current utterance depends on the historical dialogue context and the predicted emotion label sequence for the past utterances. We leverage the attention mechanism and the gating mechanism to incorporate commonsense knowledge retrieved by different approaches. Code and trained models are released to facilitate further research1. To sum up, our contributions are:\n• We are the first to propose a topic-driven approach for dialogue emotion detection. We propose to alleviate the low-resource setting by topic-driven fine-tuning using pre-trained language models. • We utilize a pointer network and an additive attention to integrate commonsense knowledge from multiple sources and dimensions. • We develop a Transformer Encoder-Decoder structure as a replacement of the commonlyused recurrent attention neural networks for dialogue emotion detection.\n1http://github.com/something678/TodKat."
    }, {
      "heading" : "2 Related Work",
      "text" : "Dialogue Emotion Detection Majumder et al. (2019) recognized the importance of dialogue context in dialogue emotion detection. They used a Gated Recurrent Unit (GRU) to capture the global context which is updated by the speaker ad-hoc GRUs. At the same time, Jiao et al. (2019) presented a hierarchical neural network model that comprises two GRUs for the modelling of tokens and utterances respectively. Zhang et al. (2019) explicitly modelled the emotional dependencies on context and speakers using a Graph Convolutional Network (GCN). Meanwhile, Ghosal et al. (2019) extended the prior work (Majumder et al., 2019) by taking into account the intra-speaker dependency and relative position of the target and context within dialogues. Memory networks have been explored in (Jiao et al., 2020) to allow bidirectional influence between utterances. A similar idea has been explored by Li et al. (2020b). While the majority of works have been focusing on textual conversations, Zhong et al. (2019) enriched utterances with concept representations extracted from the ConceptNet (Speer et al., 2017). Ghosal et al. (2020) developed COSMIC which exploited ATOMIC (Sap et al., 2019) for the acquisition of commonsense knowledge. Different from existing approaches, we propose a topic-driven and knowledge-aware model built on a Transformer Encoder-Decoder structure for dialogue emotion detection.\nLatent Variable Models for Dialogue Context Modelling Latent variable models, normally described in their neural variational inference form named Variational Autoencoder (VAE) (Kingma and Welling, 2014), has been studied extensively to learn thematic representations of individual documents (Miao et al., 2016; Srivastava and Sutton, 2017; Rezaee and Ferraro, 2020). They have been successfully employed for dialogue generation to model thematic characteristics over dynamically evolving conversations. This line of work, which inlcudes approaches based on hierarchical recurrent VAEs (Serban et al., 2017; Park et al., 2018; Zeng et al., 2019) and conditional VAEs (Sohn et al., 2015; Shen et al., 2018; Gao et al., 2019), encodes each utterance with historical latent codes and autoregressively reconstructs the input sequence.\nOn the other hand, pre-trained language models are used as embedding inputs to VAE-based mod-\nels (Peinelt et al., 2020; Asgari-Chenaghlu et al., 2020). Recent work by Li et al. (2020a) employs BERT and GPT-2 as the encoder-decoder structure of VAE. However, these models have to be either trained from scratch or built upon pre-trained embeddings. They therefore cannot be directly applied to the low-resource setting of dialogue emotion detection.\nKnowledge Base and Knowledge Retrieval ConceptNet (Speer et al., 2017) captures commonsense concepts and relations as a semantic network, which encompasses the spatial, physical, social, temporal, and psychological aspects of everyday life. More recently, Sap et al. (2019) built ATOMIC, a knowledge graph centered on events rather than entities. Owing to the expressiveness of events and ameliorated relation types, using ATOMIC achieved competitive results against human evaluation in the task of If-Then reasoning.\nAlongside the development of knowledge bases, recent years have witnessed the thrive of new methods for training language models from large-scale text corpora as implicit knowledge base. As has been shown in (Petroni et al., 2019), pre-trained language models perform well in recalling relational knowledge involving triplet relations about entities. Bosselut et al. (2019) proposed COMmonsEnse Transformers (COMET) which learns to generate commonsense descriptions in natural language by fine-tuning pre-trained language models on existing commonsense knowledge bases such as ATOMIC. Compared with extractive methods, language models fine-tuned on knowledge bases have a distinctive advantage of being able to generate knowledge for unseen events, which is of great importance for tasks which require the incorporation of commonsense knowledge such as emotion detection in dialogues."
    }, {
      "heading" : "3 Methodology",
      "text" : ""
    }, {
      "heading" : "3.1 Problem Setup",
      "text" : "A dialogue is defined as a sequence of utterances {x1, x2, . . . , xN}, which is annotated with a sequence of emotion labels {y1, y2, . . . , yN}. Our goal is to develop a model that can assign the correct label to each utterance. As for each utterance, the raw input is a token sequence, i.e., xn = {wn,1, wn,2, . . . , wn,Mn} where Mn denotes the length of an utterance. We address this problem using the Seq2Seq framework (Sutskever et al.,\n2014), in which the model consecutively consumes an utterance xn and predicts the emotion label yn based on the earlier utterances and their associated predicted emotion labels. The joint probability of emotion labels for a dialogue is:\nPθ(y1:N |x1:N ) = N∏ n=1 Pθ(yn|x≤n, y<n) (1)\nIt is worth mentioning that the subsequent utterances are unseen to the model at each predictive step. Learning is performed via optimizing the log-likelihoods of predicted emotion labels.\nThe overall architecture of our proposed TOpic-Driven and Knowledge-Aware Transformer (TODKAT) is shown in Figure 2, which consists of two main components, the topic-driven language model fine tuned on dialogues, and the knowledgeaware transformer for emotion label sequence prediction for a given dialogue. In what follows, we will describe each of the components in turn."
    }, {
      "heading" : "3.2 Topic Representation Learning",
      "text" : "We propose to insert a topic layer into an existing language model and fine-tune the pre-trained language model on the conversational text for topic representation learning. Topic models, often formulated as latent variable models, play a vital role in dialogue modeling (Serban et al., 2017) due to the explicit modeling of ‘high-level syntactic features such as style and topic’ (Bowman et al., 2016). Despite the tremendous success of applying topic modeling in dialogue generation (Sohn et al., 2015; Shen et al., 2018; Gao et al., 2019), there is scarce work exploiting latent variable models for dialogue emotion detection. To this end, we borrow the architecture from VHRED (Serban et al., 2017) for topic discovery, with the key modification that both the encoder RNN and decoder RNN are replaced by layers of a pre-trained language model. Furthermore, we use a transformer multi-head attention in replacement of the LSTM to model the dependence between the latent topic vectors. Unlike VHRED, we are interested in the encoder part to extract the posterior of the latent topic z, rather than the recurrent prior of z in the decoder part since the latter is intended for dialogue generation. We assume that each utterance is mapped to a latent variable encoding its internal topic, and impose a sequential dependence on the topic transitions. Figure 2a gives an overview of the VAE-based model which\naims at learning the latent topic vector during the fine-tuning of the language model.\nSpecifically, the pre-trained language model is decomposed into two parts, the encoder and the decoder. By retaining the pre-trained weights, we transfer representations from high-resource tasks to the low-resource setting, which is the case for dialogue emotion datasets.\nEncoder The training of topic discovery part of TODKAT comprises a VAE at each time step, with its latent variable dependent on the previous latent code. Each utterance is input to the VAE encoder with a recurrent hidden state, the output of which is a latent vector ideally encoding the topic discussed in the utterance. The latent vectors are tied through a recurrent hidden state to constraint a coherent topic over a single dialogue. We use LMφ to denote the network of lower layers of the language model (before the topic layer) and xLn to denote the output from LMφ given the input xn. The variational distribution for the approximation of the posterior will be:\nqφ(zn|x≤n,z<n) = N ( zn|fµφ(x L n , hn−1), fσφ(x L n , hn−1) ) ,\n(2)\nwhere hn−1 = fτ (zn−1, x L n−1), for n > 1. (3)\nHere, fµφ(·) and fσφ(·) are multi-layer perceptrons (MLPs), fτ can be any transition function (e.g., a recurrent unit). We employ the transformer multi-head attention with its query being the previous latent variable zn−1, that is,\nfτ (zn−1, x L n−1) = Attention(zn−1, x L n−1, x L n−1). (4)\nWe initialize h0 = 0 and model the transition between hn−1 and hn by first generating zn from hn−1 using Eq. (2), then calculating hn by Eq. (3).\nDecoder The decoder network reconstructs xn from zn at each time step. We use Gaussian distributions for both the generative prior and the variational distribution. Since we want zn to be dependent on zn−1, the prior for zn is p(zn|hn−1) = N ( zn|fµγ (hn−1), fσγ (hn−1) ) . where fµγ (·) and fσγ (·) are MLPs. The posterior for zn is pθ(zn|x≤n, z<n), which is intractable and is approximated by qφ(zn|x≤n, z<n) of Eq. 2. We denote the higher layers of the language model as LMθ. Then the reconstruction of x̂n given zn and xLn can be expressed as:\nx̂n = LMθ(zn, x L n). (5)\nNote that this is different from dialogue generation in which an utterance is generated from the latent topic vector. Here, we aim to extract the latent topic from the current utterance and therefore train the model to reconstruct the input utterance as specified in Eq. (5). To make the combination of zn and xLn compatible for LMθ, we need to perform the latent vector injection. As in (Li et al., 2020a), we employ the “Memory” scheme that zn becomes an additional input for LMθ, that is, the input to the higher layers becomes [zn, xLn ].\nTraining The training objective is the Evidence Lower Bound (ELBO):\nEqφ(z≤N |x≤N )[log pθ(x≤N |z≤N )] −KL[qφ(z≤N |x≤N )||p(z≤N )].\n(6)\nEq. 6 factorizes and the expectation term becomes\nEqφ(z≤N |x≤N ) [ N∑ n=1 log pθ(xn|z≤n,x<n) ] , (7)\nand the KL term becomes\nN∑ n=1 KL[qφ(zn|x≤n, z<n)||p(zn|z<n,x<n)], (8)\nwhere p(zn|z<n,x<n) is the prior for zn. After training, we are able to extract the topic representation from the encoder part of the model, which is denoted as zn = LMencφ (xn). Meanwhile, the entire language model has been fine-tuned, which is denoted as un = LMCLS(xn)."
    }, {
      "heading" : "3.3 Knowledge-Aware Transformer",
      "text" : "The topic-driven LM fine-tuning stage makes it possible for the LM to discover a topic representation from a given utterance. After fine-tuning, we attach the fine-tuned components to a classifier and train the classifier to predict the emotion labels. We propose to use the Transformer EncoderDecoder structure as the classifier, and consider the incorporation of commonsense knowledge retrieved from external knowledge sources. In what follows, we first describe how to retrieve the commonsense knowledge from a knowledge source, then we present the detailed structure of the classifier.\nCommonsense Knowledge Retrieval We use ATOMIC2 as a source of external knowledge. In ATOMIC, each node is a phrase describing an event. Edges are relation types linking from one event to another. ATOMIC thus encodes triples such as 〈event, relation type, event〉. There are a total of nine relation types, of which three are used: xIntent, the intention of the subject (e.g., ‘to get a raise’), xReact, the reaction of the subject (e.g., ‘be tired’), and oReact, the reaction of the object (e.g., ‘be worried’), since they are defined as the mental states of an event (Sap et al., 2019).\nGiven an utterance xn, we can compare it with every node in the knowledge graph, and retrieve the most similar one. The method for computing the similarity between an utterance and events is SBERT (Reimers and Gurevych, 2019). We extract the top-K events, and obtain their intentions and reactions, which are denoted as {esIn,k, esRn,k, eoRn,k}, k = 1, . . . ,K.\nOn the other hand, there is a knowledge gen-\n2https://homes.cs.washington.edu/ ˜msap/atomic/\neration model, called COMET3, which is trained on ATOMIC. It can take xn as input and generate the knowledge with the desired event relation types specified (e.g., xIntent, xReact or oReact). The generated knowledge can be unseen in ATOMIC since COMET is essentially a finetuned language model. We use COMET to generate the K most likely events, each with respect to the three event relation types. The produced events are denoted as {gsIn,k, gsRn,k, goRn,k}, k = 1, . . . ,K.\nKnowledge Selection With the knowledge retrieved from ATOMIC, we build a pointer network (Vinyals et al., 2015) to exclusively choose the commonsense knowledge either from SBERT or COMET. The pointer network calculates the probability of choosing the candidate knowledge source as:\nP ( I(xn, en, gn) = 1 ) = σ ( [xn, en, gn]Wσ ) ,\nwhere I(xn, en, gn) is an indicator function with value 1 or 0, and σ(x) = 1/(1+exp(−x)). We envelope σ with Gumbel Softmax (Jang et al., 2017) to generate the one-hot distribution4. The integrated commonsense knowledge is expressed as\ncn = I(xn, en, gn)en + ( 1− I(xn, en, gn) ) gn,\nwhere cn = {csIn,k, csRn,k, coRn,k}Kk=1. With the knowledge source selected, we proceed to select the most informative knowledge. We design an attention mechanism (Bahdanau et al., 2015) to integrate the candidate knowledge. Recall that we have a fine-tuned language model which can calculate both the [CLS] and topic representations. Here we apply the language model to the retrieved or generated knowledge to obtain the [CLS] and the topic representation, denoted as [cn,k, zn,k]. The attention mechanism is performed by calculating the dot product between the utter-\n3https://github.com/atcbosselut/ comet-commonsense\n4We have also experimented with a soft gating mechanism by aggregating knowledge from SBERT and COMET in a weighted manner. But the results are consistently worse than those using a hard gating mechanism.\nance and each normalized knowledge tuple: vk = tanh ( [cn,k, zn,k]Wα ) , (9)\nαk = exp ( vk[zn, un] >)∑ k exp ( vk[zn, un]>\n) , (10) cn =\nK∑ k=1 αkcn,k. (11)\nHere, we abuse cn to represent the aggregated knowledge phrases. We further aggregate cn by event relation types using a self-attention and the final event representation is denoted as cn.\nTransformer Encoder-Decoder We use a Transformer encoder-decoder to map an utterance sequence to an emotion label sequence, thus allowing for modeling the transitional patterns between emotions and taking into account the historical utterances as well. Each utterance is converted to the [CLS] representation concatenated with the topic representation zn and knowledge representation cn. We enforce a masking scheme in the self-attention layer of the encoder to make the classifier predict emotions in an auto-regressive way, entailing that only the past utterances are visible to the encoder. This masking strategy, preventing the query from attending to future keys, suits better a real-world scenario in which the subsequent utterances are unseen when predicting an emotion of the current utterance. As for the decoder, the output of the previous decoder block is input as a query to the self-attention layer. The training loss for the classifier is the negative log-likelihood expressed as:\nL = − N∑ n=1 log pθ(yn|u≤n,y<n),\nwhere θ denotes the trainable parameters."
    }, {
      "heading" : "4 Experimental Setup",
      "text" : "In this section, we present the details of the datasets used, the methods for comparison, and the implementation details of our models.\nDatasets We use the following datasets for experimental evaluation: DailyDialog (Li et al., 2017) is collected from daily communications. It takes the Ekman’s six emotion types (Ekman, 1993) as the annotation protocol, that is, it annotates an utterance with one of the six basic emotions: anger, disgust, fear, happiness,\nsadness, or surprise. Those showing ambiguous emotions are annotated as neutral. MELD (Poria et al., 2019) is constructed from scripts of ‘Friends’, a TV series on urban life. Same as DailyDialog, the emotion label falls into Ekman’s six emotion types, or neutral. IEMOCAP (Busso et al., 2008) is built with subtitles from improvised videos. Its emotion labels are happy, sad, neutral, angry, excited and frustrated. EmoryNLP (Zahiri and Choi, 2018)5 is also built with conversations from ‘Friends’ TV series, but with a slightly different annotation scheme in which disgust, anger and surprise become peaceful, mad and powerful, respectively.\nFollowing Zhong et al. (2019) and Ghosal et al. (2020), the ‘neutral’ label of DailyDialog is not counted in the evaluation to avoid highly imbalanced classes. For MELD and EmoryNLP, we consider a dialogue as a sequence of utterances from the same scene ID. Table 1 summarizes the statistics of each dataset.\nBaselines We compare the performance of TODKAT with the following methods: HiGRU (Jiao et al., 2019) simply inherits the recurrent attention framework that an attention layer is placed between two GRUs to aggregate the signals from the encoder GRU and pass them to the decoder GRU. DialogueGCN (Ghosal et al., 2019) creates a graph from interactions of speakers to take into account the dialogue structure. A Graph Convolutional Network (GCN) is employed to encode the speakers. Emotion labels are predicted with the combinations of the global context and speakers’ status.\n5https://github.com/emorynlp/ emotion-detection\nKET (Zhong et al., 2019) is the first model which integrates common-sense knowledge extracted from ConceptNet and emotion information from an emotion lexicon into conversational text. A Transformer encoder is employed to handle the influence from past utterances. COSMIC (Ghosal et al., 2020) is the state-of-theart approach that leverages ATOMIC for improved emotion detection. COMET is employed in their model to retrieve the event-eccentric commonsense knowledge from ATOMIC.\nWe modified the script6 of language model finetuning in the Hugging Face library (Wolf et al., 2020) for the implementation of topic-driven finetuning. We use one transformer encoder layer. As for the decoder, there are N layers where N is the number of utterances in a dialogue. We refer the readers to the Appendix for the detailed settings of the proposed models."
    }, {
      "heading" : "5 Results and Analysis",
      "text" : "Comparison with Baselines Experiment results of TODKAT and its ablations are reported in Table 2. HiGRU and DialogueGCN results were produced by running the code published by the authors on the four datasets. Among the baselines, COSMIC gives the best results. Our proposed TODKAT outperforms COSMIC on both MELD and EmoryNLP in weighted Avg-F1 with the improvements ranging between 3-5%. TODKAT also achieves superior result than COSMIC on DailyDi-\n6https://huggingface.co/transformers/ v2.0.0/examples.html\nalogue in Macro-F1 and gives nearly the same result in Micro-F1. TODKAT is inferior to COSMIC on IEMOCAP. It is however worth mentioning that COSMIC was trained with 132 instances on this dataset, while for all the other models the trainingand-validation split is 100 and 20. As such, the IEMOCAP results reported on COSMIC (Ghosal et al., 2020) are not directly comparable here. COSMIC also incorporates the commonsense knowledge from ATOMIC but with the modified GRUs. Our proposed TODKAT, built upon the topic-driven Transformer, appears to be a more effective architecure for dialogue emotion detection. Compared with KET, the improvements are much more significant, with over 10% increase on MELD, and close to 5% gain on DailyDialog. KET is also built on the Transformer, but it considers each utterance in isolation and applies commonsense knowledge from ConceptNet. TODKAT, on the contrary, takes into account the dependency of previous utterances and their associated emotion labels for the prediction of the emotion label of the current utterance. DialogueGCN models interactions of speakers and it performs slightly better than KET. But it is significantly worse than TODKAT. It seems that topics might be more useful in capturing the dialogue context.\nAblation Study The lower half of Table 2 presents the F1 scores with the removal of various components from TODKAT. It can be observed that with the removal of the topic component, the performance of TODKAT drops consistently across all datasets except IEMOCAP in which we ob-\nserve a slight increase in both weighted average F1 and Micro-F1. This might be attributed to the size of the data since IEMOCAP is the smallest dataset evaluated here, and small datasets hinder the model’s capability to discover topics. Without using the commonsense knowledge (‘−KB’), we observe more drastic performance drop compared to all other components, with nearly 10% drop in F1 on EmoryNLP, showing the importance of employing commonsense knowledge for dialogue emotion detection. Comparing two different ways of extracting knowledge from ATOMIC, direct retrieval using SBERT or generation using COMET, we observe mixed results. Overall, the Transformer EncoderDecoder with a pointer network is a conciliator between the two methods, yielding a balanced performance across the datasets.\nRelationships between Topics and Emotions To investigate the effectiveness of the learned topic vectors, we perform t-SNE (Van der Maaten and Hinton, 2008) on the test set to study the relationship between the learned topic vectors and the ground-truth emotion labels. The results on DailyDialog and MELD are illustrated in Figure 3(a) and (b). Latent topic vectors of utterance are used to plot the data points, whose colors indicate their ground-truth emotion labels. We can see that the majority of the topic vectors cluster into polarized groups. Few clusters are bearing a mixture of polarity, possibly due to the background topics such as greetings in the datasets.\nTopics can be interpreted using the attention scores of Eq. 4. The top-10 most-attended words are selected as the representative words for each utterance. As in (Dathathri et al., 2020), we construct bag-of-words7 that represent 141 distinct topics. Given the attended words of an utterance cluster grouped based on their latent topic representations, we label the word collection with the dominant theme name. We refer to the theme names as topics in Figure 3c. It can be observed that utterances associated with Office tend to carry ‘disgust’ emotions, while those related to Family are prone to be\n‘happy’. We further compute the Spearman’s rank-order\ncorrelation coefficient to quantitatively verify the relationship between the topic and emotion vectors. For an utterance pair, a similarity score is\n7Word lists and their corresponding theme names are crawled from https://www.enchantedlearning. com/wordlist/.\nobtained separately for their corresponding topic vectors as well as their emotion vectors. We then sort the list of emotion vector pairs according to their similarity scores to check to what extent their ranking matches that of topic vector pairs, based on the Spearman’s rank-order correlation coefficient. The results are 0.60, 0.58, 0.42 and 0.54 with p-values 0.01 respectively for DailyDialog, MELD, IEMOCAP and EmoryNLP, showing that there is a strong correlation between the clustering of topics and that of emotion labels. IEMOCAP has the lowest correlation score, which is inline with the results in Table 2 that the discovered latent topics did not improve the emotion classification results.\nImpact of Relation Type We investigate the impact of commonsense relation types on the performance of TODKAT. We expand the relation set to five relation types and all nine relation types, respectively. According to (Sap\net al., 2019), there are other relation types including {sNeed, sWant, oWant, sEffect, oEffect}, which identifies the prerequisites and post conditions of the given event, and {sAttr}, the “If-Event-ThenPersona” category of relation type that describes how the subject is perceived by others. We calculate the Micro-F1 scores of TODKAT with these two categories of relation types added step by step. From Table 3 we can conclude that the inclusion of two extra relation types or all relation types degrades the F1 scores on almost all datasets. An exception occurs on IEMOCAP where the F1 score rises by 0.5% when adding “sE” and “oE” relations, possibly due to the fact that the dataset is abundant in events. Hence the extra event descriptions offer complementary knowledge to some extent. While on other datasets neither the incorporation of “If-Event-Then-Event” nor the incorporation of “If-Event-Then-Persona” relation types could bring any benefit.\nImpact of Attention Mechanism With the knowledge retrieved from ATOMIC or generated from COMET, we are able to infer the possible intentions and reactions of the interlocutors. However, not all knowledge phrases contribute the same to the emotion of the focused utterance. We study the attention mechanism in terms of selecting the relevant knowledge. We show in Table 4 a heat map of the attention scores in Eq. 9 to illustrate how the topic-driven attention could identify the most salient phrase. The utterance ‘Oh my God, you’re a freak.’ will be erroneously categorized as ‘mad’ without using the topic-driven attention (shown in the last row of Table 4). In contrast, the attention mechanism guides the model to attend to the more relevant events and thus predict the correct emotion label."
    }, {
      "heading" : "6 Conclusion",
      "text" : "We have proposed a Topic-Driven and KnowledgeAware Transformer model that incorporates topic representation and the commonsense knowledge from ATOMIC for emotion detection in dialogues. A topic-augmented language model based on finetuning has been developed for topic extraction. Pointer network and additive attention have been explored for knowledge selection. All the novel components have been integrated into the Transformer Encoder-Decoder structure that enables Seq2Seq prediction. Empirical results demonstrate the effectiveness of the model in topic representation learning and knowledge integration, which have both boosted the performance of emotion detection."
    }, {
      "heading" : "Acknowledgements",
      "text" : "The authors would like to thank the anonymous reviewers for insightful comments and helpful suggestions. This work was funded by the EPSRC (grant no. EP/T017112/1, EP/V048597/1). LZ is funded by the Chancellor’s International Scholarship at the University of Warwick. YH is supported by a Turing AI Fellowship funded by the UK Research and Innovation (grant no. EP/V020579/1). DZ is funded by the National Key Research and Development Program of China (2017YFB1002801) and the National Natural Science Foundation of China (61772132)."
    }, {
      "heading" : "A Appendices",
      "text" : "A.1 Settings We modified the script8 of language model finetuning in the Hugging Face library (Wolf et al., 2020) for the implementation of topic-driven finetuning. On each training set, we train the topic model for 3 epochs, with learning rate set to 5e-5 to prevent overfitting to the low-resource dataset. The classifier is built on the Transformers9 package in Hugging Face. The language model we employ is RoBERTa (Liu et al., 2019). Each utterance is padded by the <pad> token of RoBERTa if it is less than the maximum length of 128. The maximum number of utterances in a dialogue is set to 36, 25, 72 and 25 respectively for DailyDialog (Li et al., 2017) 10, MELD (Poria et al., 2019) 11, IEMOCAP (Busso et al., 2008) 12 and EmoryNLP (Zahiri and Choi, 2018) 13. Dialogues with shorter lengths are padded with NULL. It is worth noting that this step is performed after RoBERTa due to the random noises introduced by RoBERTa. The number of retrieved or generated events from ATOMIC under the relation types ‘intentions’ and ‘reactions’ is both set to 5, i.e., K = 5.\n8https://huggingface.co/transformers/ v2.0.0/examples.html\n9https://huggingface.co/transformers/ 10http://yanran.li/dailydialog.html 11https://github.com/declare-lab/MELD 12https://sail.usc.edu/iemocap/iemocap_\nrelease.htm 13https://github.com/emorynlp/ emotion-detection"
    } ],
    "references" : [ {
      "title" : "Topicbert: A transformer transfer learning based memory-graph approach for multimodal streaming social media topic detection",
      "author" : [ "Meysam Asgari-Chenaghlu", "Mohammad-Reza FeiziDerakhshi", "Mohammad-Ali Balafar", "Cina Motamed." ],
      "venue" : "arXiv",
      "citeRegEx" : "Asgari.Chenaghlu et al\\.,? 2020",
      "shortCiteRegEx" : "Asgari.Chenaghlu et al\\.",
      "year" : 2020
    }, {
      "title" : "Neural machine translation by jointly learning to align and translate",
      "author" : [ "Dzmitry Bahdanau", "Kyunghyun Cho", "Yoshua Bengio." ],
      "venue" : "Proceedings of the 3rd International Conference on Learning Representations (ICLR).",
      "citeRegEx" : "Bahdanau et al\\.,? 2015",
      "shortCiteRegEx" : "Bahdanau et al\\.",
      "year" : 2015
    }, {
      "title" : "Comet: Commonsense transformers for automatic knowledge graph construction",
      "author" : [ "Antoine Bosselut", "Hannah Rashkin", "Maarten Sap", "Chaitanya Malaviya", "Asli Celikyilmaz", "Yejin Choi." ],
      "venue" : "Proceedings of the 57th Annual Meeting of the Association",
      "citeRegEx" : "Bosselut et al\\.,? 2019",
      "shortCiteRegEx" : "Bosselut et al\\.",
      "year" : 2019
    }, {
      "title" : "Generating sentences from a continuous space",
      "author" : [ "Samuel Bowman", "Luke Vilnis", "Oriol Vinyals", "Andrew Dai", "Rafal Jozefowicz", "Samy Bengio." ],
      "venue" : "Proceedings of The 20th SIGNLL Conference on Computational Natural Language Learning, pages",
      "citeRegEx" : "Bowman et al\\.,? 2016",
      "shortCiteRegEx" : "Bowman et al\\.",
      "year" : 2016
    }, {
      "title" : "Iemocap: Interactive emotional dyadic motion capture database",
      "author" : [ "Carlos Busso", "Murtaza Bulut", "Chi-Chun Lee", "Abe Kazemzadeh", "Emily Mower", "Samuel Kim", "Jeannette N Chang", "Sungbok Lee", "Shrikanth S Narayanan." ],
      "venue" : "Language re-",
      "citeRegEx" : "Busso et al\\.,? 2008",
      "shortCiteRegEx" : "Busso et al\\.",
      "year" : 2008
    }, {
      "title" : "Observing dialogue in therapy: Categorizing and forecasting behavioral codes",
      "author" : [ "Jie Cao", "Michael Tanana", "Zac Imel", "Eric Poitras", "David Atkins", "Vivek Srikumar." ],
      "venue" : "Proceedings of the 57th Annual Meeting of the Association for Computational Lin-",
      "citeRegEx" : "Cao et al\\.,? 2019",
      "shortCiteRegEx" : "Cao et al\\.",
      "year" : 2019
    }, {
      "title" : "Plug and play language models: A simple approach to controlled text generation",
      "author" : [ "Sumanth Dathathri", "Andrea Madotto", "Janice Lan", "Jane Hung", "Eric Frank", "Piero Molino", "Jason Yosinski", "Rosanne Liu." ],
      "venue" : "Proceedings of the 8th International Conference on",
      "citeRegEx" : "Dathathri et al\\.,? 2020",
      "shortCiteRegEx" : "Dathathri et al\\.",
      "year" : 2020
    }, {
      "title" : "Facial expression and emotion",
      "author" : [ "Paul Ekman." ],
      "venue" : "American psychologist, 48(4):384.",
      "citeRegEx" : "Ekman.,? 1993",
      "shortCiteRegEx" : "Ekman.",
      "year" : 1993
    }, {
      "title" : "A discrete cvae for response generation on short-text conversation",
      "author" : [ "Jun Gao", "Wei Bi", "Xiaojiang Liu", "Junhui Li", "Guodong Zhou", "Shuming Shi." ],
      "venue" : "Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the",
      "citeRegEx" : "Gao et al\\.,? 2019",
      "shortCiteRegEx" : "Gao et al\\.",
      "year" : 2019
    }, {
      "title" : "COSMIC: COmmonSense knowledge for eMotion identification in conversations",
      "author" : [ "Deepanway Ghosal", "Navonil Majumder", "Alexander Gelbukh", "Rada Mihalcea", "Soujanya Poria." ],
      "venue" : "Findings of the Association for Computational Linguistics: EMNLP",
      "citeRegEx" : "Ghosal et al\\.,? 2020",
      "shortCiteRegEx" : "Ghosal et al\\.",
      "year" : 2020
    }, {
      "title" : "Dialoguegcn: A graph convolutional neural network for emotion recognition in conversation",
      "author" : [ "Deepanway Ghosal", "Navonil Majumder", "Soujanya Poria", "Niyati Chhaya", "Alexander Gelbukh." ],
      "venue" : "Proceedings of the 2019 Conference on Empirical Methods",
      "citeRegEx" : "Ghosal et al\\.,? 2019",
      "shortCiteRegEx" : "Ghosal et al\\.",
      "year" : 2019
    }, {
      "title" : "SocialNLP 2018 EmotionX challenge overview: Recognizing emotions in dialogues",
      "author" : [ "Chao-Chun Hsu", "Lun-Wei Ku." ],
      "venue" : "Proceedings of the Sixth International Workshop on Natural Language Processing for Social Media, pages 27–31, Melbourne,",
      "citeRegEx" : "Hsu and Ku.,? 2018",
      "shortCiteRegEx" : "Hsu and Ku.",
      "year" : 2018
    }, {
      "title" : "Categorical reparameterization with gumbel-softmax",
      "author" : [ "Eric Jang", "Shixiang Gu", "Ben Poole." ],
      "venue" : "Proceedings of the 5th International Conference on Learning Representations (ICLR).",
      "citeRegEx" : "Jang et al\\.,? 2017",
      "shortCiteRegEx" : "Jang et al\\.",
      "year" : 2017
    }, {
      "title" : "Real-time emotion recognition via attention gated hierarchical memory network",
      "author" : [ "Wenxiang Jiao", "Michael Lyu", "Irwin King." ],
      "venue" : "Proceedings of the AAAI Conference on Artificial Intelligence, volume 34, pages 8002–8009.",
      "citeRegEx" : "Jiao et al\\.,? 2020",
      "shortCiteRegEx" : "Jiao et al\\.",
      "year" : 2020
    }, {
      "title" : "Higru: Hierarchical gated recurrent units for utterance-level emotion recognition",
      "author" : [ "Wenxiang Jiao", "Haiqin Yang", "Irwin King", "Michael R Lyu." ],
      "venue" : "Proceedings of the 2019 Conference of the North American Chapter of the Association for Computa-",
      "citeRegEx" : "Jiao et al\\.,? 2019",
      "shortCiteRegEx" : "Jiao et al\\.",
      "year" : 2019
    }, {
      "title" : "Autoencoding variational bayes",
      "author" : [ "Diederik P Kingma", "Max Welling." ],
      "venue" : "Proceedings of the 2nd International Conference on Learning Representations (ICLR).",
      "citeRegEx" : "Kingma and Welling.,? 2014",
      "shortCiteRegEx" : "Kingma and Welling.",
      "year" : 2014
    }, {
      "title" : "Optimus: Organizing sentences via pre-trained modeling of a latent space",
      "author" : [ "Chunyuan Li", "Xiang Gao", "Yuan Li", "Baolin Peng", "Xiujun Li", "Yizhe Zhang", "Jianfeng Gao." ],
      "venue" : "Proceedings of the 2020 Conference on Empirical Methods in Natural Language",
      "citeRegEx" : "Li et al\\.,? 2020a",
      "shortCiteRegEx" : "Li et al\\.",
      "year" : 2020
    }, {
      "title" : "Bieru: bidirectional emotional recurrent unit for conversational sentiment analysis",
      "author" : [ "Wei Li", "Wei Shao", "Shaoxiong Ji", "Erik Cambria." ],
      "venue" : "arXiv preprint arXiv:2006.00492.",
      "citeRegEx" : "Li et al\\.,? 2020b",
      "shortCiteRegEx" : "Li et al\\.",
      "year" : 2020
    }, {
      "title" : "Dailydialog: A manually labelled multi-turn dialogue dataset",
      "author" : [ "Yanran Li", "Hui Su", "Xiaoyu Shen", "Wenjie Li", "Ziqiang Cao", "Shuzi Niu." ],
      "venue" : "Proceedings",
      "citeRegEx" : "Li et al\\.,? 2017",
      "shortCiteRegEx" : "Li et al\\.",
      "year" : 2017
    }, {
      "title" : "RoBERTa: A robustly optimized bert pretraining approach",
      "author" : [ "Yinhan Liu", "Myle Ott", "Naman Goyal", "Jingfei Du", "Mandar Joshi", "Danqi Chen", "Omer Levy", "Mike Lewis", "Luke Zettlemoyer", "Veselin Stoyanov." ],
      "venue" : "arXiv preprint arXiv:1907.11692.",
      "citeRegEx" : "Liu et al\\.,? 2019",
      "shortCiteRegEx" : "Liu et al\\.",
      "year" : 2019
    }, {
      "title" : "Visualizing data using t-sne",
      "author" : [ "Laurens Van der Maaten", "Geoffrey Hinton." ],
      "venue" : "Journal of machine learning research, 9(11).",
      "citeRegEx" : "Maaten and Hinton.,? 2008",
      "shortCiteRegEx" : "Maaten and Hinton.",
      "year" : 2008
    }, {
      "title" : "Dialoguernn: An attentive rnn for emotion detection in conversations",
      "author" : [ "Navonil Majumder", "Soujanya Poria", "Devamanyu Hazarika", "Rada Mihalcea", "Alexander Gelbukh", "Erik Cambria." ],
      "venue" : "Proceedings of the AAAI Conference on Artificial Intelligence,",
      "citeRegEx" : "Majumder et al\\.,? 2019",
      "shortCiteRegEx" : "Majumder et al\\.",
      "year" : 2019
    }, {
      "title" : "Neural variational inference for text processing",
      "author" : [ "Yishu Miao", "Lei Yu", "Phil Blunsom." ],
      "venue" : "International Conference on Machine Learning (ICML), pages 1727–1736.",
      "citeRegEx" : "Miao et al\\.,? 2016",
      "shortCiteRegEx" : "Miao et al\\.",
      "year" : 2016
    }, {
      "title" : "A hierarchical latent structure for variational conversation modeling",
      "author" : [ "Yookoon Park", "Jaemin Cho", "Gunhee Kim." ],
      "venue" : "Proceedings of the 2018 Conference of the North American Chapter of the Association for Computational Linguistics: Human Lan-",
      "citeRegEx" : "Park et al\\.,? 2018",
      "shortCiteRegEx" : "Park et al\\.",
      "year" : 2018
    }, {
      "title" : "tBERT: Topic models and BERT joining forces for semantic similarity detection",
      "author" : [ "Nicole Peinelt", "Dong Nguyen", "Maria Liakata." ],
      "venue" : "Proceedings of the 58th Annual Meeting of the Association for Computational Linguistics, pages 7047–7055, Online. As-",
      "citeRegEx" : "Peinelt et al\\.,? 2020",
      "shortCiteRegEx" : "Peinelt et al\\.",
      "year" : 2020
    }, {
      "title" : "Language models as knowledge bases",
      "author" : [ "Fabio Petroni", "Tim Rocktäschel", "Sebastian Riedel", "Patrick Lewis", "Anton Bakhtin", "Yuxiang Wu", "Alexander Miller" ],
      "venue" : "In Proceedings of the 2019 Conference on Empirical Methods in Natural Language",
      "citeRegEx" : "Petroni et al\\.,? \\Q2019\\E",
      "shortCiteRegEx" : "Petroni et al\\.",
      "year" : 2019
    }, {
      "title" : "Meld: A multimodal multi-party dataset for emotion recognition in conversations",
      "author" : [ "Soujanya Poria", "Devamanyu Hazarika", "Navonil Majumder", "Gautam Naik", "Erik Cambria", "Rada Mihalcea." ],
      "venue" : "Proceedings of the 57th Annual Meeting of the As-",
      "citeRegEx" : "Poria et al\\.,? 2019",
      "shortCiteRegEx" : "Poria et al\\.",
      "year" : 2019
    }, {
      "title" : "Sentencebert: Sentence embeddings using siamese bertnetworks",
      "author" : [ "Nils Reimers", "Iryna Gurevych." ],
      "venue" : "Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natu-",
      "citeRegEx" : "Reimers and Gurevych.,? 2019",
      "shortCiteRegEx" : "Reimers and Gurevych.",
      "year" : 2019
    }, {
      "title" : "A discrete variational recurrent topic model without the reparametrization trick",
      "author" : [ "Mehdi Rezaee", "Francis Ferraro." ],
      "venue" : "Advances in Neural Information Processing Systems, volume 33, pages 13831–13843.",
      "citeRegEx" : "Rezaee and Ferraro.,? 2020",
      "shortCiteRegEx" : "Rezaee and Ferraro.",
      "year" : 2020
    }, {
      "title" : "Atomic: An atlas of machine commonsense for ifthen reasoning",
      "author" : [ "Maarten Sap", "Ronan Le Bras", "Emily Allaway", "Chandra Bhagavatula", "Nicholas Lourie", "Hannah Rashkin", "Brendan Roof", "Noah A Smith", "Yejin Choi." ],
      "venue" : "Proceedings of the AAAI Con-",
      "citeRegEx" : "Sap et al\\.,? 2019",
      "shortCiteRegEx" : "Sap et al\\.",
      "year" : 2019
    }, {
      "title" : "A hierarchical latent variable encoder-decoder model for generating dialogues",
      "author" : [ "Iulian Serban", "Alessandro Sordoni", "Ryan Lowe", "Laurent Charlin", "Joelle Pineau", "Aaron Courville", "Yoshua Bengio." ],
      "venue" : "Proceedings of the AAAI Conference on Artificial In-",
      "citeRegEx" : "Serban et al\\.,? 2017",
      "shortCiteRegEx" : "Serban et al\\.",
      "year" : 2017
    }, {
      "title" : "Improving variational encoder-decoders in dialogue generation",
      "author" : [ "Xiaoyu Shen", "Hui Su", "Shuzi Niu", "Vera Demberg." ],
      "venue" : "Proceedings of the AAAI Conference on Artificial Intelligence, volume 32, pages 5456–5463.",
      "citeRegEx" : "Shen et al\\.,? 2018",
      "shortCiteRegEx" : "Shen et al\\.",
      "year" : 2018
    }, {
      "title" : "Learning structured output representation using deep conditional generative models",
      "author" : [ "Kihyuk Sohn", "Honglak Lee", "Xinchen Yan." ],
      "venue" : "Advances in neural information processing systems, volume 28, pages 3483–3491.",
      "citeRegEx" : "Sohn et al\\.,? 2015",
      "shortCiteRegEx" : "Sohn et al\\.",
      "year" : 2015
    }, {
      "title" : "Conceptnet 5.5: An open multilingual graph of general knowledge",
      "author" : [ "Robyn Speer", "Joshua Chin", "Catherine Havasi" ],
      "venue" : "In Proceedings of the AAAI Conference on Artificial Intelligence,",
      "citeRegEx" : "Speer et al\\.,? \\Q2017\\E",
      "shortCiteRegEx" : "Speer et al\\.",
      "year" : 2017
    }, {
      "title" : "Autoencoding variational inference for topic models",
      "author" : [ "Akash Srivastava", "Charles Sutton." ],
      "venue" : "Proceedings of the 5th International Conference on Learning Representations (ICLR).",
      "citeRegEx" : "Srivastava and Sutton.,? 2017",
      "shortCiteRegEx" : "Srivastava and Sutton.",
      "year" : 2017
    }, {
      "title" : "Sequence to sequence learning with neural networks",
      "author" : [ "Ilya Sutskever", "Oriol Vinyals", "Quoc V Le." ],
      "venue" : "Advances in neural information processing systems, volume 27, pages 3104–3112.",
      "citeRegEx" : "Sutskever et al\\.,? 2014",
      "shortCiteRegEx" : "Sutskever et al\\.",
      "year" : 2014
    }, {
      "title" : "Attention is all you need",
      "author" : [ "Ashish Vaswani", "Noam Shazeer", "Niki Parmar", "Jakob Uszkoreit", "Llion Jones", "Aidan N Gomez", "Łukasz Kaiser", "Illia Polosukhin." ],
      "venue" : "Advances in neural information processing systems, volume 30, pages 5998–6008.",
      "citeRegEx" : "Vaswani et al\\.,? 2017",
      "shortCiteRegEx" : "Vaswani et al\\.",
      "year" : 2017
    }, {
      "title" : "Pointer networks",
      "author" : [ "Oriol Vinyals", "Meire Fortunato", "Navdeep Jaitly." ],
      "venue" : "Advances in neural information processing systems, volume 28, pages 2692–2700.",
      "citeRegEx" : "Vinyals et al\\.,? 2015",
      "shortCiteRegEx" : "Vinyals et al\\.",
      "year" : 2015
    }, {
      "title" : "Transformers: State-of-the-art natural language processing",
      "author" : [ "Clara Ma", "Yacine Jernite", "Julien Plu", "Canwen Xu", "Teven Le Scao", "Sylvain Gugger", "Mariama Drame", "Quentin Lhoest", "Alexander Rush." ],
      "venue" : "Proceedings of the 2020 Conference on Em-",
      "citeRegEx" : "Ma et al\\.,? 2020",
      "shortCiteRegEx" : "Ma et al\\.",
      "year" : 2020
    }, {
      "title" : "Emotion detection on tv show transcripts with sequence-based convolutional neural networks",
      "author" : [ "Sayyed M Zahiri", "Jinho D Choi." ],
      "venue" : "Workshops at the Thirty-Second AAAI Conference on Artificial Intelligence.",
      "citeRegEx" : "Zahiri and Choi.,? 2018",
      "shortCiteRegEx" : "Zahiri and Choi.",
      "year" : 2018
    }, {
      "title" : "Dirichlet latent variable hierarchical recurrent encoderdecoder in dialogue generation",
      "author" : [ "Min Zeng", "Yisen Wang", "Yuan Luo." ],
      "venue" : "Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International",
      "citeRegEx" : "Zeng et al\\.,? 2019",
      "shortCiteRegEx" : "Zeng et al\\.",
      "year" : 2019
    }, {
      "title" : "Modeling both context- and speaker-sensitive dependence for emotion detection in multi-speaker conversations",
      "author" : [ "Dong Zhang", "Liangqing Wu", "Changlong Sun", "Shoushan Li", "Qiaoming Zhu", "Guodong Zhou." ],
      "venue" : "Proceedings of the Twenty-",
      "citeRegEx" : "Zhang et al\\.,? 2019",
      "shortCiteRegEx" : "Zhang et al\\.",
      "year" : 2019
    }, {
      "title" : "Knowledge-enriched transformer for emotion detection in textual conversations",
      "author" : [ "Peixiang Zhong", "Di Wang", "Chunyan Miao." ],
      "venue" : "Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International",
      "citeRegEx" : "Zhong et al\\.,? 2019",
      "shortCiteRegEx" : "Zhong et al\\.",
      "year" : 2019
    } ],
    "referenceMentions" : [ {
      "referenceID" : 11,
      "context" : "The abundance in dialogues extracted from online conversations and TV series provides unprecedented opportunity to train models for automatic emotion detection, which are important for the development of empathetic conversational agents or chat bots for psychotherapy (Hsu and Ku, 2018; Jiao et al., 2019; Zhang et al., 2019; Cao et al., 2019).",
      "startOffset" : 268,
      "endOffset" : 343
    }, {
      "referenceID" : 14,
      "context" : "The abundance in dialogues extracted from online conversations and TV series provides unprecedented opportunity to train models for automatic emotion detection, which are important for the development of empathetic conversational agents or chat bots for psychotherapy (Hsu and Ku, 2018; Jiao et al., 2019; Zhang et al., 2019; Cao et al., 2019).",
      "startOffset" : 268,
      "endOffset" : 343
    }, {
      "referenceID" : 41,
      "context" : "The abundance in dialogues extracted from online conversations and TV series provides unprecedented opportunity to train models for automatic emotion detection, which are important for the development of empathetic conversational agents or chat bots for psychotherapy (Hsu and Ku, 2018; Jiao et al., 2019; Zhang et al., 2019; Cao et al., 2019).",
      "startOffset" : 268,
      "endOffset" : 343
    }, {
      "referenceID" : 5,
      "context" : "The abundance in dialogues extracted from online conversations and TV series provides unprecedented opportunity to train models for automatic emotion detection, which are important for the development of empathetic conversational agents or chat bots for psychotherapy (Hsu and Ku, 2018; Jiao et al., 2019; Zhang et al., 2019; Cao et al., 2019).",
      "startOffset" : 268,
      "endOffset" : 343
    }, {
      "referenceID" : 30,
      "context" : "Normally, dialogues around specific topics carry certain language patterns (Serban et al., 2017), affecting not only the utterance’s meaning, but also the particular emo-",
      "startOffset" : 75,
      "endOffset" : 96
    }, {
      "referenceID" : 9,
      "context" : "Although there have been attempts in incorporating it, such as the COSMIC (Ghosal et al., 2020), existing approaches do not perform fine-grained extraction of relevant information based on both the topics and the emotions involved.",
      "startOffset" : 74,
      "endOffset" : 95
    }, {
      "referenceID" : 36,
      "context" : "Recently, the Transformer architecture (Vaswani et al., 2017) has empowered language models to transfer large quantities of data to low-resource domains, making it viable to discover topics in conversational texts.",
      "startOffset" : 39,
      "endOffset" : 61
    }, {
      "referenceID" : 21,
      "context" : "(2019) extended the prior work (Majumder et al., 2019) by taking into account the intra-speaker dependency and relative position of the target and context within dialogues.",
      "startOffset" : 31,
      "endOffset" : 54
    }, {
      "referenceID" : 13,
      "context" : "Memory networks have been explored in (Jiao et al., 2020) to allow bidirectional influence between utterances.",
      "startOffset" : 38,
      "endOffset" : 57
    }, {
      "referenceID" : 29,
      "context" : "(2020) developed COSMIC which exploited ATOMIC (Sap et al., 2019) for the acquisition of commonsense knowledge.",
      "startOffset" : 47,
      "endOffset" : 65
    }, {
      "referenceID" : 15,
      "context" : "Latent Variable Models for Dialogue Context Modelling Latent variable models, normally described in their neural variational inference form named Variational Autoencoder (VAE) (Kingma and Welling, 2014), has been studied extensively to learn thematic representations of individual documents (Miao et al.",
      "startOffset" : 176,
      "endOffset" : 202
    }, {
      "referenceID" : 22,
      "context" : "Latent Variable Models for Dialogue Context Modelling Latent variable models, normally described in their neural variational inference form named Variational Autoencoder (VAE) (Kingma and Welling, 2014), has been studied extensively to learn thematic representations of individual documents (Miao et al., 2016; Srivastava and Sutton, 2017; Rezaee and Ferraro, 2020).",
      "startOffset" : 291,
      "endOffset" : 365
    }, {
      "referenceID" : 34,
      "context" : "Latent Variable Models for Dialogue Context Modelling Latent variable models, normally described in their neural variational inference form named Variational Autoencoder (VAE) (Kingma and Welling, 2014), has been studied extensively to learn thematic representations of individual documents (Miao et al., 2016; Srivastava and Sutton, 2017; Rezaee and Ferraro, 2020).",
      "startOffset" : 291,
      "endOffset" : 365
    }, {
      "referenceID" : 28,
      "context" : "Latent Variable Models for Dialogue Context Modelling Latent variable models, normally described in their neural variational inference form named Variational Autoencoder (VAE) (Kingma and Welling, 2014), has been studied extensively to learn thematic representations of individual documents (Miao et al., 2016; Srivastava and Sutton, 2017; Rezaee and Ferraro, 2020).",
      "startOffset" : 291,
      "endOffset" : 365
    }, {
      "referenceID" : 30,
      "context" : "This line of work, which inlcudes approaches based on hierarchical recurrent VAEs (Serban et al., 2017; Park et al., 2018; Zeng et al., 2019) and conditional VAEs (Sohn et al.",
      "startOffset" : 82,
      "endOffset" : 141
    }, {
      "referenceID" : 23,
      "context" : "This line of work, which inlcudes approaches based on hierarchical recurrent VAEs (Serban et al., 2017; Park et al., 2018; Zeng et al., 2019) and conditional VAEs (Sohn et al.",
      "startOffset" : 82,
      "endOffset" : 141
    }, {
      "referenceID" : 40,
      "context" : "This line of work, which inlcudes approaches based on hierarchical recurrent VAEs (Serban et al., 2017; Park et al., 2018; Zeng et al., 2019) and conditional VAEs (Sohn et al.",
      "startOffset" : 82,
      "endOffset" : 141
    }, {
      "referenceID" : 32,
      "context" : ", 2019) and conditional VAEs (Sohn et al., 2015; Shen et al., 2018; Gao et al., 2019), encodes each utterance with historical latent codes and autoregressively reconstructs the input sequence.",
      "startOffset" : 29,
      "endOffset" : 85
    }, {
      "referenceID" : 31,
      "context" : ", 2019) and conditional VAEs (Sohn et al., 2015; Shen et al., 2018; Gao et al., 2019), encodes each utterance with historical latent codes and autoregressively reconstructs the input sequence.",
      "startOffset" : 29,
      "endOffset" : 85
    }, {
      "referenceID" : 8,
      "context" : ", 2019) and conditional VAEs (Sohn et al., 2015; Shen et al., 2018; Gao et al., 2019), encodes each utterance with historical latent codes and autoregressively reconstructs the input sequence.",
      "startOffset" : 29,
      "endOffset" : 85
    }, {
      "referenceID" : 33,
      "context" : "Knowledge Base and Knowledge Retrieval ConceptNet (Speer et al., 2017) captures commonsense concepts and relations as a semantic network, which encompasses the spatial, physical, social, temporal, and psychological aspects of everyday life.",
      "startOffset" : 50,
      "endOffset" : 70
    }, {
      "referenceID" : 25,
      "context" : "been shown in (Petroni et al., 2019), pre-trained language models perform well in recalling relational knowledge involving triplet relations about entities.",
      "startOffset" : 14,
      "endOffset" : 36
    }, {
      "referenceID" : 35,
      "context" : "We address this problem using the Seq2Seq framework (Sutskever et al., 2014), in which the model consecutively consumes an utterance xn and predicts the emotion label yn based on the earlier utterances and their associated predicted emotion labels.",
      "startOffset" : 52,
      "endOffset" : 76
    }, {
      "referenceID" : 30,
      "context" : "Topic models, often formulated as latent variable models, play a vital role in dialogue modeling (Serban et al., 2017) due to the explicit modeling of ‘high-level syntactic features such as style and topic’ (Bowman et al.",
      "startOffset" : 97,
      "endOffset" : 118
    }, {
      "referenceID" : 3,
      "context" : ", 2017) due to the explicit modeling of ‘high-level syntactic features such as style and topic’ (Bowman et al., 2016).",
      "startOffset" : 96,
      "endOffset" : 117
    }, {
      "referenceID" : 32,
      "context" : "Despite the tremendous success of applying topic modeling in dialogue generation (Sohn et al., 2015; Shen et al., 2018; Gao et al., 2019), there is scarce work exploiting latent variable models for dialogue emotion detection.",
      "startOffset" : 81,
      "endOffset" : 137
    }, {
      "referenceID" : 31,
      "context" : "Despite the tremendous success of applying topic modeling in dialogue generation (Sohn et al., 2015; Shen et al., 2018; Gao et al., 2019), there is scarce work exploiting latent variable models for dialogue emotion detection.",
      "startOffset" : 81,
      "endOffset" : 137
    }, {
      "referenceID" : 8,
      "context" : "Despite the tremendous success of applying topic modeling in dialogue generation (Sohn et al., 2015; Shen et al., 2018; Gao et al., 2019), there is scarce work exploiting latent variable models for dialogue emotion detection.",
      "startOffset" : 81,
      "endOffset" : 137
    }, {
      "referenceID" : 30,
      "context" : "To this end, we borrow the architecture from VHRED (Serban et al., 2017) for topic discovery, with the key modification that both the encoder RNN and decoder RNN are replaced by layers of a pre-trained language model.",
      "startOffset" : 51,
      "endOffset" : 72
    }, {
      "referenceID" : 16,
      "context" : "As in (Li et al., 2020a), we employ the “Memory” scheme that zn becomes an additional input for LMθ, that is, the input to the higher layers becomes [zn, xn ].",
      "startOffset" : 6,
      "endOffset" : 24
    }, {
      "referenceID" : 29,
      "context" : ", ‘be worried’), since they are defined as the mental states of an event (Sap et al., 2019).",
      "startOffset" : 73,
      "endOffset" : 91
    }, {
      "referenceID" : 27,
      "context" : "The method for computing the similarity between an utterance and events is SBERT (Reimers and Gurevych, 2019).",
      "startOffset" : 81,
      "endOffset" : 109
    }, {
      "referenceID" : 37,
      "context" : "Knowledge Selection With the knowledge retrieved from ATOMIC, we build a pointer network (Vinyals et al., 2015) to exclusively choose the commonsense knowledge either from SBERT",
      "startOffset" : 89,
      "endOffset" : 111
    }, {
      "referenceID" : 12,
      "context" : "We envelope σ with Gumbel Softmax (Jang et al., 2017) to generate the one-hot distribution4.",
      "startOffset" : 34,
      "endOffset" : 53
    }, {
      "referenceID" : 1,
      "context" : "We design an attention mechanism (Bahdanau et al., 2015) to integrate the candidate knowledge.",
      "startOffset" : 33,
      "endOffset" : 56
    }, {
      "referenceID" : 18,
      "context" : "Datasets We use the following datasets for experimental evaluation: DailyDialog (Li et al., 2017) is collected from daily communications.",
      "startOffset" : 80,
      "endOffset" : 97
    }, {
      "referenceID" : 7,
      "context" : "It takes the Ekman’s six emotion types (Ekman, 1993) as the annotation protocol, that is, it annotates an utterance with one of the six basic emotions: anger, disgust, fear, happiness, sadness, or surprise.",
      "startOffset" : 39,
      "endOffset" : 52
    }, {
      "referenceID" : 4,
      "context" : "IEMOCAP (Busso et al., 2008) is built with subtitles from improvised videos.",
      "startOffset" : 8,
      "endOffset" : 28
    }, {
      "referenceID" : 39,
      "context" : "EmoryNLP (Zahiri and Choi, 2018)5 is also built with conversations from ‘Friends’ TV series, but",
      "startOffset" : 9,
      "endOffset" : 32
    }, {
      "referenceID" : 14,
      "context" : "HiGRU (Jiao et al., 2019) simply inherits the recurrent attention framework that an attention layer is placed between two GRUs to aggregate the signals from the encoder GRU and pass them to the decoder GRU.",
      "startOffset" : 6,
      "endOffset" : 25
    }, {
      "referenceID" : 10,
      "context" : "DialogueGCN (Ghosal et al., 2019) creates a graph from interactions of speakers to take into account the dialogue structure.",
      "startOffset" : 12,
      "endOffset" : 33
    }, {
      "referenceID" : 42,
      "context" : "Results of KET and COSMIC are from (Zhong et al., 2019) and (Ghosal et al.",
      "startOffset" : 35,
      "endOffset" : 55
    }, {
      "referenceID" : 42,
      "context" : "KET (Zhong et al., 2019) is the first model which integrates common-sense knowledge extracted from ConceptNet and emotion information from an emotion lexicon into conversational text.",
      "startOffset" : 4,
      "endOffset" : 24
    }, {
      "referenceID" : 9,
      "context" : "COSMIC (Ghosal et al., 2020) is the state-of-theart approach that leverages ATOMIC for improved emotion detection.",
      "startOffset" : 7,
      "endOffset" : 28
    }, {
      "referenceID" : 9,
      "context" : "IEMOCAP results reported on COSMIC (Ghosal et al., 2020) are not directly comparable here.",
      "startOffset" : 35,
      "endOffset" : 56
    }, {
      "referenceID" : 6,
      "context" : "As in (Dathathri et al., 2020), we construct bag-of-words7 that represent 141 distinct topics.",
      "startOffset" : 6,
      "endOffset" : 30
    } ],
    "year" : 2021,
    "abstractText" : "Emotion detection in dialogues is challenging as it often requires the identification of thematic topics underlying a conversation, the relevant commonsense knowledge, and the intricate transition patterns between the affective states. In this paper, we propose a TopicDriven Knowledge-Aware Transformer to handle the challenges above. We firstly design a topic-augmented language model (LM) with an additional layer specialized for topic detection. The topic-augmented LM is then combined with commonsense statements derived from a knowledge base based on the dialogue contextual information. Finally, a transformerbased encoder-decoder architecture fuses the topical and commonsense information, and performs the emotion label sequence prediction. The model has been experimented on four datasets in dialogue emotion detection, demonstrating its superiority empirically over the existing state-of-the-art approaches. Quantitative and qualitative results show that the model can discover topics which help in distinguishing emotion categories.",
    "creator" : "LaTeX with hyperref"
  }
}